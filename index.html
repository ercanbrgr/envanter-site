<!DOCTYPE html>
<html lang="tr">
<head>
<script>if(window.location.search.indexOf('v=202602240400')===-1){window.location.replace(window.location.pathname+'?v=202602240400');}</script>
<meta charset="UTF-8">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<meta name="app-version" content="202602240400">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Ercan BRGR | Envanter Sistemi</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#e85d04">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Ercan BRGR Envanter">
<link rel="apple-touch-icon" href="icon.svg">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
:root{--orange:#e85d04;--dark:#1a1a2e;--mid:#16213e;--deep:#0f3460}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
body{font-family:'Segoe UI',Arial,sans-serif;background:#f0f2f5;min-height:100vh}
#auth-screen{display:flex;align-items:center;justify-content:center;min-height:100vh;background:linear-gradient(135deg,var(--dark) 0%,var(--deep) 100%);padding:20px}
.auth-card{background:#fff;border-radius:20px;padding:36px 28px;width:100%;max-width:380px;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.3)}
.auth-logo{font-size:44px;font-weight:900;color:var(--orange);letter-spacing:3px;margin-bottom:4px}
.auth-sub{font-size:11px;color:#aaa;margin-bottom:24px;letter-spacing:1px;text-transform:uppercase}
.auth-tabs{display:flex;gap:0;margin-bottom:20px;border:2px solid #eee;border-radius:10px;overflow:hidden}
.auth-tab{flex:1;padding:10px;font-size:13px;font-weight:700;border:none;background:#f8f8f8;cursor:pointer;color:#888;transition:all 0.2s}
.auth-tab.active{background:var(--orange);color:#fff}
.auth-field{margin-bottom:14px;text-align:left}
.auth-field label{font-size:11px;font-weight:700;color:#888;text-transform:uppercase;display:block;margin-bottom:5px}
.auth-field input{width:100%;padding:13px 14px;border:2px solid #eee;border-radius:10px;font-size:15px;outline:none;transition:border-color 0.2s}
.auth-field input:focus{border-color:var(--orange)}
.auth-btn{width:100%;padding:14px;background:var(--orange);color:#fff;border:none;border-radius:10px;font-size:16px;font-weight:700;cursor:pointer;transition:background 0.2s;margin-top:4px}
.auth-btn:hover{background:#c44d02}
.auth-btn:disabled{background:#ccc;cursor:not-allowed}
.auth-err{color:#e74c3c;font-size:12px;min-height:18px;margin-top:6px;text-align:center}
.auth-note{font-size:11px;color:#aaa;margin-top:12px;line-height:1.5}
#sube-screen{display:none;align-items:center;justify-content:center;min-height:100vh;background:linear-gradient(135deg,var(--dark) 0%,var(--deep) 100%);padding:20px}
.sube-card{background:#fff;border-radius:20px;padding:36px 28px;width:100%;max-width:380px;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,0.3)}
#loading-screen{display:none;align-items:center;justify-content:center;flex-direction:column;min-height:100vh;background:radial-gradient(ellipse at 50% 60%,#1a0800 0%,#0d0d0d 55%,#000 100%);gap:0;overflow:hidden;position:relative}
.sp-fire-ring{position:absolute;width:320px;height:320px;border-radius:50%;background:radial-gradient(circle,rgba(232,57,10,0.35) 0%,rgba(255,184,0,0.15) 40%,transparent 70%);animation:fireRingPulse 2.8s ease-in-out infinite;opacity:0;animation-delay:1.2s}
.sp-fire-ring2{position:absolute;width:480px;height:480px;border-radius:50%;background:radial-gradient(circle,rgba(255,184,0,0.12) 0%,transparent 65%);animation:fireRingPulse 3.5s ease-in-out 0.6s infinite}
.sp-sparks{position:absolute;width:100%;height:100%;pointer-events:none;z-index:1}
.sp-spark{position:absolute;width:5px;height:5px;border-radius:50%;opacity:0}
.sp-spark:nth-child(1){left:48%;top:42%;background:#FFB800;animation:sparkFly1 1.2s ease-out 1.2s forwards}
.sp-spark:nth-child(2){left:52%;top:40%;background:#E8390A;animation:sparkFly2 1s ease-out 1.4s forwards}
.sp-spark:nth-child(3){left:45%;top:44%;background:#FFB800;animation:sparkFly3 1.4s ease-out 1.1s forwards}
.sp-spark:nth-child(4){left:55%;top:43%;background:#fff176;animation:sparkFly4 1.1s ease-out 1.6s forwards}
.sp-spark:nth-child(5){left:50%;top:38%;background:#E8390A;animation:sparkFly1 1.3s ease-out 1.8s forwards}
.sp-spark:nth-child(6){left:43%;top:46%;background:#FFB800;animation:sparkFly3 0.9s ease-out 2s forwards}
.sp-spark:nth-child(7){left:57%;top:45%;background:#E8390A;animation:sparkFly2 1.2s ease-out 2.1s forwards}
.sp-spark:nth-child(8){left:49%;top:50%;background:#FFB800;animation:sparkFly4 1s ease-out 2.3s forwards}
.splash-icon{font-size:130px;line-height:1;filter:drop-shadow(0 0 30px #E8390A) drop-shadow(0 0 60px rgba(255,184,0,0.6)) drop-shadow(0 8px 24px rgba(0,0,0,0.9));animation:burgerBoom 2s cubic-bezier(0.22,1.5,0.5,1) 0.8s forwards;opacity:0;transform:scale(0) translateY(60px) rotate(-25deg);position:relative;z-index:5}
.splash-icon.landed{animation:burgerFloat 4s ease-in-out infinite!important;opacity:1!important}
.splash-logo{display:flex;flex-direction:column;align-items:center;gap:4px;position:relative;z-index:5}
.splash-brand{display:flex;gap:0;align-items:center;margin-top:14px}
.splash-brand .letter{font-size:62px;font-weight:900;color:#FFB800;letter-spacing:2px;opacity:0;transform:translateY(50px) scale(0.3) rotateX(90deg);display:inline-block;text-shadow:0 0 30px rgba(255,184,0,0.9),0 4px 24px rgba(0,0,0,1);font-style:italic;transition:none}
.splash-brand .letter.orange{color:#E8390A;text-shadow:0 0 40px #E8390A,0 0 80px rgba(232,57,10,0.7),0 4px 24px rgba(0,0,0,1)}
.splash-brand .gap{width:16px;display:inline-block}
.splash-tagline{font-size:13px;letter-spacing:7px;color:rgba(255,184,0,0.7);text-transform:uppercase;margin-top:10px;opacity:0;animation:taglineIn 1.5s ease 9s forwards;text-shadow:0 0 20px rgba(232,57,10,0.5)}
.splash-divider{display:flex;align-items:center;gap:12px;margin-top:20px;opacity:0;animation:fadeIn 1.2s ease 10s forwards}
.splash-divider-line{width:60px;height:2px;background:linear-gradient(90deg,transparent,#FFB800);box-shadow:0 0 8px #FFB800}
.splash-divider-line.right{background:linear-gradient(90deg,#E8390A,transparent)}
.splash-divider-dot{width:6px;height:6px;border-radius:50%;background:#E8390A;box-shadow:0 0 12px #E8390A,0 0 24px rgba(232,57,10,0.6)}
.splash-progress{width:200px;height:3px;background:rgba(255,255,255,0.1);border-radius:3px;margin-top:32px;overflow:hidden;opacity:0;animation:fadeIn 0.5s ease 11s forwards}
.splash-progress-bar{height:100%;width:0;background:linear-gradient(90deg,#E8390A,#FFB800,#fff);border-radius:3px;box-shadow:0 0 10px #FFB800;animation:progressFill 3s cubic-bezier(0.4,0,0.2,1) 11s forwards}
.splash-loading-text{font-size:10px;letter-spacing:4px;color:rgba(255,255,255,0.3);text-transform:uppercase;margin-top:10px;opacity:0;animation:fadeIn 0.5s ease 11.2s forwards}
@keyframes fireRingPulse{0%,100%{transform:scale(0.9);opacity:0.6}50%{transform:scale(1.15);opacity:1}}
@keyframes burgerBoom{0%{opacity:0;transform:scale(0) translateY(60px) rotate(-25deg)}50%{opacity:1;transform:scale(1.35) translateY(-20px) rotate(10deg)}75%{transform:scale(0.92) translateY(5px) rotate(-4deg)}90%{transform:scale(1.06) translateY(-4px) rotate(2deg)}100%{opacity:1;transform:scale(1) translateY(0) rotate(0deg)}}
@keyframes burgerFloat{0%,100%{transform:translateY(0) rotate(0deg)}40%{transform:translateY(-10px) rotate(3deg)}70%{transform:translateY(-5px) rotate(-2deg)}}
@keyframes letterIn{to{opacity:1;transform:translateY(0) scale(1) rotateX(0deg)}}
@keyframes fadeIn{to{opacity:1}}
@keyframes taglineIn{from{opacity:0;letter-spacing:12px}to{opacity:1;letter-spacing:7px}}
@keyframes progressFill{to{width:100%}}
@keyframes sparkFly1{0%{opacity:1;transform:translate(0,0) scale(1)}100%{opacity:0;transform:translate(-60px,-80px) scale(0);}}
@keyframes sparkFly2{0%{opacity:1;transform:translate(0,0) scale(1.5)}100%{opacity:0;transform:translate(50px,-100px) scale(0)}}
@keyframes sparkFly3{0%{opacity:1;transform:translate(0,0) scale(1)}100%{opacity:0;transform:translate(-80px,-60px) scale(0)}}
@keyframes sparkFly4{0%{opacity:1;transform:translate(0,0) scale(2)}100%{opacity:0;transform:translate(70px,-90px) scale(0)}}
#loading-screen.fade-out{animation:splashFadeOut 1s cubic-bezier(0.4,0,1,1) forwards}
@keyframes splashFadeOut{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(1.15) translateY(-30px)}}
#app{display:none;min-height:100vh;flex-direction:column}
#topbar{background:var(--dark);color:#fff;padding:10px 10px;display:flex;align-items:center;gap:6px;position:sticky;top:0;z-index:100;box-shadow:0 2px 8px rgba(0,0,0,0.3);flex-wrap:nowrap;overflow:hidden}
#menu-btn{background:none;border:none;color:#fff;font-size:22px;cursor:pointer;padding:4px 6px;border-radius:6px;line-height:1;flex-shrink:0}
#menu-btn:hover{background:rgba(255,255,255,0.1)}
#topbar-title{flex:1;font-size:13px;font-weight:700;color:#fff;cursor:pointer;min-width:0;overflow:hidden}
#topbar-title #product-name-display{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}
#topbar-title span#topbar-sub{display:block;font-size:9px;color:var(--orange);font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
#topbar-birim{background:rgba(255,255,255,0.1);border:none;color:#fff;padding:5px 6px;border-radius:8px;font-size:12px;font-weight:600;cursor:pointer;outline:none;flex-shrink:0;max-width:72px}
#topbar-birim option{color:var(--dark);background:#fff}
.top-btn{padding:6px 10px;border-radius:8px;border:none;cursor:pointer;font-size:11px;font-weight:700;white-space:nowrap;flex-shrink:0}
.top-btn-add{background:var(--orange);color:#fff}
.top-btn-add:hover{background:#c44d02}
.top-btn-menu{background:rgba(255,255,255,0.1);color:#fff}
#topbar-user{font-size:10px;color:#ffb380;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:70px;flex-shrink:0}
#sync-indicator{font-size:16px;cursor:default;transition:opacity 0.3s;flex-shrink:0}
#drawer-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:200}
#drawer-overlay.open{display:block}
#drawer{position:fixed;left:-280px;top:0;bottom:26px;width:280px;background:var(--dark);z-index:201;transition:left 0.3s ease;display:flex;flex-direction:column;overflow:hidden}
#drawer.open{left:0}
#drawer-header{background:var(--orange);padding:20px 16px;display:flex;align-items:center;justify-content:space-between}
#drawer-header .brand{font-size:20px;font-weight:900;color:#fff;letter-spacing:2px}
#drawer-close{background:none;border:none;color:#fff;font-size:20px;cursor:pointer}
#drawer-search{padding:12px;background:var(--mid)}
#drawer-search input{width:100%;padding:8px 12px;border-radius:8px;border:none;background:var(--deep);color:#fff;font-size:13px;outline:none}
#drawer-search input::placeholder{color:#888}
#product-list{flex:1;overflow-y:auto;padding:6px 0}
#product-list::-webkit-scrollbar{width:3px}
#product-list::-webkit-scrollbar-thumb{background:var(--orange);border-radius:3px}
.product-item{padding:12px 16px;cursor:pointer;font-size:13px;border-left:3px solid transparent;display:flex;align-items:center;gap:8px;color:#ccc;transition:all 0.15s}
.product-item:hover{background:var(--deep);border-left-color:var(--orange);color:#fff}
.product-item.active{background:var(--orange)!important;border-left-color:#fff;color:#fff!important;font-weight:800;font-size:14px!important}
.product-item.active .num{color:#fff!important;font-weight:700}
.product-item.active .badge{background:#fff;color:var(--orange)!important}
.product-item .num{font-size:10px;color:#666;min-width:20px}
.product-item .pname{flex:1;font-size:13px}
.product-item .badge{font-size:10px;background:var(--orange);color:#fff;border-radius:10px;padding:1px 7px}
.drawer-footer{padding:12px 16px;border-top:1px solid var(--deep);display:flex;flex-direction:column;gap:8px}
.drawer-footer-info{font-size:11px;color:#666;word-break:break-all}
.drawer-btn{padding:8px 12px;border-radius:8px;border:none;cursor:pointer;font-size:12px;font-weight:700;width:100%;text-align:center}
.drawer-btn-orange{background:var(--orange);color:#fff}
.drawer-btn-gray{background:rgba(255,255,255,0.1);color:#aaa}
.drawer-btn-red{background:#c0392b;color:#fff}
.admin-badge{background:#f39c12;color:#fff;font-size:9px;font-weight:900;padding:2px 6px;border-radius:8px;letter-spacing:1px;text-transform:uppercase}
#content{flex:1;padding:12px;overflow-x:hidden}
.stats-row{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:12px}
@media(min-width:768px){
  #drawer{left:0!important;position:fixed;top:0;bottom:0;width:260px;z-index:50;transition:none}
  #drawer-overlay{display:none!important}
  #drawer-close{display:none!important}
  #topbar{left:260px!important}
  #content{margin-left:260px!important}
  #bottom-nav{left:260px!important}
  #search-input{font-size:14px!important;padding:10px 14px!important}
  .product-item{padding:10px 12px!important;font-size:13px!important}
  .product-item:hover{background:rgba(255,150,50,0.15)!important;cursor:pointer}
}
#content::before{content:'ERCAN\ABRGR';position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) rotate(-15deg);font-size:120px;font-weight:900;line-height:0.85;color:rgba(232,57,10,0.04);pointer-events:none;z-index:0;letter-spacing:4px;text-align:center;white-space:pre;user-select:none}
@media(min-width:600px){.stats-row{grid-template-columns:repeat(4,1fr)}}
.stat-card{background:#fff;border-radius:12px;padding:12px 14px;border-left:4px solid var(--orange);box-shadow:0 1px 4px rgba(0,0,0,0.06)}
.stat-card .sl{font-size:10px;color:#999;font-weight:600;text-transform:uppercase}
.stat-card .sv{font-size:22px;font-weight:800;color:var(--dark)}
.stat-card.green{border-left-color:#2ecc71}.stat-card.green .sv{color:#27ae60}
.stat-card.red{border-left-color:#e74c3c}.stat-card.red .sv{color:#e74c3c}
.stat-card.orange .sv{color:var(--orange)}
.add-card{background:#fff;border-radius:12px;padding:16px;margin-bottom:12px;border-top:3px solid var(--orange);box-shadow:0 1px 4px rgba(0,0,0,0.06)}
.add-card h3{font-size:14px;color:var(--dark);margin-bottom:14px;font-weight:700}
.form-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
@media(min-width:500px){.form-grid{grid-template-columns:repeat(3,1fr)}}
@media(min-width:768px){.form-grid{grid-template-columns:repeat(5,1fr)}}
.ff{display:flex;flex-direction:column;gap:4px}
.ff label{font-size:10px;font-weight:700;color:#999;text-transform:uppercase}
.ff input,.ff select{padding:10px;border:2px solid #eee;border-radius:8px;font-size:14px;outline:none;transition:border-color 0.15s;width:100%}
.ff input:focus{border-color:var(--orange)}
.ff input.calc{background:#f8f8f8;font-weight:700;border-color:#e0e0e0;cursor:default}
.ff input.fpos{background:#eafaf1;color:#27ae60;font-weight:800;border-color:#a9dfbf}
.ff input.fneg{background:#fdf2f2;color:#e74c3c;font-weight:800;border-color:#f5b7b1}
.form-actions{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap}
.btn{padding:10px 18px;border-radius:8px;border:none;cursor:pointer;font-size:13px;font-weight:700;transition:all 0.15s}
.btn-primary{background:var(--orange);color:#fff}
.btn-primary:hover{background:#c44d02}
.btn-outline{background:transparent;border:2px solid var(--orange);color:var(--orange)}
.btn-outline:hover{background:var(--orange);color:#fff}
.btn-sm{padding:6px 12px;font-size:12px}
.btn-danger{background:#e74c3c;color:#fff}
.table-card{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 1px 4px rgba(0,0,0,0.06)}
.table-scroll{overflow-x:auto;-webkit-overflow-scrolling:touch}
.scroll-hint{display:none;text-align:center;font-size:11px;color:#aaa;padding:6px;background:#fafafa;border-top:1px solid #f0f0f0;letter-spacing:1px}
@media(max-width:599px){.scroll-hint{display:block}tbody td input{min-width:52px}}
table{width:100%;border-collapse:collapse;font-size:12px;min-width:700px}
thead tr{background:var(--dark);color:#fff}
thead th{padding:10px 8px;text-align:center;font-size:11px;font-weight:600;white-space:nowrap;border-right:1px solid var(--deep)}
tbody tr{border-bottom:1px solid #f5f5f5;transition:background 0.1s}
tbody tr:hover{background:#fef9f5}
tbody td{padding:6px 6px;text-align:center;border-right:1px solid #f5f5f5}
tbody td input{width:100%;border:1px solid transparent;border-radius:4px;padding:5px 4px;text-align:center;font-size:12px;background:transparent;outline:none}
tbody td input:focus{border-color:var(--orange);background:#fff8f2}
td.calc{background:#f8f8f8;font-weight:700}
td.fp{background:#eafaf1;color:#27ae60;font-weight:800}
td.fn{background:#fdf2f2;color:#e74c3c;font-weight:800}
td.fz{background:#f5f5f5;color:#999;font-weight:700}
.del-btn{background:none;border:none;cursor:pointer;color:#ddd;font-size:13px;padding:3px 7px;border-radius:4px}
.del-btn:hover{color:#e74c3c;background:#fdf2f2}
.empty{text-align:center;padding:48px 20px;color:#bbb}
.empty .ico{font-size:48px;margin-bottom:12px}
.empty p{font-size:14px}
.overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:300;align-items:center;justify-content:center;padding:20px}
.overlay.show{display:flex}
.modal{background:#fff;border-radius:16px;padding:24px;width:100%;max-width:340px;box-shadow:0 10px 40px rgba(0,0,0,0.2)}
.modal h3{font-size:16px;margin-bottom:16px;color:var(--dark)}
.modal input{width:100%;padding:12px;border:2px solid #eee;border-radius:8px;font-size:15px;outline:none;margin-bottom:14px}
.modal input:focus{border-color:var(--orange)}
.modal-actions{display:flex;gap:8px;justify-content:flex-end}
.admin-panel{background:#fff;border-radius:16px;padding:18px;margin-bottom:12px;box-shadow:0 2px 12px rgba(0,0,0,0.08)}
.admin-panel h2{font-size:16px;color:var(--dark);margin-bottom:16px;font-weight:800;display:flex;align-items:center;gap:8px}
.admin-kart-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:18px}
.admin-kart{display:flex;flex-direction:column;align-items:flex-start;gap:6px;padding:18px 14px;border:none;border-radius:14px;font-size:13px;font-weight:700;cursor:pointer;text-align:left;transition:transform 0.15s,box-shadow 0.15s;box-shadow:0 3px 10px rgba(0,0,0,0.15);color:#fff;width:100%}
.admin-kart:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(0,0,0,0.2)}
.admin-kart:active{transform:scale(0.97)}
.admin-kart .kart-ikon{font-size:30px;line-height:1}
.admin-kart .kart-baslik{font-size:14px;font-weight:800;line-height:1.2}
.admin-kart .kart-aciklama{font-size:10px;font-weight:400;opacity:0.85;line-height:1.3}
.sube-card-admin{border:1px solid #eee;border-radius:12px;padding:14px;margin-bottom:10px;cursor:pointer;transition:all 0.2s;background:#fff}
.sube-card-admin:hover{border-color:var(--orange);box-shadow:0 3px 12px rgba(232,93,4,0.12);transform:translateY(-1px)}
.sube-card-admin h3{font-size:14px;font-weight:700;color:var(--dark);margin-bottom:6px}
.sube-stats{display:flex;gap:6px;flex-wrap:wrap}
.sube-stat{background:#f8f8f8;border-radius:6px;padding:5px 10px;font-size:11px;font-weight:700;color:#555}
.sube-stat.s-green{background:#eafaf1;color:#27ae60}
.sube-stat.s-red{background:#fdf2f2;color:#e74c3c}
#bottom-nav{display:none;position:fixed;bottom:26px;left:0;right:0;background:#fff;border-top:1px solid #eee;padding:8px 16px;box-shadow:0 -2px 10px rgba(0,0,0,0.08);z-index:100}
@media(max-width:599px){#bottom-nav{display:flex;gap:8px;justify-content:center}}
#content{padding-bottom:80px}
@media(min-width:600px){#content{padding-bottom:40px}}
#install-bar{display:none;position:fixed;bottom:0;left:0;right:0;background:var(--orange);color:#fff;padding:12px 16px;align-items:center;justify-content:space-between;z-index:500;font-size:13px;box-shadow:0 -2px 10px rgba(0,0,0,0.2)}
#install-bar.show{display:flex}
#toast{position:fixed;bottom:90px;left:50%;transform:translateX(-50%);background:rgba(30,30,30,0.95);color:#fff;padding:10px 20px;border-radius:20px;font-size:13px;font-weight:600;z-index:9999;opacity:0;transition:opacity 0.3s;pointer-events:none;white-space:nowrap}
#toast.show{opacity:1}
@media print{
  #auth-screen,#sube-screen,#loading-screen,#topbar,#drawer,#drawer-overlay,#bottom-nav,#install-bar,.add-card,.del-btn,.top-btn,.form-actions,#sync-indicator,#install-bar,select{display:none!important}
  body{background:#fff!important}
  #app{display:block!important}
  .table-card{box-shadow:none;break-inside:avoid}
  .table-scroll{overflow:visible}
  table{min-width:100%!important;font-size:10px}
  .stats-row{display:grid!important;margin-bottom:10px}
  .stat-card{border:1px solid #ddd;box-shadow:none}
  #content{padding:0!important;padding-bottom:0!important}
  .admin-panel{box-shadow:none}
  .print-only{display:block!important}
  @page{size:A4 landscape;margin:1.5cm}
}
.print-only{display:none}
#brand-watermark{display:none}
#brand-footer{position:fixed;bottom:0;left:0;right:0;height:26px;background:linear-gradient(135deg,#1a1a2e 60%,#2d1a0e);display:flex;align-items:center;justify-content:space-between;padding:0 14px;z-index:50;pointer-events:none;user-select:none;border-top:1px solid rgba(232,93,4,0.35)}
#brand-footer .bf-logo{font-size:11px;font-weight:900;color:#FFB800;letter-spacing:2px}
#brand-footer .bf-sep{color:rgba(255,184,0,0.35);font-size:9px}
#brand-footer .bf-sub{font-size:9px;color:rgba(255,184,0,0.45);letter-spacing:1px}
#content{padding-bottom:34px}
</style>
</head>
<body>
<div id="brand-watermark">YPC.TECNO</div>
<div id="brand-footer"><span class="bf-logo">YPC.TECNO</span><span class="bf-sub">Ufuk Yapıcı</span></div>
<div id="auth-screen">
  <div class="auth-card">
    <div class="auth-logo">ERCAN BRGR</div>
    <div class="auth-sub">Envanter Takip Sistemi</div>
    <div class="auth-tabs">
      <button class="auth-tab active" id="tab-giris" onclick="switchTab('giris')">Giriş Yap</button>
      <button class="auth-tab" id="tab-kayit" onclick="switchTab('kayit')">Kayıt Ol</button>
    </div>
    <div id="form-giris">
      <div class="auth-field"><label>E-posta</label><input type="email" id="giris-email" placeholder="ornek@mail.com" autocomplete="email" inputmode="email"></div>
      <div class="auth-field"><label>Şifre</label><input type="password" id="giris-sifre" placeholder="Şifreniz" autocomplete="current-password" onkeydown="if(event.key==='Enter')doGiris()"></div>
      <div class="auth-err" id="giris-err"></div>
      <button class="auth-btn" id="giris-btn" onclick="doGiris()">Giriş Yap</button>
      <div style="text-align:center;margin-top:10px"><button onclick="doSifreSifirla()" style="background:none;border:none;color:var(--orange);font-size:13px;cursor:pointer;text-decoration:underline">Şifremi Unuttum</button></div>
      <div class="auth-note">Verileriniz buluta kaydedilir. Telefon değiştirseniz bile verileriniz güvende.</div>
    </div>
    <div id="form-kayit" style="display:none">
      <div class="auth-field"><label>E-posta</label><input type="email" id="kayit-email" placeholder="ornek@mail.com" autocomplete="email" inputmode="email"></div>
      <div class="auth-field"><label>Şifre (en az 6 karakter)</label><input type="password" id="kayit-sifre" placeholder="Şifre belirleyin" autocomplete="new-password"></div>
      <div class="auth-field"><label>Şifre Tekrar</label><input type="password" id="kayit-sifre2" placeholder="Şifreyi tekrar girin" autocomplete="new-password" onkeydown="if(event.key==='Enter')doKayit()"></div>
      <div class="auth-err" id="kayit-err"></div>
      <button class="auth-btn" id="kayit-btn" onclick="doKayit()">Kayıt Ol</button>
      <div class="auth-note">Her şube kendi mail adresi ile kaydolur. Siler ve yeniden yüklese bile verileri kaybolmaz.</div>
    </div>
  </div>
</div>

<div id="sube-screen">
  <div class="sube-card">
    <div class="auth-logo">ERCAN BRGR</div>
    <div class="auth-sub">Envanter Takip Sistemi</div>
    <div style="font-size:16px;font-weight:700;color:#333;margin-bottom:20px">Şubenizi Oluşturun</div>
    <div class="auth-field" style="text-align:left">
      <label>Şube Adı</label>
      <input type="text" id="sube-input" placeholder="Örn: Kadıköy Şubesi" style="padding:13px 14px;border:2px solid #eee;border-radius:10px;font-size:15px;outline:none;width:100%" onfocus="this.style.borderColor='#e85d04'" onblur="this.style.borderColor='#eee'" onkeydown="if(event.key==='Enter')saveSube()">
      <div style="font-size:11px;color:#aaa;margin-top:6px">Bu isim uygulamanın üst kısmında görünür</div>
    </div>
    <div class="auth-err" id="sube-err"></div>
    <button onclick="saveSube()" style="width:100%;padding:14px;background:#e85d04;color:#fff;border:none;border-radius:10px;font-size:16px;font-weight:700;cursor:pointer;margin-top:8px">Başla →</button>
  </div>
</div>

<div id="loading-screen">
  <div class="sp-fire-ring2"></div>
  <div class="sp-fire-ring"></div>
  <div class="sp-sparks">
    <div class="sp-spark"></div><div class="sp-spark"></div><div class="sp-spark"></div><div class="sp-spark"></div>
    <div class="sp-spark"></div><div class="sp-spark"></div><div class="sp-spark"></div><div class="sp-spark"></div>
  </div>
  <div class="splash-icon" id="splash-burger">🍔</div>
  <div class="splash-logo">
    <div class="splash-brand" id="splash-brand-letters"></div>
    <div class="splash-tagline">Envanter &nbsp;•&nbsp; Stok Takip</div>
    <div class="splash-divider">
      <div class="splash-divider-line"></div>
      <div class="splash-divider-dot"></div>
      <div class="splash-divider-line right"></div>
    </div>
  </div>
  <div class="splash-progress"><div class="splash-progress-bar"></div></div>
  <div class="splash-loading-text">Yükleniyor...</div>
</div>

<div id="app">
  <div id="topbar">
    <div style="display:flex;align-items:center;gap:6px;flex-shrink:0" onclick="if(window.isAdmin){currentProduct=-1;showAddForm=false;renderAdminPanel();}" style="cursor:pointer">
      <div style="display:flex;flex-direction:column;align-items:flex-start;cursor:pointer">
        <span style="font-size:13px;font-weight:900;color:#FFB800;letter-spacing:1px;white-space:nowrap;line-height:1.3">ERCAN BRGR</span>
        <span id="topbar-user" title="Oturum bilgisi" style="font-size:9px;color:#ffb380;white-space:nowrap;max-width:110px;overflow:hidden;text-overflow:ellipsis;line-height:1.2"></span>
      </div>
    </div>
    <div id="topbar-title" onclick="toggleDrawer()" style="flex:1;min-width:0;padding-left:8px;cursor:pointer">
      <span id="product-name-display" style="display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:12px;font-weight:600">Ürün Seçin ?</span>
    </div>
    <span id="sync-indicator" title="Senkronizasyon durumu">🔄</span>
    <select id="topbar-birim" onchange="saveBirim()" title="Birim">
      <option value="Adet">Adet</option><option value="Kg">Kg</option>
      <option value="Lt">Lt</option><option value="Paket">Paket</option><option value="Kutu">Kutu</option>
    </select>
    <button class="top-btn top-btn-add" onclick="toggleAddForm()">+ Veri Gir</button>
    <button class="top-btn top-btn-menu" onclick="window.print()" title="Yazdır">🖨️</button>
  </div>
  <div id="drawer-overlay" onclick="closeDrawer()"></div>
  <div id="drawer">
    <div id="drawer-header" style="padding:22px 16px 14px">
      <div style="width:100%">
        <div class="brand" style="line-height:1;padding:0">
          <img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAH0A+gDASIAAhEBAxEB/8QAHQABAAEEAwEAAAAAAAAAAAAAAAECBgcIAwUJBP/EAGAQAAIBAwIDBAMHDA0ICAYCAwABAgMEEQUGByExCBJBURNhcRQiMoGRsdEXGDVCUlZzdJKTobIVFiMzNjdVYnKUtMHCJDQ4Q1NUgtIlRWN1g6Kz8CYnZITD4ShERmXx/8QAHAEBAAEFAQEAAAAAAAAAAAAAAAcBBAUGCAID/8QAQhEAAgECAgYGBQsCBgMBAAAAAAECAwQFEQYSITFBURNhcYGRsQcUocHRFRYiMjQ1QlJTcuEjMxclQ1SS8CRiY/H/2gAMAwEAAhEDEQA/APVMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFKCyE8HxX2rWenRUrm4p0V51JJHwqVqdGOtUkkuvYVUXJ5RWZ9vLzHLzLfe+9vx66ra/nUR+37by/62tfzqLB4vh6/14+KPv6tW/I/Blw5HeLd/b9t/+V7X87EPfu3/AOVbX86jysYw9/68fFD1at+R+DLiwvMYXmW9+33by/62tfzqI/b9t/8Ale1/OxDxjD1/rx8UPVq35H4MuLC8xy8y3f2/bef/AFta/nEVLfm328LVbXP4VFfljD3/AK8fFD1at+R+DLg/SPkOpttzaVeT7tDULepLriNSLZ2cakZLKeS8oXNG4WdKal2PM+MoSj9ZZHKARlF2eSFnJOThr16VtBzqTjTgurkzp6u9NEpY72qW0c9P3WP0ljXvLa2aVWaWfN5HuNOdT6qbO+yyO8dA996Dj7K2v52P0j9vWg/yra/nY/SW3yvh/wCtHxR9fVq35H4FwZIyW/8At70H+VbX84vpH7e9B/lW2/OL6Snyth/60fFD1av+R+DLg6+JLTZby33oP8qW352P0n2224tNu21RvaFVrqo1E8fIfWGJWVWWrCtFvtR5dCrHa4vwO1BRGSl0aKzIpqW1HxAAPQAAAAAAI6Ed71E5RxVLiFP4U4xXi3LB85TjDbJlcm9xyj4zq6m5dMp479/bxz0zVX0lP7adJ/lG1/Ox+ksniFpHfVj4o+nRVPys7bJGcHyUdTtLiKlSuKVVPo4zT+Y+mM1Loy6p1YVFnCSfYzw4yW9HICMok+55AAAAAAAID6AENoNpHX6prNro1vKtc1Y0qa8ZP+7qWdccZdHt6soKldVYr7eMEk/laMHe41h+HSULqsot8M9vgXVK0r11nTg2jIIZ0O393aZuWl3rC4VSSScoPlKOfNf+0d6mmnzyzJW1zRuoKpQkpJ8Uz4VKcqT1ZrJ8mVgAujwAAAU8kQmSz5L2/t9Poyq3FaFGEespvCPlOpGnFzm8kt7ZVJyeUVmz68ND9JYd5xf0a3rOnTVa4ivt6UVj9LR2+h7+0jX2oULjuV2sqlWThJ/LyfxNmAo6Q4ZcVegp1k32l3KyuKcdaUGl2FzghNYBshZkgENpoAh58gdVre4rDb9s619cRoR54T5t+xdX8RaK40aROTUaFzhPq4JZ/SYC8x3DrCapXFZJ8s/MvKVnXrrWpwbRkPoPWdRou47HcFLv2ddTaSbj0kvanzXxo7b5jL0K9O4gqlGSlF7mnmi1nCVOTjNZNFYALg8gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiXRlG8lmCweIu+1tukrS37jvZxypS59xdO9jz64MNXN/cX9WVW4rSryfPvTeZHb8RZO43hqMpvLUkvYlFYRb8eS5s5B0ux27xG/q05TahFtJJ7MkSrhNjStreM0tslm2H1IIl1IyzRFJ82ZzVRUCnLGWV1nzY1UVApyxljWfNlckVApyxljWfNjJFSb9Zf2wOI91Y3tOy1OtKvZ1MRjVm8ypv1vxRj/LOSDx8RnsHxe7wm6hWt5ves1wa5FheWdK6pOFRdj5G1EZqccrmjq9xa5Q29pda9rNuMFyS6tvokTtmrKvt/Tqk3mc7enJvzbiuZYvG24qU7HTaUXinUqS7y88R5fOdX4xitSxwid9TX0tVPJ8G8iLLS3Va6jRluzMf6/u++3JXc683TpLlGjCXvUvL1nTy58zhx3Ucq6M4/ub65vKkqtxNybee0lulQp0IqFOKSKGvAjHs+QfbMhvBZdJPcmffLJbB8hOPZ8gITfiV6WfMotpOPYMkZ54GEueCvS1FuZR8jvtG3xrOiVIujeSq0lydKv76Mvb/wDrmZU2lxRstemre6Ss7trKUnmMvYzBv2xPr8VzRumDaX4lhNSK13OC3pvPZ1GGu8HtrtN5asuaNqu8muTzkqXJZMWcOOIiu50dJ1Kf7s1ijWb+Hjwfr6GUovkdSYNjFvjVrG5oPfvXFMjO6talpUdOoux80VgjI7yM+WhHgzptf3NY7ctVWu63c72VGCWZSfkl/f0Oj3vxAtttW86NFxq3jXvYN5Sz0bMKX+q3Gr3lS6uajq1Z4zKXl5EU6T6a0MIbtrX6dTc+S7TZMOwardpVamyPtfYXtrnGDULucoadTp2kH0m496T/ALv0FkX+p3mqVZVLq4nVm3luUsnzg5+xDH8TxKTlcVW8+GbS8Eb/AELG2tY5U4rt4+Jx91+bHdfmySOfl+k15Trfm9pfqFJnLSuKlH4M5L2SZcmhcRtb0Rxi7p3dJcvR1lnl/S6otdJrwBkbTFMQsKnSW9Vxfb5lrXtbetHVqRzRnjbHEzTdfqU7eo3a3Ulyp1Hyb8k/F+ovNNNZNVHnqn0MkbE4nVLOdKw1afft3iKuZS5xf871evwJx0Z9IHrEo2mKZKT2KS2LvNJxDAXSTq221LeuJmXwCOOnVjVgpwkpRaymnlNHKTnGSmtaJpu7YCGSD2DjznHI47m6p2tCdWo1GEYuTb8EupzPoY54tbqWn6XDT6E0ri6+Es81DPN/+/DJhcYxKnhVlO6nwWzrfAurW3ldVo0o8X7DGu79zVty6vVrTfdowbjRpLkox8OXm+Wfi8josYeTkxHOck49ZxZe3le9uJ160m5See0mGjSpW0I04bEkctjfVdMu6dxRlOFSDypQk4v5UbD7S16G4tEt72DSlNYnFPPdkuq+j1NGuUop+Je/CTXVpmtTsqs8W90kop9IzWcNeWctfISDoHjksNv1bVZN06jy37E+Zr+OWKuKHTQ+tHb2riZ0BCawSdWbyNAAACmTxFswNxK3bV1nWa1pRqYs6HvMLxfi/m+QzxU+BL2Gr+up/sxefhZfOQ16Sr6tb2VKhSk0pt55cUuBtujtGFSvKcltitnefHTfNs5YVZ0asKlObhOLymuqZxR5o5DmqNSUXrLY+okV7VkzO3Dbd0tzaOlcSSvqHvasfmZeS/Sa17Z16rtzV6V5BOdPDjVpp/Ci+qNirG/pX9tRr0ZKdOpFSjJdGmso6v0Jx/5WslRrSTqQW3m1zIrxawdpWzivoy2rqPr8mfFqmoQ02wrXM+UKcXJ/EfanlYLZ4iVfR7P1KWM/uX95u+JXErWzq1o74pteBiLeCqVowe5tIwZrWt3WvXtS6uqnfnOTcV4QT+1XqR8KWDihJnKpLxRw/eXFW6ryq1ZNtvNtkzUqUaVOMYLJI+3RNZudv6lRvLaT70HicPu4vrE2P029p6hYULmk+9TqwUoteTRrH3l5mwnD5v8Aalp34JfMicPRlf1p1atpOTcUs0uC28DS9I6MUo1ksnnky5CQDoQ0YAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhdBL4LC6ET+CzxL6rKo1z3687t1L8Iv1UW820kXBvz+FupfhF+qi35HD2NrLEK/7n5ky2f2an2Ih9QH1C6mHW4vRhgu7YGy6e77i5VW4qUKdBRz6LCcs58Wn9yX4uC+lLrd3X5Uf+U3nC9DsUxa2jdUIrVe7N8jBXOMWttUdKTea5IwrhjDM1/UW0v8A3q6/Kj/yj6i+l/73dflR+gy3+HmM8l4lr84bTr8DCmGDNf1F9L/3q6/Kj9A+ovpf+93X5UfoH+HmM8l4j5w2nX4GFFnwLl2RtCvuq/p+kh3LGMlKpOXSST+CvWzJ9hwl0axrqrP0t010VeWUviWP0l32llRtKahShGEVySisI2nAvR3XhcQr4jJasXnqp5t9pjb3SCE6Tp0E83xfA5qVJUqcYRWIxSSS8EjGnG9f5Fpj8qsvmRlBPmzGHG7/ADHTfwkvmRI2mUNTA66XJeaNcwl53sO0xC34EZ5YJ7pByCiWwTEg7ba1vC63JptOou9D3RHK8+eP7y7tKHrVxChnlrNLPtZ86lTo6cp8k34Hw+4q/wDu9X8ke4q/+71fyTaGNGGF71dPIn0MPuF8hOq9GFNxz9Yfh/JpHzmlu6L2/wAGrkqFSnjv05wz07yxk43DPibNahpdtqFvUp16cJwnFxxKOeprnrNmtO1e8tY5lGjVlBN+KTNB0m0Sno7GFRVNeMs1uyaZm8MxWN/OUNXJpdp8BC5vIbIx1I9istpsJzUpOnKMoNxnF5UovDTXibFbM1xa/oFrctr0vd7tRLwkuTNcoGYeCtactMv6beYQrZivLOc/MiXPRziE6OJO1z+jNPxRqWkVBTt1V4p+ZkrHJFs763PT21pLqYU69V92nTzhvzfxdS451O5Fy8Ea7701+ruPcFxcOebam/RUYpdEm8v4yXtM8feB2D6L+5PYurrNUwmy9cuEpfVW1nRXdareVp168/S15vMpvxONLByY9Y7pyTOc6s5VKks3J5t8WyVEtVZLcQCe6XTtvh1qO4YRqt+47eXOFSce85LzSysr4zJWGGXWJ1VStYOTfLh1s+Fe4pW8NerJJFqgzXY8IdFtqaVxGrdz8ZVJ4+TGD7KvCvblWhKmrScM/bQqyUl7HnkSHS9G2LOGtKUU3wbeZr70htU8km+5fEwQDJmu8G6lCEqml3LqxXNUq3XH9Lx+Qxxc21SzrToV4OlcU3idN9UaPiuBYhg0srunkuD3pmZtb2heRzpSz5rij5pFS+DLHkQSku7P2f3mvJ5GRTMq8Gtw1q1KrpVxN1FSipUW3zS55Xs6GVUs9WYT4N2s6u4bmssdynQcX7W+XzMzbyOudBbivXwWm63BtLs4EUYzThTvJKHHaVAEPoSGYQ4Lq4haUKlWo1GEItyb6JGt27NwT1/XLi5l8HOILrhLoZR4wbjVjo606jNK4ul75Lqqfj8v9xhRReeZzn6Rsb6SrHDaT2R2vt5G/aPWijCVxNbXsXZzOVSb6PBOWURfvSp9CDdqNyUSW8lMZzp1aVSnLuVKclOLxnDXRkFR7hJ05KUd5VrNZGx+0Nchr+iW1ypJ1O6ozXk11O9Rg/hLuT9jtalYVp4o3aSi2+Smui+PL+QzgvM7J0VxZYthtOq39KKyfaiIsTtHZ3MocHtXYVAA3IxZRV+BI1k1xL9mLzl/rZfObN1f3tmsuufZi9/Cv5yC/Sh/Zt+1m6aM/wByr2I62Q6dGO8ThHOyeS2m/lZkfhPu5UKz0m5qd2Mlmg5S8fFL28jHBNGrO2uKVanJxqU5KUWjYMCxWrg17C6pvYt65riWF7axvKMqUu58mbT5LW4mfwM1H8Gcuyd0UtzaPTrR97Wp4hVg3zjLGfm5/GcXEt//AAXqPL7T+86yv7ylf4JVuaLzjKDa8CK7elKleRpzWTUkvaa+hNrmAcXyeUiYt0UT3n5mxHD7+CWnfgl8xrsbE8Pf4Jad+Cj8xM3oxf8A59X9vvRp+kjzow7fcXIuhIB0qR6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQugl8FhdCJ/BZ4l9VlVvNct+fws1L8Iv1UW++iLg35/C3Uvwi/VRb8jh7G9mIV/wBz8yZbP7NT7EQ+pMVlpEPqDDrcXpefD/elttKtXVzSqTp1V3lOku8010WPX7S9/q06P/u15+aX0mGgb5hemWJYRaxtLdrVW7NZvaYG4wa3uarq1M83yZmdcaNH/wB2vPza+klcZtHfW3vF7aa+kwkMsy3+IuM8HHwLR6PWnDPxM52nF/QrisoTnWoZ6SqQ978qzgvCz1Ghf0Y1berCtTlzTg8mraTz1O/2ruq62veqrTlKpRlylQcvetezzNgwb0kXHTRp4jFOLe1rY0Y+70fhGGtQbzXB8TZBNMpxyPn0+6p39nSuKUlOnVipRfqaPqxk6DpzhVgqkHmms12M0WSyeQMYcbv8y038JL5kZPfRGL+Nzzaab+El8yNN00+5K/YvNGYwhf8Am0+/yMRlL6lWH5lJx4iW88wdrti5ha7h0+tUeIwqqTfkk8s6o5IS9XQu7Wu7WvCvHfFpruPlUh0kJQfFNeJs1HXLDC/yyh+cQ/Zyw/3yh+cRrRlDKJpj6UKyWXq68TTPmzH9R+H8mxWp7q0zTbSVWd1RaXKMVNNt+CRr7qt9LU9Tu7ya7sq9Vz7v3Kb5I+fIbWDRtJNK7jSHUjOKjGPBbc32maw7CadhJzzzbOJL9JD59CZ9GQ1yNGby2GeKovOTMHBWjOGmX9SUcU51l3X58sv5zEFGlUqyjCnB1Kk5KMYrxbeEbFbJ0Nbe27aWeFGcIpyS831JY9HOH1K2Ju6X1YJ+LNT0hrRjbKnxk/Yj4eJusvSNrXXop9y4rYpU/Nt9cfFkwIpZysGUeOd01DS7dNrvSnP8nH0mLIrB8fSHeyucUdHPZTSXez6YBQjC06Rb2/4JTb8SQclrQldXdChD4VWSgn628EYUKUq0401vbyNlnJRg5ci+uG+x463JanexfuOE8Uqb/wBY14v1GZqUFSjhJJLkklhJHw6Tp9PTNOoWsI92EIJJI+9csnZWjmB0MGs4U6cfpNJt8WyIMQvKl3WcpPYty5I5cINeokG2Z5GOKHyTRam8NlW26rXlilcw5wqqPNe3zRdmfMYSfQx97ZW+IUZULmKlGSy2n2o1qlCaqU3k0a26lszV9JrulXtJt9VOnFyg16mkcmkbK1fWK/oqNrOCa51KsXGMfa2jYxwjJZcU/aIwjFckl8RE8PRnYRrqpKrJx5fybP8AOKv0erqrPmdDtHa1Ha+nRowxOvJJ1arXvpv1nfrqycesYwmS5aWtGyoxt6CyjFZJGrVKkqsnOTzbHI4ri4hbUZ1ajUYRTbk+SRyY6GO+Lu4/cOkw06jUUa11181DPN4/98sljjGJU8Jsal3P8K2Lm+B9rW3lc1o0o8WYy3ZrU9f1y5upSzDPdgvKKOllFLxK0kvUTheZxRdXNS8uJ3FV5uTb8SY6VKnShGEdyWSOJ8+gXLkcvdL22xsCetbWvNQniFaeHbe9y1GL5v48Y+IvMNwu5xWpKlbRzaTb7EfC5uqdolKo97y8Sw+rJiT1HUxc4uk9Vl2nmjkoV521enVpy7tSnJSi14NGxGzdxU9yaBbXkcKbXdqRTz3ZLqv7/Y0a5l/cItxfsXqstPqzSoXL95l9J+C+Pp7cEm6B418n4gqM3lCpkn28Ga3jtn6xQ6SK2x8uJnAEJp9CTq3eRkUVf3tmsuufZi9/Cv5zZqr+9s1l1z7MXv4V/OQX6UP7Nv2s3TRn+5V7Edc+gXQYRHeOdm89xvyIJT8CAup6zyKlxbG3PLbOvUqsk521VOFWK648H8TMu8RK0K+x9QnBqUZU0010afRmAeWfYXxp+6o3Ow9R0ivUUZ0aS9C34wTSx8WUSpoxpF0NhcYXcS2OMnHqeW41TE7HWuadzTXFZ+O8sgLmARVnnJs2rghhGxPD7+COm/go/Ma6p8+ZsTw9edp6cv8Aso/MTP6MXnf1f2+9GnaSPOjDt9xcq6EgHSpHwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABC6CXwWF0In8FniX1WVW81y35/CzUvwi/VRb76IuDfn8LdS/CL9VFvyOHsb2YhX/c/MmWz+zU+xEPqA+oMQtxegDDGGVybKADDGGV1XyGaKgC8Nj8P73XrilXuqTtrKGJS7/WeH0Xt8/AyeGYVd4ncQo28G833Jc2Wd1dUram51HlkZX4fwqUtoaZGa7r9Cn182382PlLkS55OK2pQt6EKUElCCSSXgkc2eZ2vY0HbWtOg3nqpLwIeqz6SpKa4tsMxfxt5Wmm/hJfMZQl4mL+OH+Z6b+Fl8yNV00+5K/YvNGTwh5XtP8A7wMRkSHeIOPEiWUgAT3Sp6Hfl5jvy8yAVBPfl5hyb5NkAoA+r9oSeegfwn7TKnCraemX9rHU6sY17iDxTTWFTx0wsmxYFg1XHLyNrTkk3tbfJbzH313GyourJN/Er4a8PnRqUtW1GCU1zoUpLnH1v9BlVJJYRCSisLCJXI66wXB7fBLWNtQW7e+LfMii6uql3UdSo+xckYg43SctQ01NclTn+lx+gxtHxMn8baDjX06rn4Skvm+kxhE5f02jKONV9ZZZtP2ElYHJeox/7xJO42f/AAo0tedxB/I8nTn1aXd+4NStblNp0aimmuqwarhc407ylUk9iab7MzK3EXOhOK4p+Rs7FckSfPaXMLu0p1KclKEoppo+jojuOlNThGcdzRCck08nwKwAfYqACMroASAAACMokA+e7uadpQnVqyUYQi5NvwSNcN16/PX9dubmX72mowXgkvBfP7WzKHF3dC03Sv2MpSXui5Xvkuqhz+fGPZkwqp48DnT0jY30tWOG0Xsjtl2m/aPWerB3MltexdnEr7/rJyyMZIj0IN3m6radpoWk1dc1WhY0eVSs8OWM92P20seo2MsrGnYWVG2px7tOnBRil5Ixzwe0BUaFXVq/dXpveUU1z7q6y+N8v+H1mUPTQ5e+j8p09oDhNHD7J3VRrXqLvS/kjLHLuVe46OO6OzvMC8TttvQtfnWpxxa3eaiSXKM+sl8byyz28Gwe/NCpbg0OpS70fS08zpvyfj8qyvjNfWsZwRJpthMcOxKU6X1J7V1Pija8Eu/WbdRlvjsfuISy85K6NWdCvTqwbjKD7ya8yjCxnBJoVObhJSXA2BpPYzY7Zu4Ibj0G2u016Rx7tSK+1mlzR365GEOEm5HpuqzsK08UbhruZ8J+C+MzamvlOw9E8ZWM4bCo/rR2Pu4kRYlaOzuZQ4PauwVf3tmsuufZi9/Cv5zZqr+9s1l1z7MXv4V/OR/6UP7Nv2s2DRn+5V7EdbIJLHUd4nCXPBzunlvN+RzQtJ1bd14c6Kqej73rfT+8+dczJ/DTRaGube1q0rco1ZQSeM91qPJr40Y/1bSa+jahXs7iPdnSk4v+d616jZcQwarZ2NC/S+hUW/kzGUL+FW5nbvY4vxWR8T6ENrBU458Se6a25ZGUkykpTwTId08pZgk2I4eL/wCFNO/BR+Y13NieH38EtO/Ax+Ymf0Yfb637fejTtI/7Me33FyghdCTpYj0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhdBL4LC6ET+CzxL6rKrea5b8/hZqX4Rfqot99EXBvz+FupfhF+qi35HD2N7MQr/ufmTLZ/ZqfYiH1C6h9Quph1tRemQOFW27HXKl/UvbeNx6NRjGM28c85bSfPojJn1PtAx9jKPyGE9qbvuNp168qNONanWilOE3jOM45/GXWuNNz/ACXTf/jP6CdNGMa0ftsOhRvorpFnnnFN9W3I0fELHEatzKpSb1Xllk8i/wD6nm3/AOTKPyD6nu3/AOTKD9qLC+rTc/yZD8+/oD40XOPsZD88/oNoekeia/Av+H8GNeHYpxb8f5MiWWz9F06q6lvp1tTqdO8qaydzGEYpJJJLokjDz41XOfsVT/PP6BHjZcJ5/Yun+ff0GRt9M9HbdatF6q6o5HwlhF/U2zi32v8AkzHlFWcLqYp07jWq1XuXOmSpw5e/pVO/j2rCL/0Pcdnr9D0lpWU2knKD5SjnomvA2nDdIsNxV6lrVTfJ7GYy4sLi1WdWDS58Dt31Zi/jd/mmm/hJfMZQ8/YYv43/AOZ6Z+El8yMXpp9yV+xeaLnCHlew/wC8DEL6gPqDj5EsoLqffotpDUNa0+1qL3lesoS/o88o+BdTutn/AMKdL/GIfrIyWHQjVvKUJLNNrNc1mW13JwoTkuT8i+N/8NqNrYe7tJpOMqMP3W3g2+9BeKTfVeJjCUFnrg2oUVKCT58jCHE7YstCuZ6lar/I6r99CMcuMvX6nn9BMWmuiUaVNYjYQSSy1kuHWjUsExTWfq9xLsfuLDAwwQYbwJ820XDsXdNfbGsU8TzaVZJVab6Y815NFvT6siPNl7Y3tbDrmNzQllKLzzLe4oRuKUqU1saNprK7pahaU7ihJVKVWKlGS6NPxPowuRhvhZvZafcR0q8k1b1GlSnKXKM/L1J/PjzMyKSl8Z2Fo7jtHHbGNxTf0tzXFMiO+s52VZ059z5osji1pXu/a1SvGOZ20lUXqXRmDIpc8G0d5bwu7arRqJTpzi4tPxWDW/cekT0HWrm0nFqMZZg/NPoQ96SsLkrmnf01sayfajbdHbr6Erd71tXvOrxzyACDtxvGRl3hbvOjVtI6Vcz7lWHKlKT5OPgvi6ezBk6MlnqarULidvVjOnJxnF5TT5oyjtXi0oU4W+qp+9Siq8fFetefrOhdD9NaKoxsMRlqtbFJ7n1Mj/FsFqa7r26zz3r4GWVLIydJZbr0nUKSnQvqFSD/AO0WV7U2fRW3BptvSdSre0KdNdZSqJJfpJljiNnKOvGqmueaNQ6Gonk4vPsOzbOn3FuS021YzurueILpFdW/BJFu61xX0vTouNr/AJdUX+zfvfl5mItf3He7kvZXF7U7zSxGEeUYLxSX/t+sj/SLTezw6k6dnJVKj2bNy68zPYfg1a5kpVU4x9rLq1Ti3rNeqpWapWlNZ9616Rv2t/3JDR+L2qW1wnfwp3NF9fRruyXr9ZYMU85yyoghaX4zGr0qrvsz2eBu3yXZ9H0fRrt4mymi6zba5Ywu7SaqUZJNNPp5p+TXij77ivTtbedWrKMKcE25SeEkYd4N6nVo6zc2fezQq0++4vwaaw18rLl4t7nhp+mR02nJOvc47yzzUM82dD2Wk8amA/KlbLWSaa5vh4mg1cLlTvlax45Zdhi3dOvT3FrVe6nlxcnGmvuYJ8l/78zp0lE5cLPX9A5HKF1d1Ly4nXqvNybZKdKjGjCMIrJJZHCCZLBBbZn1K43Naku7Tq1KabziEmln4ifdt1/vNb8uX0nGMsuIXNaGyEmfPUhyKne3K63NV5TXw5fSULmsY6EvL8SEsHmpWqVf7jzPSio7iSU8LBAPieiujWnQr06sJOMoSUk14NGxmzNejuLQLa6TXpHFRqJP4Ml1RrgupkHhJuR6dq8tNqyxQuucG30mui+NZ+Qk3QLGfk3EegqPKFTZ38DWcdtPWKHSRW2O3u4ma6n72/Yaza59mL38K/nNmajXo37DWbXPsxe/hX85vXpP/sW/azDaM/3KvYjrn0C6EPGehJzs3mb8jMHBVf5BqD/7SPzM5uKu2P2Tsf2RoRXp6EXKUUucoLr8nI4eCv8AmGofhI/MzI9alGrDuyWU+R1VgmGUsX0Xp2tZb08nyfBkX3lxK1xKVWO9NeSNXMc+oa5ZyXHxE2vPbevSlB961uMzptLGOfOPxFtRfLBzTiVhWw67na1lk4vLt6yRbe5jc0o1YbmiH1KU8eAl1yQ+pjMsi84FRsTw9/gnp34KPzGuxsTw+/gjpv4JfMTN6L/t9b9vvRp2kmyjDt9xcoIXQk6WI9AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEvgskiXQ8y+qDXLfv8LtS/CL9VFveRdPEmxqWW7byVT4FZqpB+axj+4taRxDj9KVLEriM1t1n5kxWE1K2hlyRD6glp5IwzBrcZEZYyxhjDKlMxlgYYwwVAyxhjDACz5s7LQNfuduarRvbeTxHlOn4ST8GdbgmDdStCkudSfwV5l5Z1qtC4hUotpprJrefCtThUpyjNZpo2ks7qN3a068GnCpFST800Y443f5lpv4SXzIyBodo9P0ayt5PvSpUoQbx1aSRYnGq1nU0ezuEveUqj73qyv/0dW6TqrW0cqNr6Wqm/ZmRZhjjC/hyzZhx9QMA5HJZC6ndbP/hTpf4xD9ZHSpPJcWw7Wd5urT4wWe5VVSXqik2ZbCISqYhQjBZtyXmWV80rWefJ+RsXH4K9hwX1lS1C2nRrQVSnNYcZLKZzQeEkV4R206Ua1Lo6izTWTTIcTcXmjXLeW0q+1dRdKT79vUbdKol1Xk/Wi3cM2T3Ttu23PpNWzrxj3n76nUay4S8Gv/fTKNe9X0i50O+qWd5T9HWg+a8JLwlF+KZytpno08CuOnoJujL2PkSZg+Jq6pqlP6y9qPgBOG2O6RvmbJmhGbjJNNpryM7cMNzVNw6POFw83NpJUpTf2yxlP5/kMEYZmXgraTp6Pc3MvgVai7vxL/8AZKXo8uK9PFlSp/Vaea4dpq+kMKcrbXe9NZGSFnBYXEzZs9c05XdpFO7t4txh93H7nPmX8+SKZw7z5nSWJ4dRxS1na1lsa8HwZH1vXnbVVVg8mjVaScJShKLhOLxKL5NMpkZf4h8OPdjq6lp0cV2s1beK5SfjKPr9XiYiq05UpuE04yi8NNdDkHHcAusCuHSrr6L3Pg0SxYYhTvqWtDfxXFMp7oiSU9OprJkUyrKAXQLoe1UnuUglF8CE8voE1gYwmSuZ828tpUqiSREujZWxrjdVwqjlKhYJ4lWTxKafVL6TJ4dh1xideNvbRbbf/cy0r3FO2purUeSR33CPSaqubvVZe9t6dN002vhPk38iX6Szd1a1PX9dububzFy7sF5JdEZ3vtKo6Zta6sbWEYRjbTjCKWPtWa5ElaV2lXR/DbXC08085N8GzXcKrRv7qrcy3rJLqRKbwR3m0MZDaXiRDFaxtjkU4YwzIGzOGH7YtM923deVupv9yjGKeV902zv/AKiVp/v1T83E3600Jxm8oRuKVNZNZrNpPIwVbGrSlUcNbatj2MxBhjDMwfUSs/8Afqn5tD6iVn/v1T82i7+YGO/prxR8/l2z/N7H8DD+GMMzB9RKz/36p+bQ+onZv/8AvVPzaHzAx39NeKHy7Z/m9j+Bh8NNGWL/AIN0be0qVaV3VnUgm1FJRz8hi6UEpNeTNZxfAb7BJRV5HLWWx55p8zI2l/Rvc+ieeW84Dmta06FxTrU5ONSnJSTXmh3R3TAwk4SUkXzyksmbGbV1yGv6Bb3kMd6UO7OK+1klzRgDXPsxefhZfOZb4QRktq1JNcp15NfJFf3GItxR9Frl9HHSq/nJn00uKl1gthcVN7W3tyRp2C040ry4px3L4nwPoF0I5N4wSQm3nsNzMwcFf8w1D8JH5mZLXNmNOCUZvS9QnKHdg6qUXnrhc/nMlpYOxNDE1gdv2PzIkxZ/+bU7fcdHu3blPcmkVbVtQq4bpVGs92WOTwa73FCdrXqUakXCpTk4yi/Bp4ZtIYr4ubSj3FrVvBKcPe3CjH4UfBv2c/lNT9IOj3rtusQoRznDf1r+DJ4Ff9BU6Cf1ZbupmJ15hLPiThA5nby2EkZg2J4fc9o6d+Bj8xrsbFbApzpbS0xVY9yboRco5zjK6E0ei9P16s//AF96NO0j/swXX7i410JAOlSPgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQ3hEgAtDeuzKO6bPKxTu6afo6uOa9T815owvrGztX0apKNxY1JQT5VaMe9B/GbKR5dSJU4y6xT+IjvH9DLPHKjrtuFRrLNe9GcsMXrWSUMs48maszt6tNZnTlBeclgoSybUehp/cR+Qj0FP7iPyGjf4WR/3T/wCP8mc+c3/x9v8ABq0oPyHc9RtG7em3nuR+Qe56f3CK/wCFkf8AdP8A4/yPnN/8vb/Bq76P2/IPR+35DaL3JHyj8g9yR8o/IP8ACyP+6f8Ax/kp85v/AJe3+DV30ft+Qj0frfyG0fuSPlH5BG1jF57qfxD/AAsj/un/AMf5Hzmf6Xt/g1mttFv72qqVvZXFWb8I0/8A9mTthcMZ6ZW936qo+mSTpUk89x+b9fTBlBQivtUhjl1NlwXQCywusq9ebqSW7NbM+wxt3jtxcU3TilFPflvZGF3eXQ+TU7CjqdnVtq9ONSlUj3ZRksrB9uOXUYXiSjUpwqQdOazi1k1wyNbjJxest5gjc/C/UNGr1atrB3Nl1j3Ocl6mvIs+pY3dObjOzqxa+6jhm0zimufM4nTjj4K+Qh/EPRtZXVd1beo4J8Mti7Da7bSCtShq1IqT57jXHRtparrbj6CzrKEuk5wcYr25MybD2JS2lZylOXp7yr76pUfh6kXZTgoLkkchn8A0JscEq+sJudTLY3uXYixv8Yr3q1Gso8kSuhIBI5gSh8i0987Ho7ttO9Fxp3tJN0qjWVnya8VyLtWMBLDMdfWNviNCVvcxUoy2H2o1p0JqpTeTRrXrOz9W0Kq4V7KpOK/1lKPejj2nW07StVWKdGpKp4RUevxm0cqcX1in8QdKOOUUQ9cei+2qVHKlXcVwTWftNrp6R1IwUZU03zzMCbd4aaprNaMrmjKztE05zqL30l4pLrn2+ozjpljR0uwo2tCnGnSpxUVGKwkkfX3Vjl0CWfaSFgGjNngFNqjtk97e/wD/AAwV9iNa/knU2JbkirvFRS/AqNvZikUS8/0Fn7r4dafuVutCELe7XNVYx6+p+f8AcXljl1IwYu/w21xOk6F1BSi+fuPvRrVKEtem8ma669sbWdBm/SWrq0l/rKTyn+gt9POU1hrk0/A2plBNc1k6PU9oaTq05TuLKlOcuTqJd2XyohrEvRnGUnOwq5Lk/ibhb6SzjHVrwz618DXMGcq/CPQq2H6OpH2TZx/Uf0TxlcfnDVX6OMXXGL7zJfOK1y2p+BhE+zTNHvNYrOnZ0J16ixmMF5+bfJfGzOFpw00GylJwsY1c45Vm54x5ZfIuS3tKVrTUKVOMIpYSisJGcsPRlWk9a/qpLktr8SzraSRS/ow29ZjHa3CJKrTudXkpqLUo28emf5z8TJ1vb07alGnTjGEI8korBzpdRzwyZcHwKywSj0drHJ8W97NRur2tdy1qss+S4ISgpQwzBm/tg3OjX1W6taU69lVk5L0cc9zPgzOnVFMoKpHDSZb6QaP2+kFuqVfY1tTW9M92N/UsKmvDanvXM1XaxyZcW1ti3u6bpR9FOlYxac61RYUlnnFfEZ2e39Oc3OdnRnN9ZSprn+g++nQjTilBKKXRLkRvh/o0pUK8al1V1op55JZZ9psNbSKcoONKOTfFnDYWNPT7Snb0YqFKnFRjFeCR9SIBNlKlCjBU4LJJZJdhp0nm82S8rxJfNBPJSfbiedxWCE8khrMqUySaaMMcR+H1axuq2qabR9JbVZOdWnHrCT6y9af6DM3jkiSUljGTWsdwK3x61dvX2NbnxTL+yvatjV6Sn3rmatc8es7bbm2NR3NWjG2t5RpZTdefKKXi0/H2Gfqm39NrVJVKljb1JvrKVJNv2tn3U6FOjBRhCMIroksEYWfozhSrKVzW1oJ55JZNmyVdI5Sp6tOGT5tnwaJpFLRNNoWdBKNGlFJJfpMbcTNgXFS5q6xptJ1nNJ1reEffZ+6XnywmvDHiZd5e0oqQUlhknYpgFpitl6jUWUVll1ZGt215Vtq3TRe17+s1Vk5Qk4Sg4TXKUZLDR2Wg7ev9xXaoWdH0mGnUm3iME/F/IbFV9Gs7mp6SvaUKs+nenTi38rR9tK3pUI92nCMI+UVgi2h6MYQrKVWvnFPclta5Gz1NJZOGVOmk+eeZ1m2tDpbf0mhZ08PurMpJY70n1fxnbtZIJJutrena0Y0KSyjFJI0yc5VJOcnm2M4OKvQhcUpU5xU4STTjJZTRyrkTjB9pRU04y2pnlPLajX3eGwLzbd3UdKnO5spNuE4Rz3U3yT59V+ktZwwbTzpRqxcZxUk+qaydetu6bCfejY28ZrpL0a5EJ4n6NKVzXdW1q6qbzyazy7DcLXSKdGmoVYazXHMwnsvYFzuK7pyuKM6NlCSlN1I4U0n8FGe6NKNGlGEUoxikl8RFOlGmsRSXsK0n4kh6PaO2+j9B0qTzk97e9mDv8QqYhU157EtyK0sEkJ5JNuMUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQSAARlEgAAAAAAAAAAAAAAAAAAAEZQygCQAAAAAAAARgkAAAAAAAAAEZQBIIyiQAAAAAAAAAAAAAAAAARlAEgAAAAAAAAAAAEYRIABGESACMIkAAAAAAAAAAAAEZQBIAABGcEOSiubRxyuKUes4r/AIimaGTe4r7yJyj4qmsWNFr0l3Rg/Lvo+X9tui/yrZ/no/SfN1ILe0fSNGrLaovwZ28UMfGdVDdWkVH3Y6nayfkq0fpPsp6ja1Y5jXpSXmpoKcJbmmHSqR3xa7j6nyDKI1oT6Ti/jJPotu4+bzRLx4E4fmREPL8CpRFQIz58iQVAAAAAABDWSQAAAAAAAACMgEgEZQBIBGUASARlAEgEZQBIBGUASARlAEgEZQBIIGUASAAAAAAAAAAAAAAAAAAAAAQyQAUY5Z5BtKOeWD5r++t9MtKtzdVoULelFznUqSUYxiurbbWEjTTjf2w7zUJ1NH2NVdtZ5cKmqSjmc+a/ek+i6++az5JY5469v6NjT16r7FzM9hGC3eNVuhtY583wRtRvDiftbY1F1Nd1q0sEk33alROfLyist9fIw5uHtx7I0urKlptlqespdKlGiqcX7O/KL/QaM6hql3qtzO4vbmrd16j70qlaTlKT+M+aD65NIraSV5v+lFJeLJosfRzZU0ndVHJ9WxfH2m59Tt96RBr/AOFb95/7aBR9f/pH3qX/AOfh9JplKOUUtLBjXj9+vx+xGf8AmDgn6b8X8TdJdvvSGs/tUv8A8/AfX96R96l/+egaV97D6D0nqEcev/z+xFPmDgn6b/5P4m6n1/ekferf/n6Y+v8ANH+9S/8Az0DStzz4BzXkUeP36/F7EPmDgn6b/wCT+Jup9f3pH3q3/wCfpj6/vSPvUv8A89A0qUseBPpPUVjj9+/x+xD5g4J+m/8Ak/ibqfX96R96t/8An6Y+v80f71L/APPQNK3PPgHNeRR4/fr8XsXwHzCwT9N/8n8TdT6/vSPvUv8A8/TJ+v70j71L/wDPUzSlSx4Byz4HqOP32/W9iHzCwRbejf8AyfxN4Lft7bZqVUq229XowfWcfRSx8XpEXfoHbJ4a6xiNXU6+m1PGF3bTWP8Aiiml8bXxnnnF8mimMOpcR0jvYr6WT7V8Cxrej7Caq+hrR7Hn55nqxoHFHau6ZY0vXtPvnjPdpV4t49mc/oLqhUjOOYyUl6meQNvWqW1RTpTlCcXlSi2mvkMjbN7Qe+tiSitO12vVoRxm2vX6ek0vDD98v+GSfTnyMvbaTRm8q0MutP3Go3vo3rRWdlVUnyez2/wenRHgar8Oe29pOreit916ZU0eo2o+7KH7pRb82uqXxPBsjoG59K3RYU73Sr6jf2tVZjVozUlJe1cjbLW9o3cc6Us+riRfiGD32GS1bqk49fB953QIXQkvjDgAAAAAAELocFzcU7alOrVnGFKEW5Tk0kkvHn8ZTPLeVSzeSOTKxzLa3RxF25sqg62taxaadTWedaok3jwS6t+pGr/HTtj1VWr6LsaS9Gswq6u+ak/H0S8V198/iXRmpur63f69eTutRu6t9cSeZVq8nKTfrZqOIY/Tt26dBa0ufAlHBdBLq/jGteN04PcstuXuN7Nx9uDYmlz7mnUdR1uSeHK3oKmvavSOLfyeBb31/GkNe82tfS/8aCNKI9SvyZrEtI717M0u4kml6P8ABqccpZyfNt+7I3Rl2+tMXL9ql8v/AB6ZH1/Om/epffn4GmCn6ug7z6+B4+cN6/xLwR91oHgi3wfi/ibofX86Z96d9+fgPr+tM+9K+/rEDS/veod/HgPl+9jt1l4Io9A8F/I/F/E3Q+v60z70r78/TH1/Wmfelffn6Zpf32+iHeXgiq0hvXxXgh8w8F/I/F/E3Q+v60z70r78/TH1/Wmfelffn6Zpf38PoO+/IfOG95rwQ+YeC/kfi/ibofX9aZ96V9+fpj6/rTPvSvvz9M0v74778ii0ivea8EPmHgv5H4v4m567fOmdP2p335+B9dv29ttuoo3O3NVowf269HL55o0l75TKLZ6jpBet714I8vQHBWstVrvfxPQvQu2Xw21WKVe/u9Kn4wurSbx7XBSS9reDJW3+K2091S7ula7Y3kms4p145x7M5/QeVKTiclGtOhUU4ScJLmpJtNfIX1PSSun/AFIprq2GGufRxYyTdvWkn15Ne49fadaFWOYTjNep5Ks48fiPLzZ/HnfWxKlN6ZuC5lQjydtdS9NSkvJqWWvHo0/WbIcNu3Jp9/Khabu06VhXfKV9atypZ8G4ttxXy4NhtMftbjKMs4vr3eJH2JaDYnYp1KSVSPVv8P8A9Ns1LAzhZ6HRbV3dou8dNhqGi6hQ1C1qJNVLeakvY8ePqfM73xNmjKMlrReaI9nCVOThNNNb09jKwAejwAAAAAAAAAAAAAQSAU+OBnqUTqKEctpLx5mFeJXav2XsCtWs6dy9b1Ok8StrFqShLylPon6ll+rztq1zSt461WSSL20sbm/qKlbQcn1GbHJRWW1gtfdHEnbWzqDq6xrVnp8Fn9+qxXNeCWct+w0U4jdrze+9ale30+4W39Lm8Kjar92cfXUfPPX4OEYYur6vf151rmrUr1pPMqlSTlKT9bZqV5pLSp7LeOt1vYiVcN9HVzWiql9UUOpbX3vcvab1bu7cG0NGnKno1hfa7JPHpYRVGk/jlzXXxiYg3D26d13s5LS9MsNOXhKWasvjzhfoNbZ88eBT3efXoaxVxy9uHnravUiRLLQfBrZLWpub5t5+zd7DJ2tdpniVr8Wq26bm2T6KzhClj41HP6S0tU3tuLXP8+17U7lN5cal5UcW/Y2W/HqckZLxMXUu7h/WqN97NsoYTYW/9mjFZckvgMPzJKYlRbdJN8TI9DTX4V4A5La8r2VZVbetUoVF0nSk4y+VHGB0klxPPQU3+BeBcem8Ut46O4+4t06tb934KheVFFfFnHyl9bf7V/ErSF77W436+5uqEWvjcUm/lMREJYLunf3NL6k2u8xVbBMOuG3WoRefUszaPbvbs1ixrRWt6BRvqb+3tKjhLPsalkzNszth7B3XJUbm6raDdNfveo01GL9k03F+rLWTz4eHzKV71ewzFHH7ynJOTUlyfxNQvtBMJuttJOD6n7nsPWvR9x6buC3jW0+9oXdJrKnRqKSa8+TZ2a6Hknt/eWubTvPdOj6lX06s5JuVvUlHOPUnh/HlGxHDftw6/pUqFnuyyjrVssRle0EqVZeuUUu6/iUTabbSO3rS1aicX4ojXE9AL61znaNVI8tz+BvI21//AMJzyMfcOeOO0eJ9CMtE1SlUr470raq+5Vj/AMLw2vWsoyCsNZTNopVqdaOtTlmiNK9vWtpunXi4yXBrIqBGUSfYtwAAAAACjPMP2jDLU4h8RdH4Z6BW1bWblUbeHvYQSzKpLwjFeLfl5JvomfKc404uUnkkfSlSqV5qlSi3JvJJF0uagm5NR9rMdbv7QGxNkd+Goa9QlcR60LbNap+TFPHx4RpZxj7T25uJN9WtbC5q6LoSbjG0oSxOql4zksN58lhc3lMw3OpKtJznJzk3luTy2aXeaRqDcbeOfW/cTJg/o7qVoKriFRxz/Ct/ezd3Uu3ltejKp7h0PU7yMXiMqihS7/sTk38qOtXb90vp+1S6/rcDTIhRSMC9IL18Uu5G8x0AwZLJwb7W8/Y0bnrt86a1n9qt1/WqZV9f1pf3qXX9agaYJpeAz6jx8vXv5vYenoHgn6b8X8Tc/wCv50z71rr+tUx9f3pf3q3X9agaYZ9Qz6j0sfvV+L2L4D5hYJ+m/F/E3P8Ar+tM8Nq3P9apj6/rS/vUuv61A0wz6hn1FHj96/xexB6BYJ+m/F/E3O+v50z71br+tUyfr+tL+9S6/rUDTDPqGfUU+Xr383sQegeCfpvxfxNz/r+dM+9a6/rVMfX96X96t1/WoGmGfUM+o9LH71fi9iHzCwT9N+L+JulT7fOkv4e1ryPl3binL6Ds7Dt3bPuqrhc6Pq1t3fhNQp1O78UZ5/QaNJLnyIhFI9LSG9jxT7kfOpoBgs1koNdjfvzPSLQO1Tw01+Xdpbiha1PubyjUofpnFL5GZH0bdmjbjoxraZqdrfU5LMZUKsZprzWGeTPTofTYaxe6RW9LZXVa1qP7ejUlCXypoyNHSeos+lpp9jyNcu/RtQf2Ss03waT8sj11TTXJ94c2jzo2D2sd97KlCjcXq16wSx6C/S76X82olnz+F3jZzhn2vtn74hSoanOe3NQlhOF68UpP+bU5Ly5PD59DaLXGbS5yWtk3wZHOKaH4rhecpQ14rjHb4reZ8RJx0qsK8IzhJTi1lNPKaKmzOZ5mktZbGVAAqAAAAAAAAAAAACn1ENqOZN8lzYzlln8W90LZfDnX9ZU1CdrazlBv7rGIr5Wj5zmqcHKW5LM+1GlKvVjSjvk0l3mpPa5461dza3dbM0evOnpdm+5fVYPu+6Kn3PrjHn7X/R56zpYOa4va19Xq17ibqV6s3UnN9ZSk8s4iFL67qXtaVSb2cFyR2FgmF0cJtIW9FcNr4t8WygZwAWJn0sgQlgkAqAAACEsEgAAAAEJYJAAAAAAAGWQC5PIAByRwl7C5tj8Sdx8OL/3VoGpVbSTac6OXKlUx91Ho/H5S2U8ESa8z606s6MlOEmmuRbXNtRuqTpVoqSe9NZnoFwM7UuicS1T0vVFS0bXU+4qMpr0VZr/Zt+P81/E2Z7U1Jcnk8gqc3TkpQk4yTymuTTNtuzt2r6lKva7b3jW79KWKVtqtSeMPwjVfr6KXXOE85ySFhePxrPobnJPg+ZAWkuhE7WMrvDk3Bb48V2c0blAohUjUgpRalF9GVm7EOgAh9ACiTwnyyaZ9sTjrVub+psfRLh07elHOo16U/hyfSlleCWc8+baXLHPa/e24ae1dqatq1WShStLWpWbfnGLf9x5U6xq1fWdTu7+6k6l1dVpV6s39tKTyzTtIb6dCkqMHk5b+wlLQLBqd/eSuq6zjTyyXDN/A+Hn0JTx1IzzyQRpKTR0ivokt5JSwRHqVLkeUs9p9d5GPWQ+TJbwUlGzy9ryKynDfMN5Kj0V2IhLAbwSR3gUS4lJWUFS59SiYb2kYZPNlJOWemkj0toWfAlrJIKLYeXteRTj1j4g3kqK5srsRCQl0JBQqd9s3iDuDh5qSvtA1Ktp9ZtOUYSzCePCUXyl49V4m7PAvtaaRv+lb6VuD0Oj67iMe8nijWf8ANb+C8/avz5NmhBS4IzNjileyktWTceKe403G9FrDGab146tThJb+/mj2CjJSjlPvJ+IXU0l7OXasuNIr2+3N4XHp7B4p2+pTk+/S8lUfiv53h48stbp2l3SvreFahJVKU0mpJ5TRKVlfU76n0lPvXI5oxnBLrBLh0biOzg+DPqBBJkjAAAAAAAAFKZxXFenb0pTqTjCMU25SeEkvNlM8t5VLN5I5H09Rjbinx121wos29TruteyX7lZUPfVJvw5eC828fGYW479sCOlXNbQ9kSjXuIvu19Va71Km+eVT8JP19PaadapqF7rF9VvL+7q3t1Uk3OtXl3pSb8XJ82afiWPQoSdK3yb4vgSro9oPWv0rm+zjTe5cX8EZU4q9prdvEqdW390y0bSqj5WVlU6rwUp4Tl456Ln0XjiOPNcxjPIlLBH1zc1bmWtUk2yfbHDbWwpKlawUUuS83vZxt5ZPdESG8lmlmZTJbiUsBrITySV3FdxCWCVyyAG8wAAAAAAAAATlkAABLAAAOWzvLjTbmFxaXFS2rwfehUpScZRfmmjZPhB2z9X25VpadvGnLVtMwoxvaKSr0UuuY9J/ofXLfI1nIkk0X9rfV7OWtSll1cGYDFcEs8Xp9HcwT5PiutM9Ydpb40PfWlUtR0TUKV9a1FynTfNeprqmXDHouZ5RcPuI2vcMtbhqeg3sraqv3yjLMqVZeUo5w/b1Xg0b58Eu0rovFejKyuO7pWvUuUrSrUTjVS6ypyXwl5rCafqw3I+G43Svsqc/oy69z7DnbSDQ+6wdutSznS58V2r3mbARHGFgk2cj8EPoSADq9e1i129pF1qN5UjRtbalKrUnJ4UYxWW/kR5oca+LeqcWt1V764rVKenU242lm372lHz9cn4v1I2r7cO762jbD0/RLaq6VTVrjE2l/q6eJNfL3TRd9ceRHmkl83JWsNy2v4E9+j/BIdC8SqJNttLPglva6zhJwye6Q/M0dyy3E2lQITySeQAAAAAAAAAAAAAAAAAABgADrBD+IkA8tKW8yxwo7SG6OF1zSpU68tT0dP3+n3VRyjFf9nJ5cPHksr1G9HCrjPt7i1pUbrSrhwuYpemtK2I1KT8ms815NcmeX79R2e2N06rs3WaGq6PeVbC9oPMalN9fVJdGnjDTTTRs2GY1VtJalV5x6+BG+kGhdrikJVrdKFRctib617z1uzzXMeRgfs+9pKw4s2MLDUlHT9yUYp1KHSFVfdQfj05rw5dTO+eSwSdb3FO5pqpTeaZzde2Vxh9aVC4jk1/3NFYBGS5LIkAAAAAAAAESMM9rip6LgJuSXXnbL5bimZmfUwt2v8/UA3H/AErb+0Uyxvfs1TsfkZjBl/mVsv8A3j5o85MsqXMhLxJIQOz0AACoAAAAAAAAAAAAAAAAAAAAAAAAzgnLIAAeX4h8wRIbtpR5NbTbnsodo+ca1DZ26Lvvuo1T067qvq+f7nJv4kn5vBuNF97DXRo8gadSVKcZwk4Ti1KMovDi14o9Eey3xo+qpsiNrf1IrX9LSo3eHzqL7Wpj+clz9eSR8BxSVxnb1d6Wx8znjTnRuNpP5RtY5Qk/pJcHz7GZyBC6Em7EPmLu0tLucD92S8rN/pkk/wBDZ5mxfkemPaZeOBe7n/8ASf4onmdnGSN9J1ncQ7PedEejTbh9fP8AP7kCO6E8kmlNEwEJYJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHTmbQ9lbtILblxbbP3JcN6bVap2N3UlyoPwpy9T5JPPJ8unTV4dGmm008prk0zI2V7UsqqqQ71waMDjWD2+NWsresux8U+aPX+E1OKknlNEp8zXfsjcbXxB2qtA1ap/07pcVFTnLMrij4T9qfvX7E/HBsR4kv2lzC7oxrU3sZyNiNhWwy6na11k4vxXB95WAC9McRywR4B9Tr9V1W10OwuLy9r07e2owc6lSpLuxjFLLbfkkim5ZsKMpSUYrNsq1bV7PQdNuL6/uKdpZ0IOpUq1ZKMYxSy22zQztC9qG94jXFTR9t1a2n7ci3GpVWYVLteec+9j6vHnnwPi7RPaIveKeoy0vTKk7bbFKWacE3m7/nT81y5R8PWYPbT5IjnF8b6bOhbvJcXxf8HQOiOhqt1G+xCOc96i+HW+s41y+MjL6EyyngPK8TSn9Jkyxjqbhl+RSVJ5Eim4qnmIkNYIJyyieRUlLBIBVvMAAAAAAAAAAAAAAAAAAAAADB9FnfV9Nuqdza1ZULim+9CtTfdnF+cWuh85Mj1F5PYeJRUouMlsN0+z52t7fWY2+gbzrwttRUYwo6pOWIXLXLE1yUZdOfR+rkbVU6sakYyjJNNZymeQfJrmjbvsj9oKtWvqOzNx3TnOcFHTbqq+uP9S35pc15811xmQMHxpycba4e/c/cyA9LdDoW8JX9gsora48utdRuMCE1hEm9kLGlfb4rta1tWmspunWkvilBGqGc8zbDt6/ZvbX4vX/Xiamw6EQY887+eXV5I6s0J+5aXf5sgq7oiQ3kwCWZvhUCE8kldwAAAAAAAAAAAAAAAAAAAAAAAABD8yQAfVpmr3mh6lb31hXlbXVCXfp1abxKMl0afy5XiehXZq440uLu2Vb3/wC5bgsoRjcwXKNVc0qkV4J45rwePUedjS6+R3+xt76pw63RYa7pFb0d1bSy4v4NSLa70ZLxTWU18fVJmdwnEZWNXJv6L3/E0bSvR6jjdrKUclVjtT59T7T1gy8YHd/QW3sfedjv3a1hrmnVFO2uqaqdcuEualF+Uk0015ouRZJchONSKnF5p7TlOpTlSm6c1k08muWRWAD6HgAAAAAAp8DDPbA/0f8Acn9O2/tFMzN4GGO2An9b9uT+nbf2imWF79mqdj8jM4L952374+aPOVdAAQidngAAAAAAAAAAAAAFdVnnXjzAAGqxrx5gAZGTCnF8QCO8SUPQAAAAAAAABDWTIfAbiNW4Z8R9L1RTbs6lSNvd0/CVGb7rl7YtqS9jXjlY9K4YjzwXFvWdvVjVjvTLG+tKV7bVLeqs1JNeKPXi1uIXdvSrU5KUJxUk1zTTXgcz5mJuzHu97x4QaJcTqOrcW8Ha1Zy6uVP3uX8STXqaMspk20Ksa9ONSO5pHGF5bu0uJ0Jb4trwMXdpt44Fbv8AxP8AxxPM2Tfgz0y7TnLgVu78T/xRPMyRHukzauIZcveT76NNmH1/3+5FSWCSFnxJNMzz2kwAAAAAAAAAAFzcPeHOt8T9wQ0jQ7b01xhzqVZvu06UfOT8FnC8Xlmcl2Ed2LHf13S4/FU+gyVvh11dR16MG0a3iGkOG4ZVVG6rJSyzy3vvyNZcMYZs79Yhuj+X9L/JqfQPrEN0fy/pf5NT6C7+Q7/9J+KMb89ME/X9j+BrJkGzn1iW6P5f0v8AJqD6xHdPjuDS/wAip9B5eC3630n7B89MD/X9j+BrGDYzWexFvLT7d1bW/sNQlHL9FTcot+pNrDfqNftc0q+25q9xpmo2lWyvaEnCpQrruyi/DK9aw0+jTTTa5ljXsq9rk60Ws9xmrDG8PxLZa1VJ8VxS7N58gC6AsjOAAAAAAAPoAAXZwp3/AF+Gm+tL16jKXo6NRQuYp471GTxJP9D9qR6k6ZqNDVrC3u7epGrQr0o1YTi+UotZTPIlxTPQ/sgbxnurg9p1vWm53GmOVnJy64jzivyXE3jRm71ZStpPftRB/pHw2PR0r+C2p5PrT3eBnT4iSOiDeCRSBziqVI0YOUniK5mhnan7QEt+avW2zotecdEs6iVarCWI3U1lNLzjFp+1pPpjOWu1/wAcZ7X0RbS0Wv3NU1KlKVzXpyxOhRbx73ycl3lnwSfi01pBOTl3m223zyzQsexPJ+rUpZZb/gTboLo3rtYncx2Z/RT8/gcXTkHLzZDbyxhGgSeTJ5byJBESTymVTzAAKlQAAAAAAAAAAMgZgDIAAGSHIJZgkAAAAAAAAAAAE90+iwvK+m6ha3ttUdK4t6iqwmuqaeV+lL5DhIfQ9Rk1JM+c4RqRcJcT1Q4U7whv7h9omuQazdW8XNL7Wa97JfKmXgjXvsSapO84MxoT5U7S/r0qf9F4l88mbBom6zqOrbwnLe0jjHFreNpf1qEN0ZNLsz2Glvb3+ze2Pxev+tE1OfRG2Xb2+zW2Pxev+tE1NfREV46v8wqd3kjpfQj7lpd/myoAGDN7AAAAAAAAfQADJlnhb2ad2cVNMep2ao6fp0pd2Fa6z+6Y6tJLmk8rPmmZC+sQ3X/LmnfkTMxTwm7rRU6cG0anc6U4TZ1XRrVkmtjS25GsmRk2b+sO3T/LunfkTI+sN3V/Lmnfm5Hp4Lfr/Sfii1+eeCfrrwZrLkGzf1h26v5c078iY+sP3X/LmnfkTKrBb9/6T8UV+eeCfrrwZrIDM3EXspby4eaTW1OcaOrWNHnVnZ95ygvGTi1lr2Zx7OZhpxcW01jBjri1q2z1asWmbHZYlaYlT6S0qKS6uD60QAC1MkAAAAAAAAAbT9h7iTOw1292dcPFteZurbL+DNRSlFe1JP2o3aPJjZG6a+yt4aNrtvOUJ2N1TrT7rw5QTxKPslFtP1Nnq3pV/S1PTbW7oyU6VenGpCS8U0mn+lEoaP3fT27pye2Ozu4HM2n2GRs8QVxTWUai29q3n3AA2xEYAAFQAAAU+Bhntgf6P+5P6dt/aKZmbwMMdsBP637cn9O2/tFMsL37NU7H5GZwX7ztv3x80ecq6AAhE7PAAAAAAAAABsZ2ROCWj8R7nU9b12lC9srGUKFO26xqVHHvS73jhJx6dc+o1zfQ3b7BXd/aJry8XqH/AOKmbBgdCnXvIqos0k3lwNA02u61phM50JOLbSzW/JvaZoXAjYOP4K6b/V4/QT9QbYH3q6b/AFeH0F+4GCUvVqH5F4I5m+Ubz9aXiywfqDbA+9XTf6tD6CPqDbAX/wDium/1eP0F/ZBX1aj+ReCKfKV5+tLxfxLC+oRsH71NM/q8foOo3F2a+H24LGVtPb1taZ5qpax9FJPweY4z7HyMp9OrJyijtLdrJwXgj1DFL6nJSjXkmut/E8yuO/Ba94NbmjaTqu6025TqWl13e73kusWsvDi+vqw/HljRdD0g7UuyKG8uEWsKcIu7sqfuqhU8YuHNr/ij3o/8R5vkW41YRs7j6CyUtqOmdDcbqYzY513nUg8m+ezYwADXzfgAAAAAAAH0CBuR2B9wSqaXurRZzbjQrUbqnF9F34yjLH5CNuEsPBo72DqslvTclFrMJWNObXrU+X6zN4k85JewSevYw2bs0cmaZUYUcarKPHJ+KRi/tPZ+oVu78U/xRPMyfU9M+07z4Fbv/E/8UTzMl8FGp6TvVuYdnvJS9Gq1sPr5fn9yKwQnkk03eTCAAAAAAAAAbjdgGEZ2O76sknVjVt6ff8cJTwjbtroajdgD7H7y/GKHzTNun1RMGCLKxh3+ZyTph9+XHavJFOMFTWQuaKTOmm7ysEJ5DKPYCl8jWjtk8JLbX9oVN22lFLVNK7rquEec6Oeecde7nPs7xss14nTbv06lq+1tVsq6UqNxbVKc1JZTTi0/nLG8oRuLedOXFeBl8JvquH3tO4pPc1n1riu88mQAQm1k8js6nLXgpAAHk9gAAAAAA227Amsujc7s0qc8xaoXMIt9PhRly/JNSTYfsQVpw4vXlJP9zqaXVUl54q0Wv7/lM5glTo76HX8DSNM6Kq4LWz4ZPwaN+ky1+Im9bLh/s/UdevZfuNrScowXJ1JPkor1t4Rc3TqzSftu8UnqWt2ey7Gf7jZd26vMS5Sm17yDXkk3J+tryJMxG7Vnbyq57eHac3YBhk8Wv4WyX0d77Fv+Brlunct/vLceoa1qVV1by9qurJ/crwivUlyS8EdRJvngd/K9ok1jqQ1Ocq03Um9rOv6NKNGnGnCKSiskluyRS+pTj1k5y2Q1k8NH2SzW0kEJ5JB7AAAABDafIAkjPxnabb2zqe7tWo6XpNlWv76s8U6NCOc+19Ir1vkbicIuxXpuje59R3nWWqXkEnHTqTfueHkpP7b2LC88+GUscNuL6TUFs58DVMa0kscEj/XlnJrYlvfwNS9ncOdx7/uo0tB0i51CEsJ1qdNqEZeOZPCwvaZ52h2F9w6jirr+t22lPCcqFrF16ib8HLMUv0m6+n6TZ6VbU7eytKNpRpruxhRgoxivUksH1xTTy3k3u20dt6GTqtyfgvAhLEtP8Runq2yVOPi/F7PYa16L2FtnWDjK6v8AULuS8VONP9WKf6S5qHY34a0U1+xlxPP3d3N4/SZwSeA+RmVhlot1NeBqNTSLFqstaVxLueXkYKu+xpw4uabjCwuKGerhcSeflyWfrfYO2/cr/orXb3T3nkqkI1o49nL5zabHIR+Qq8Ls5b6aPVHSTF6DzhcS73n5nn3vLsX7528p1NLdtr9CP+wfo6iXm4y/ubfqMH6zoWo7fu5WupWNxYXEHh07mlKEk/Y0euWMlt702Dt/fmnSste0yjf2+H3fSR99BvxjJc4vpzTT5Gu3ejdOecqDyfJ7jd8N9Id5Qko30VOPFrY/h5HlGnkk2Z41djjUdqW1bVdm9/VbGmnKdhUf7vFecZfb4WXjk/aazOLpylCcZU6kW4yhJYcWuqaNGurKtZyyqxy5PgycMJxm0xij0ttJPmuKfWgACxM6AAAAAAVgHcbM2pe753TpuhafBzu72qqcWllRX20peSisyb8kfSlTlVmoRWbbyRbXFeFtTdSo0opNtvhltN7exxt6WkcFbC4nT9E9Qr1bru56pyUYv41BP2NGeUdHtDblDae2tN0i2io0LKhCjBJYeEsczvFyXrJttKbo28Kb3pI4yxK59cvKtdbpSb7m9hpb2+Ps3tn8Xr/rRNTn0Rth2+Ps1tn8Xr/rRNT30RFWPfb6nd5I6b0I+5aXf5sqABgzewAAAAAAH0AfQ9R+seZ/VZ6h8CKUKXCPaqhFR/yCnnC6vu9S/kuZYnAz+KXa/wCI0v1UX2Tjbf2Y9i9xxRiP2yr+5+bJxzDWQurKS5RYbysEJ5DDeQOG4t6dzRnSqRU6c04uMllNHnj2q+EtDhlvaN1pdv6LRtTjKvTgvg0qmX34LyXRr1PHhl+iRq927NPp1dl6LdNe/p3ncT9UoSyv0I17G7aFe1lN747Ub5oXf1LPFqcIv6M9jXB8vaaQAAiQ6sAAAAAAAAAIxyPTbs66u9b4O7art5qRtVTn7Y5j/ceZT6Hof2ObidfglpPfecVK6+StM3HRmeVzKPNe9ERekilGVhTnxUvNGdAQuhJJhzoAAAAAAU+Bhntgf6P+5P6dt/aKZmbwMMdr9f8A8f8Acf8ATtv7RTLC9+zVOx+RmcF+87b98fNHnJlEkPwyIkIZ5nZ5IAKgAAAAAAG7vYJ/gJr3/eD/APTpmkRuz2Cq0JbK3BTjL38dRy4tYkk6cMNrwzh/IbLo99tS6mRtp8s8Hk+teZtUACV08zmAAAPYAQ+hJA3gsnjFdU7PhluarVfdpw0+tJv2QZ5Zm8fbQ4pU9H2c9pWlRS1DVGvTKnPnTt00235NtY9il5mjeceBGekteNS4jCP4Vt7To30dWNW3sZ3FRZKb2di4kgA08lsAAAAAAB9AH0KreDaDsG2/e3jua4bxCnZU4Pl5zfP/AMpu8vE1O7Bm23b6FuXWpRShc3ELWMvNQTlj4vSG2MeZL2CR1bGHWcmaY1Y1sarOL3ZLwSz9pjDtOPPAnd/4n/jieZs/A9Mu03/ETu/8T/xxPM1rmuZqOk+24h2e8lT0Z/d9f9/uRUlgkhPJJp2WRL4AAAAAAAABuP2Amlpu8s/7xQf6Jm3KabNHuxDxE0jbOra5ompV42dbUVRqW9WpJKM5QUlKHqb7ya88NeWd24XtvUhGUa1OUXzTUlzJdwSpCVlDJ7s8zk7TKhVp41XlKLSbTT4NZLcc7eRhnD7soJ/vsPyh7sof7aHymd148zStWXI+gHz+7aC61o/KPdtB8vSw+Uprx5lNSXI5G8J5LI4z7qhsvhluDVaku56G0qRgl1lUknGEV63JouPV9w6XotpVur6+oWtvSTlOrVqxjFJebbNGe1N2go8SbqO3tDqNaFaVHKpXT5XFRZ7rS+5jzw/Hm+mG8RiV/Ts6Dk3taaS6zadHsFucWvYRjH6CabfBI16ABDzebzOvILVjqgAFD0AAAAAADYjsP2tSpxavriMf3OlplSMn63VpJL9D+Q13NwOwToT7m6dYlh05uhb05Y55ipSl+tH5DOYLT6S+h1fA0bTSuqOC1s/xZLxaNrNx63Q27od/qd1JQt7ShOtOTfRRi238iZ5Wbu3NX3dufVNXupOda8uJ1m28vDfJfEkjeftobvlt7hLU02lVdGrrFeNq5rqoLMpfE1Huv1SZ5+xXxGc0kulOcbdbks33mm+jnDlChVvZLbJ5LsW/2+RKbWcEPyyT3iE8GkfVJrJSwSCGslG8yiWRIITySCoAD5oAjPLkXNw64dazxO3Nb6No9v6SpPnVryeIUIfdS9X6c4+LptD0S93JrVlpWm0XdX95VVKlRj1k34+xeLPSnglwd0/hHtOjp9FRr6lVjGV5euPOrNJ/Ill4Xrfi2zYMHw31+q9bZGO80HSvSWGB2+pT21ZLYuS5scIOCehcItCpWthSVxqM4L3RqNVJ1KsvLPhFdFFckvXlvJEE2So49RKjglilSjRgoQSSRy7cXFW7qSrV5OUm882V4wOnREJ5ZGcH1LbcT3g1nwJfVEZYGeQ7xPxB9UUgN5FTZDT6BE8mUTG845RTWGso157QfZb0/iNTqa1oEaWmbgSbn73FO68lLHJPwUseWehsRjmQy1ubend03TqLNP2GSw/EbnDKyr203FrwfU1yPI7XdA1HbGtXek6taTsr+2l3atGfVPz9aPix5s9N+K/AjbHF2y7mrWqpX0Y92lfUfe1YeSz4rPgzTzf3Y93tsytVnpVKO49Li/eVLZKFeK8nTb8PNSZGd9gVzavOmtaPVw7jovAtN7HEIxp3UlTqZbc9ib5p+4wXj1junaantjWdDqzpajpN7Zyi+6/TUJRin5ZaR1ri03nquvI1+VCrHY4kg07ujVzcJprtKcesd3lyZ2em7X1vWKrhZaTdXWMY9DRnOT+JRMt7B7JO994XNGV/Qht7T5LMq95zq48e7STy37XFc+p96VjcV5KMINsx17jVjh9PpK9VLLhnt7lxMNadpd7rN9QsNOtp3t7XkoUqFNe+m2b89mTs/R4V6dLVdUhTq7hu4JTmo/vEGl+5p+ecttdeS8C6eFHADbfCmip2FL3bqrj3auoXKTqSXil9zH1IypFYjhIkPCcE9SfS1snLh1EB6UaYzxdO2tc40nvz3v4IE90lc8kN5NtIuSNLe3t9m9sfi9f9aJqc+iNse3x9m9s/i9f9aJqc+iIex3bf1O7yOrtCPuWl3+bKgAYM3sAAAAAAB9ACq3nmX1WeovAzH1JtrY/3Gln8lF+eww12a+I2i7k4Y6RZ0L2jG80+jG3uLeU134yisZx1w/BmYFc0sZ9LF/GTdaVIToQlF5rJeRxfilCrRvq0Jxaes/M5XlE4fmcDvaGf32H5QV7QX+th+UXetHmYvUlyPoBwe7aH+1h8pDvaD/10PyimtF8RqS5HL4Govbz3TBWW3dAi/wB1nVldVOfSMV3Uvjcv0Gf+I/GDb3DXRLi91bUKNOcIv0dvGonUqyXSMYrxfyLxPOTijxHv+KO8r3XL+TU6mKdGj3sxo0l8GC9mW2/Ftmq49f06NDoovNy2di5knaEYHXur+N5OOVOG3N8X1FqroACMDpgAAAAAAAAAPoeiHY8tZ23BPSXNY71SvKPsdaeDzu7x6d8AdDnt7hJti0qR7k1aRqS9cpZk3+nPxm46MwzuZS5L3kQekitGNhShxcvYkZIXQkgkkw52AAAAAAKfAwz2wP8AR/3J/Ttv7RTMzeBhjtgJ/W/bk/p239oplhe/ZqnY/IzOC/edt++Pmjzk7ufEkAhE7PAAAAAAAAABfvCDjLrXB3XKt9papXFvcxUbm1rJ92rFZ7ryuaay8NebRYQPvRr1LeanSeTLK8s6N/RdvcRUovembefX9T+9Zf1t/wDIF2+Z/eqv62/+Q1DBmfly+/N7EaetB8E/S9r+Jt79fzP71V/XH/yEfX9T+9Vf1t/8hqGCvy9e5Za3sHzHwT9L2v4m3v1/M8/wUX9cf/IdRuTt26vfadVpaToNDT7qcWo161Z1VDPilhJv28jVkiR83jd9L8fsPpT0KwOnJS6HPLm3l5nYbg16+3Rq1xqep3Va8v7iTnVr1pd5yb+ZeSXJeGFyOv5INYRSYWc3J5y2s3GlShbwVOnFJLcluSKwREk8FwnmAAAAAACMokyR2fOGVTijxK0yxqUm9NtZq7vKndzFQi8qL/pNJfK/DncW9GVxVjSjvbMff3dOwtalzUeSimzebs27PlsrhLotjUpqncVKfuisl93P3z+dL2JGUEuefMppU40KUYRwoxWEl5HL44Juo0lRpxpx3JZHGN3cyu7ideW+Tb8WYt7Tn8RW8PxP/HE8zJHpp2nOXArd/wCJ/wCKJ5mySwiPNJ1ncQ7PeT36NW44fX/f7kVAhP1DqaZuJhS5kghPJIPQAAAAAAjJ05KUG4yXNNPDR98Ne1GPS/uY48qsvpPgJie4zlHcz41KNOo85xT7Ufd+z+pv/rG6/PSI/Z/U/wCULt/+NL6T4MIk9OrN8T5+qW/6cfA+79sGp/yjdL/xpfST+2DUv5Su/wA9L6T4CMIKrNcR6pb/AKcfA+q41O7vo92vd1q8V0jUm5JfKcUllFESttYPMpuW8+tOjTpfUil2FD6kEvqQeD6gAAAAAAAAEZR6QdljZUtm8ItIjVpqnc3sXd1MePf5x/8AL3TSLgPwzfFLiLpunTg52FGca95y5Oinlxb/AJz7q+NvwPTi2tYWdtSoUkoU6cVGKXRJLCRv2jdpslcyXUiCPSLisZdHYQe3fL3GlXbs3C7rcehaR324UbZ15Q8G5vCf/lZqzHxM0dr/AFT9keOOr0s973JRoUfZ7xTx8s2YXia1i81O8nlweXgSRonQVvg1vHms/HaSADDG2p5gApbyCuRUCE8kgqACM9SqWbyPMpakdY227EnCaNe5u976jRz6OUrXT4zjyXTv1PbhqK/4lzNzHyjyRZnCXakdl8O9C0lJKVC1pqo4rHem4pyl8bbZeWcLmTRhtura3hDLJ5ZvtOOsfxKeKYhVuJPZm0upLcVEgGUNeAAAABS2sdQAnzIayWzvjiBoHD/S3fa9qVLT7dco+kl76b8klzb5roawb+7c1acp0doaLGCTahe6lLPeXn6KLWPjln1Ixt1iFvaJ9LNZ8uJnsMwLEMXeVrSbXN7F4m4zaS5vBR6SH3UV8Z5uav2qOJWp96M9wToJ/wC70YQ7vsxH5+Z0NXjzxClh/tt1Jf8AiL6DBPSa14RZu9P0dYnKOc5xT5Zv4HqEpwX26+UekjnPeXynlz9XXiF99+p/lr6B9XbiF99+pflr6D5vSe2Ty1X/AN7z7f4cYh+rH2nqP34fdR+Uhzpvq4s8uvq7cQvvv1L8tfQR9XbiF992p/lr6D0tJrV/hf8A3vKf4c4h+rH2np/VtrWrjv06MvbFM+P9r2k9fcVt+RH6DzM+rtxD++/U/wAtfQTHjxxCb/hfqfxVF9B4eklp+R+w+sfR7icdirxXez08oWNrSSVGhShj7iK5fIfV3ccjzW0ftS8SdG7vc3A7vHhd0YTz7cJP5GZo4eduqnUqUrTeGjqjOSUZX+m5lFvzdJ5aXTo2+vIvLfHLSpLV2xz57jCYhoRi9pFzSVRLk9vgzb/HXlzKuiLd2bvnQ9+6VT1LRL+lfW0uTlTlmUH5NdU/Uy4kuZssJxqRzi80R7UpTpTcKiaa3p70VkNZJB6R5NLO3t9mtsfi9f8AWiamvojbHt7/AGb2z+L1/wBaJqc+iIfx1/5hU7vJHVuhH3LS7/NlQAMGb2AAAAAAAAAclvXq2tVVaFWpQqR6TpS7sl7GfZLcepTf2RvVj/6qf0nwRHdPcak48S3nb0ajznFPtR937Pal/KV7/WZ/SR+z+p/yje/1mf0nxdxDunt1Ztbzx6pbfpx8D7f2f1Px1G9X/wBzP6Qtf1Jv7I3v9Zn9J8XdHcRRVZriPVLfhTXgclzWq3clKrVqVZc+dSXef6T5lBLryOcHiUnLefanTjT2RWRQADyfUAAAAAAAPkRldAC6uF2zq2/+IGiaDSjmN3cRjVeOcacZKVR58MRUuXj5nqjaW8be2o0oxSjTioqK6clg1A7DfDWfpNR3ndUl6Ga9y2M5Rw5L/WSXqzhZ8XFm4q6YJS0fs+gt3Uktsnn3HMOnmJq9xHoKbzjTWXe95WADayNQAAAAACnwMM9sD/R/3J/Ttv7RTMzeBhjtgJ/W/bk/p239oplhe/ZqnY/IzOC/edt++PmjzlXQAEInZ4AAAAAAAAAAAAAAAAAAAAAI7pIAAAAAAAAAfQA5bO1q6hd0bahCVW4rTVOFOKzKTk8JL1ttHo32b+DtPhNsxe6oQlrl/ite1Ic1F8+7Ti/uYptettvxwaJ8Fde0zbPFLbmo6tBTs6N2lKU4pxg2mlKXkk2nn1HqNbzpV6MKlNqUJxTTXkb5oxb05a1eW9bEQV6R8RuYdHZRTUGs2+b5dxzpMJkZ5kvqSCQXuMW9p7+Ivd34p/iieZs3jB6Z9pz+Ind/4p/jieZk/Bkb6TvVuIdnvOh/RstbD637/ciX4IqITySaVnmS+3yAAB7AAAAAAAAAAAAAAAAyAAAAAAAAAAACujRqXFanSpU51alSShGFOPelKT6JIoNyeyp2bVp7tN57mtJK57vpNOsq8e66WV++Tj4Sx0T6deuMZTD7CpfVNSHe+CRrWPY5b4Hayr1XnL8K4tmTOzFwWjwp2d6e7px/ZzU+7Wuptc4pL3lNeSin8spGapNqLa8iIpY5dCX8F+wl+hQjb0o0o7ksjkm9vKt/cyuKzzlJ5nmD2h7t3XGzd1Rrn7slBc/CKUV+iKMePqXlxpz9V3d+ev7KXP8A6kv7sFmEM3z/APKn2vzOwcGWWHUF/wCkfJFYALIzQAAAAAALm4YaV+zfETbdi134V9QoQlD7qPfiWyZA7P7/APnJtL8fh/eXdpHXuILrXmYjFqkqNhXqR3qLa8D0+pR7tKC8kkVuJFL4KJfUnBbji57WVAhPJJ6AAIfQApfQxTx1446dwb2+qlSl7t1S5zC1soy5yfL3z5PEVlZ5N5aXjkyDufX7fbGg32q3MlC2tKUqtSTfRJZPL/iZv/U+J2773XtUnmdaTjRorpRppvuwXsXyvL6tmt43iLsKSUPrSezq6zfNEdHvlu5c639qG/rfL4ny773/AKzxG12rqut3crq5lygnyjTj4RjHokvJfHl8zoMZzzKe5nxKlzWCLKtSdebnUebOoLe2pW0VToRUUlkktyKXjvPJESH1Kj4p7Mi8fAiRCWSZENYCWbBUU4ZKeScZGWRTjkCnDIKwHsAfqBGc/GCmSe0urh1xJ13hjr0NV0O7dCrlKrSlmVOtFfayj0a5vn1Xh6/Q/gvxl03i/tmF9bNW2oUcQvLNyy6U/U/GLw8P5mml5kR5ZL14Q8TL3hbvqw1e2qtW8peiu6Ofe1aLaymvNPDT8GvLKNkwnFZWclTm24trjuI60r0Yo4tbSuKMcq0Vsa4pcGepSllZJxyeD4tI1Khq+mW17bTjUoXFONSE4vk01lfOfalzJXTTWaOX3FxerLejS7t7fZrbH4vX/WianuPJcza/t8fZvbP4vX/Wiany8CIscWeIVO7yR1ZoR9y0u/zZIITySYFrI3sAAAAAAAAAAAAAAAAAAAAAAAAAAAAEZ8gA8dC9OEvDPUOKu8bTR7Om1R7yndXDj72jSWctvPj0S6t4Xm10e0tpanvbXrbSNIt5XV5XliMUuUV4yk/CK8Wej3A3g1YcINrKzp92vqVy1UvLrGHOWMJLySXJfH5mx4Rhcr2opz2RW3t6iPtLdI6eDW/R0mnVkti5dbL12vt612poFjpVlTVK1tKSpQivBJHbpLqQE8r2ksRiorJbjlqc5VJOc3m282+tlYIXVkno8gAAAAAFPgYZ7YH+j/uT+nbf2imZm8DDHbAT+t+3J/Ttv7RTLC9+zVOx+RmcF+87b98fNHnKugAIROzwAAAAAAAAAATTpyrTjCEJTnLpGKy38QSzKNqKzZAydl+1bW/HSL38xP6B+1bWv5HvPzE/+U+/QVPyvwLP122/OvFfE60HY/tW1vw0i8/MS/5R+1bW/wCSLz+ry+gdBU/K/Aqry2/UXividcRlHZLa2t/yRe/mJf8AKcF5o+o6dBTu7G4toPkpVKUop/Kjy6NRfhZWN1Qk8ozWfaj5QR5kny3F2AAAAAAAAATFtc/I3b7GXGSruHR6+0tWrureafFTs6s5ZlKjnHc9fdeEvVJLwNJF0ZcXD3eV1w/3npe4LNv0tnVUpRTx36b5Tg35SWV8j8DL4Veep3EZN7M8n2GoaUYPTxjD508vpx2x7V8T1cyyX1Ou0LWKGv6PaahazU7e5pRq05LxTWTscEzJ57Ucjzi4ScJLJreYv7TnLgVu712f+KJ5ly8Eemfae/iK3d+Kf4onmbPwI00n23MOz3nQ3o2bjh9fL8/uRUlgkiJDeTTcsiXkioEJ5JB7AAAAAAAAAAAAAAAAAAAAAAAABzWdnX1G7o21tSlXr1ZKMKcIuUpSfRJRTbZ2+xtl6lxA3NZ6JpVL0l1cya70vg04pZcpPwSSbfj4JN8jf3gr2bdv8KbeneVIR1PX3FqWoVIfAz8KNOPNRXJZfNvxZncOwmrf/TTyinln8DSNIdKbbAY6klrVGtiXm3yMZdnLsnQ0edDcm86VOvepRqWulyWY0H1Uqn3UvJdI4fXPLbCMY00oxSjFLCSXJIKKSwuRV7OpKNnZ07OmqdNdr4s5kxXFrrF7h3FzLNvcuCXJIqzyEliMhEPmX5iFzPMLtFWnuTjXu2Lee9eelXLHKUYyX6JIxwZ07YujrTuNd/VjFRheW9G5T8/eqD/TTZg7uEKYlDUu6i635nZGj1aNfCrecfyL2LIAAxpsOeYAAAAAALg4c6utA3/t3UpNqNrf0assde6qkclvhNxeU8Nc0z60ZdHUjLky0u6KuaE6Mt0k0+9Hr5Qn6ShTkvtopnKvMx9wK3gt88L9C1Jz9JWdBUq2eqqQ97LK8OafIv8A9RONCpGtSjUjuaOKrmhK3rzoz3xbXgzkBCeST7luCH0JABr92ztxVNF4RTtKE/Ry1O6p2ssPDlDnKS+NR5+ayjz/AM8nz8jd3t6W9SpsHQK0FmNLUsy+OlUNHYy81+kirSFyd5k3wR0x6O6cI4U5R3uTz8ipvm2Hl8kE+eCPtUattRKBUCE8klQAAAAAAAAAAAACMcyQ+hVbym89GuyTuSpuHgro3p5+kuLNztJN9UoS96vyXFfEZo8DW7sLScuFOoN+GqVv/TpGyCZNdhPWtacnyXkca49SjRxS4px3KT8zS7t7fZvbH4Cv+tE1PbSxg2v7fH2a2x+ArfrxNTn0RGWPbL+pl1eSOj9CfuWl3+bKgAYA3wAAAAAAAAAAAAAAAAAAAAAAAAADl4gEZz0Ln4fcNtd4m63HTNCtfT1E061eo+7SoxeffSfguT828MvngF2erzjJeVbyrc+4dFtaijVrd1ynWeMuME2ljDWW+mVy6m++xOHmicO9DpaXotnC2ow5znjM6s/GUpdXJ+b+LlyNqwvBKl1q1qryj7WRfpNpnRwrWtbX6Vbc+S6+t9Ra3BXgXo3CLS16KELrWa0V7qv5QxKXnGPlFeRlSL5FCXyExzzJMpUadCKhTWSOcLq7r3taVe4k5Sb2tlb9QayEF0PuWxIAAAAAAAAKfAwz2wP9H/cn9O2/tFMzN4GGO1+v/wCP+4/6dt/aKZYXv2ap2PyMzgv3nbfvj5o85Mokh+GREhDPM7PJABUAAAAAAA217DvD3TNUo63uS9oUrq7o1o21uqkM+ixHvSlF56vvJdMpRfPmalPobs9gtL9pW5Fj/rP/APFTNjwGnGpeR1lnkmyO9O61SjhE+jk1m0nlyzRtF7mor/Vw/JHuel/s4fknN4kEsKKOXdd8zjVtS/2cPyR7npr/AFUPyUchOWNVcjy5PmcKt6S60oL/AIUfBq+3dO160nbX1nRuaE04yhUgpKSfVNM7TmyGsjVi96PUJzjJOMmmuJ57dqHgDHhVq9PV9GhJ7dvZuKg25O2qdVDvNtuLXeazz96+bMEReUenHaG21S3Pwc3LZTgpzhayr0n4xnD30WvXlY9jZ5jx5EVY9ZU7W4Tp7FJZ5cjp7QfGauKWLp13nOm8s+LWWxvr4EgA1gkgAAqAAAAAMZ5Ao1rHod2QN3z3TwesKdWTlW06pO0lnrhYcfi7so/IZzxhmnfYF1eUHu7TJzfo4+guacc8k2pRly/4Ym4allky4TUdWypye/LLwOQNKLRWWMV6S3Z5rv2+8xf2nOfArd34n/iieZcj007TnLgVu7z9x/4onmZJ9GabpMs7iHZ7yYPRr9318/z+5FYITySaZuJgAAAAAAAAAAMrdnngk+NO47u3uLqVlpGnwhUu61LHpJOWe7BZ5Lvd1ttp4S+IzXxR7FGm2W3K17s+5r/sraxdT3Ncv0kbhJZcV0w8J48G+Tx1Mxb4RdXFHp4rZ7TTr3SvDbC9VjWk1LZns2LPdmzT4E3NGtZ150Lim6VenJxnTfWLT5ohdDENZPI2unUVRa0QACh9gAAAAAAAADJXZ13/AGvDXilpusX0W7KcZ2lefdz6OM8Lv+rElHPq7x6XWV1SvbancUZxqUqke9GcXlNM8hzb7sfcfG+5snXrjvSSX7GXFR8+6utJv1c2n5cvI3bR7EI036tUeSb2dpC+n2j87lLE6CzaWUkuS49xuH5krlyKU8oq6okc59RDWCX0JIfVArkaW9u/bUqOu7d1uCXcrUp2kn5NNOPzs1UfQ9DO11s2W6+D2oV6MFK60ycbynlZfdjynj191t/EeeHeSTTZFGkFCVK9c3uazR0/oDeq7whUm9tNtd29EPqQS+pBrBJCWQABU9AAAAPoA+YKN5GzXYo4svQdy3O0NQrL3JqTda1cnhQrL4S/4lj40vM3m7y+I8gre6rWV1Sr29WVCvTkpQqQeJRkujTPRPs28d7bi3tdULqSpa/ZJU7qnKSxUwsekj6njmvB5JE0exFTh6rUe1butHPenmASpVnidvH6MvrJcHz7GZs6okjPIk3khwEPoSQAYh7UGyXvbhFq9ChSVa8tI+7KEfHvQ5vC8eWTzZxyXsPX64oxuKU4TSaksYPO/tQcDq/DDc1xrFjRztrUJupRcFn0FRvLpv1ZfJ+XLw56LpHYSq6tzTW7YyavR5jVK3lLD6zy1nnHt4owilkgqeQ3jn5kd7yfglgkAqAAAAAAAAAAAAAH0AAN8Owty4Vah5fspV/UpmyWOZrb2Fv4qdQ/70q/qUzZMmbDPpWlPPkcdaR/e9z+5mlXb4+zO2Pxev8ArxNUJG2Hb3+zW2Pxe4/WianyI3x5538+7yR0ToT9y0u/zZIAMCb4AAAAAAAB05gbgDafgP2RbLeO1qW4d0Xdwlf080bO2ahFU8vnJvLy+TwsY9eeVm9ors31eEap6tpFW4v9BqtRm6/vp2zfRSkuqfg/Pl6zMTwi6hbq4cdj29ZptDSzDK9+8PjJ62eWbWxtcMzBQIyiTDm5AAAAAAAAAAPoAAbjdh/iRYLTrvZtw/Q3sZyubXvPlVg/hRXrjhPHNtPPRM25fgkeRejazebf1my1Kwr1La7taqq06lNuLi16z0n4E8YrLi7tCheR/ctUoJQvLaXJwnjqvU1zT9q6pkl4BiPTw9WmtsVs60c36c6PTs7h4hRTcJ7+p/BmUPFFL5MnLINx3ESsrABU9AAAAAAAAAFPgYZ7YH+j/uT+nbf2imZm8DDHbAT+t+3J/Ttv7RTLC9+zVOx+RmcF+87b98fNHnJ3c+JIBCJ2eAAAAAAAAAH0N2+wV/Ancv8A3n/+GmaSPobn9g/U7Zba3LYqondq8hcum+XvJU4xi18cJfo8zZdH3leLsZG+n0W8HllzXmbaAhPkO8vMlZbUcvkgjvLzHeXmegSRjmO8vMiU4xXNpAFjca9Vo6Lwr3PdXEu7BWFaPtbi0l8rPLZLCNtO2Vxus9VprZOl3KrQo1VPUZ28005r4NLPqfN+tLxTRqYnlZRFukV1TuK6jTeeqsn2nSno+wurZWEq9VZOo80uOS3PvAANUJUAAAAAAAfQB9ADZ3sI1Mb73AsZ/wAgjL5KiX95vGjSfsFWspbq3TdZXcp2tGm165TbX6rN110JcwL7DB88zlHTd/55V6svJGLu09/EXu/8U/xRPM6fgemfad/iK3d+J/4onmXI1jSZ5XEMuXvJN9G23D637/citLBJCz4kmlZ57SYUAAAAAAA+gD6FVvBuL2BOenbvf/a2/wA0zbeCzKRqR2AvsdvH8Jb/ADTNuIfDkTFgq/8ABgckaXv/ADy47vJGnfa/4Ad2pU3vt+3cs/ZK3p+C8Kqj4JP4Xtz5s1JcFHqeu9xa07u3nRrRU6c004tZTTPPbtPcCK3DHccdR0yi1tu/qZptLKt6jeXTb8I4+D7GvWarjuE6rd1RWx71y6yR9B9JlNLDbuW1fVb49XbyMHAA0YnAAAAAAAAAAHJbXNWyuKdehUlRrUpKUKkHiUWujT8GvBnGH0Kp5PNHmUFNasj0T7NPHOjxa2s7W8qpbi06Ead1RliLqLGFVivuZY5+TTM2p9Tyg4e751Phxumz1vSqvcuaMl3oS+DVpt++g14prKPTLhtxD03iXta01jTanehUilUpP4VKa+FGS80/lWH0ZK2C4iryn0c39JLxXM5c0v0bnhFy69GP9KT2dT5P3F3NiRKa8Bnlk2Yjw+HVLClqen3NrWip0q1KVOUWspprDPKviXtOtsjfWraJW73pLSq4LK5OLbcH8cWmesGOb58zT7tucLJS9wb0s6ak4xVrfuMecly9HN+vOYv1NeXPVNIbP1m3VSO+Lz7uJJugeLKxxD1ao/o1Ml3rd4moAIyiSLTpsAAAAAAAAAP1HZbZ3RqmzddtNY0i6laX9tLvRnHo1nmpLxTWU0+TTOtIl0PrSqTpSU4PJo+FajCtCVOpFOLWTT3NHovwK7SGj8VLKNleThp24aUU6tpUl3VVX3dNvqvNdU/VhvNMZpxzlYPIazvq+nXdK5tasqFzSfehVhJqUH5prmjZ3g/20L7RqNLTN6Up6jQWIw1GjhVUv50ekn61zfk2SFh2PQlFU7l5S58H8CAdIdA61FyuMMWtHe48V2c0bvZx7CHyLY2ZxD25vuxV1oWq22oUmk36KeZRz4OLw0/U0i5+b+k3KFSFRZweaIgqUqlGThVi4tb09hJ026Ns6bu/RbnStVtIXdjXj3KlKospr+5rqmuaeGjuebfqHRcz1KOtse48wnKnJSg8mtzRoFxu7Jes7Eq19S25Tra1ouXJ06b71a38k49WuvNZ6c0upr3Wo1LerKnVpypVIvEoTi00evtSnGqsSSkvJox3vTgLsjf1SdbU9Doe6Wudxbt0qv5UWs/HlGl3ujkaknUtmlnwe7uJhwX0hVbamqOIxc8vxLfl1rieYwN2Nc7CO3aveem7h1C1TfJXajVUfkUcmKeIfZz2jw0p41biIvdPd7ys6Nmp1mn0973m0n5vCRq1bBbminKSWXaveSRZaaYZfSjCm5az3LVbfsTNfcp9AV6l7mV9VVl35W2c05VYqMpLzfNnFGXeMC1kbzCettKgAD6AAAAAAAPoA+hVbwb49hb+KrUP+9Kv6lM2SNbOwt/FXqH/AHrV/UpmyZM+G7LSnlyOOtI/ve5/czSvt7/ZvbP4vX/WianPojbLt7fZrbH4vX/WiamvoiM8dWWIVO7yR0VoR9y0u/zZUADBm9gAAAAAAPoA+h6jvPE/qM9Q+CX8U+1vxCl+qXTr+hWW5tGu9Nv6EbiyuqcqVWnOOVKL5NFrcEljhPtb8Qpfql9PnIm63+zwz5LyOKr2UoX1WUXk1J5PrzPMrjtwYv8Ag/uypaOEq+kVl6SzuoxfdlBt+9flKOMNeWH0ZjZSTPUritwy0ziltO60jUIRVVxcra57uZUKiXvZJ/P5rKPNLfGy9S4f7nvtE1Wi6N3bTccpe8nFv3sovxTXP9BG2M4ZK1qOrD6r29h0bohpL8r2/q9d/wBaK48VzXvOjBCeSTWCS0AAAAAAAAAC8+EvFPUuEu8LXWbN+ltv3u6tX0q021le1c2n5+rKdmENIuKFadCanB5NPMs7y1pX1CVvWimpLJnrLtLdOn7y0Kz1jTK8biyuqcakJrk0n4NeDTymvNM7s8++yvx5q8O9wrQdZrqW276f75Uf+a1ZPCmn4RbaT+JnoDSqRnTUoyTi0mnnwJdw6+jfUlJPat5yRpDglXA7yVCW2L2xfNfFcTnBBJl0a0AAVAAAAAABT4GGe2B/o/7k/p239opmZvAwx2wE/rftyf07b+0Uywvfs1TsfkZnBfvO2/fHzR5yroACETs8AAAAAAAAAPod1tXeOsbH1aGo6Je1LG8Sx34vk14xa6Nep5OlKsI906k6UlKDya4nzq0qdaLp1IqUWsmntRmD67fidH/r6H9Wp/8AKPruOJ38vQ/q1P6DD+EMIv8A5Tvf1X4mv/NvCf8Abw8EZi+u44nfy7D+rU/+UfXccTf5eh/Vaf0GG8DA+U739V+LC0cwn/bQ8EZl+u34nfy7D+rU/wDlOs17tL8RNxWFS0utwVIU6icW7eEaUmn1Xeik/wBJi3BMSjxK7eyVRvvZ7jo/hUJKULeCa6kUeGPEd0LqTzy+Zjm83mzPbI7IkgAHpPMAAFQAAAAVW9vO7uKdGmu9VqSUYxXWTbSSXry0eorWeSPlUn0cdZm7/YU2vPT9iaxrVWPceoXip0+XWFOKWc/0nP5DZ9PJZXCDZ8djcOdD0hqKqULePpHHl3pvnJ+1tsvVrwJpsKTo20KbW1I43xy79fxGvcZ5pt5di2L2GL+09n6hW7vxT/FE8zJ9T0z7Tn8RW7/xP/HE8zJfBRo2k/0bmHZ7ybPRqtbD6+X5/cisEJ5JNN3kwgAAAAAAPoA+hVbwzcfsCP8A6N3gv+1ofNM23j8KXsRqR2BF/wBG7wf/AGtD5pm28fhS9iJhwXP1GGf/AHacj6X/AH5cd3kievLxOi3ltPTt77cvNG1SkqtncwcJrxXk0/Bp4afg0jvl4kY9fxmXqRjOLhJZp7zUqdSdOSnF5NPNNHltxe4X6lwn3bX0e9XpLWWalndLnGtSb5NPzXRrwfmsN2Qnk9OeNvCTTuLW0qunXEFSv6bdS0u4x99Snjn7U1ya8eXikzzX3FtzUdp61eaVqlu7W+tqrpVKb65WOfsaaa80RTjWHeo1NaP1Xt/g6j0R0jjjNqqNVpVYLbza5o68DDS5g1wkIAAAAAAAAAhpYMv9nfjbdcJN10lcudXQL6ap3sFzcJPOKiXmur/mpmISsu7a5qWtWNSm8mv+5GMxHD6OJWs7aus01l/Pceulhf0NUtKN1a1I1rerFThOLymmspo+o0x7HnHl2FxT2PrtxGNCos6bWqP4L+2pN+TbzHPRtx8Yo3MhNSWU+pMFhe076iqsO9cmci4xhVbB7uVtVW7c+a4Mnu4Oi3htWy3ntzUNG1Ckq1ne0ZUakH5NdV5NdU/NI77kkQ1l9eZfzgqkXGSzTMNCcqclODyaeafWeUvEXYOocON46hoeoxfftqj9FVxhVqf2s0vDK6rLw01nkW0o+s9Bu1NwQ+qXtl6tpsGte02nKdOMf9fT6uDXi11XryvHK8+u64SlGScZJ92Sfg11RD+K4fKxrPZ9F7V8DrHRXHYY3Zpyf9SOyS9/YykAGFN1AAAAAAAAABD6EgBbNp9Wla7qGgXcbnTbytY3SaarUKkoSXqzFrkZi2n2uuIO2qEaVS/patTiul9SUnjwWY4fn4+JhJxTKol3QvK9tLOlNoxF7hFhiH2ikpdq9+8220bt73FN04altKE2176pb3rWX5qLi/1i4qfb72u8xnt/Vo1F1jFUpY/85pScDgk8mZjj98nnKSfcalV0Ewao81Tcexv3s3cuu3xt+NJu32zqk5+CrSpwj+UpSx8hZ+t9vLWLlyWmbbtrR/auvcur8qUYmrEceRUUqY/fSyyll2JHqjoLg1GWfR63a38TKW7+0zxD3gp062uTsLaX+qsIeif5a99+kxhdXNe9rTrV6s61WbzKdSTlKT9bZGUQ2sYMLXuaty9apJtm3WmGWditW3pKPYkcPtKiX1OMtjJ7HtKwQnkkFQAAAAAAH0AHWDfHsLcuFOoL/wD2lX/06ZsgupgLsX6RW0/gxQr149z3Zd160F/NUu4n8bg37GjP32xNeG/Y6XYjjfSGUZ4tcyj+Z+ZpZ29/s3tn8Xr/AK0TU59EbZdvb7NbY/F6/wCtE1NfREYY6v8AMKnd5I6N0I+5aXf5sqABgzewAAAAAAH0AfQ9R3nif1Geo/BH+Kfa34hS/VL5RY3BL+Kfa34hS/VL6XUm+1WdCHYvI4nv/tlb9z82UvnJGD+0xwLpcV9ru7sadOG4rCEpWlaSwpwx76lL1PwfVNGcmQ4p8scj3cUadxTdOos0xYXtbD7iNzQeUovP+DyDu7Gvp1zUtrmEqNxTk4zpyXOEk8NP1po4zcjtgcAJ31tW3rt20i7qlFy1C2pruuqlj905eKS5+pZ8DTlxRD2IWNSxrOnLdwfNHWuAY5Rxu0Vense6S4plIAMYbMAAAAAAAAAOnNcmbqdj/jutbsKWzdcu3LUrWmlZVasudamuscvq4rmvFr2GlZ9ekalX0fUrXULOrKheWtVVaNWDxKMl0aMnh99UsayqQ3cVzRq2kWC0cZs5UZbJrbF8U/hzPXVtMnojEvZ+412vF7acKtRe59atWqV5bN5xLHKcX4pr5HleGXlmLz7GTFQrRr01UjuZyVd2tWyrSoVllKLyKiQC4LUAAAAAAp8DDPbA/wBH/cn9O2/tFMzN4GGe1/8AxAbl/pW39oplhe/ZqnY/IzOC/edt++PmjzkXQAEJPedngAFAAAAAAAAAAAAAAAAAAAAACjWYAAKgAAAAiXQAkzv2R+Fb3zxAo6zeUnPR9IlGs+9H3tWssShHP814k16kYg2htLU98bhs9G0mg7i8uZqKXhCPjKT8IrxPTDhFwzseFWybHQ7NKpOnHvV7hrEqtR9ZP5kvBJI2rA8NlcVo1pr6Mdva+RFum+PRw60dpSf9Sostm9J72/cXzFKMUkVEJoklM5pMV9pz+Ird/wCJ/wCOJ5my8Eemfad5cCt4fif+OJ5myXLmRrpOnK4h2e86G9GstXD66/8Af3IlLBJCeSTTMsiYkAAAAAAA+gD6FVvBuR2BP8w3h+Ft/mmbbr4T9iNSOwJ9jt4fhrf5pm28PhP4iYcF22MP+8TkfS/78uO7yRUlzKilPwDfMzWRp24iWe7yNee1HwEXELR57h0agnuKyg8wiv8AOaS5uDXi1h4frZsNh+Ya7yafRlndWtO7punUWaMlh9/Ww24jc0Hk4vxXJ9R5CSg4yakmmnhpkNY8TajtccAZaXfVd6aBa5tqzzqNvRjj0cvCskvBt++x0fvvPGqvpE+WSIL+yqWNZ0prsfBo62wPGKONWkbilv4rinyKXyAznmDHGwgAAAAAAAAHLRrVLatCtRnKlWpyUozi8OLXRo9D+yzxeq8U9iyhfTVTV9LlG2uJ+NVOOYzfk5Lr60/YvO42R7CmrVLTiXq+np5oXen+lks/bU5xUX8k5GzYBcyo3KprdLYyNNO8Op3WGSrtfSp7U+O9JrsyN7k88g3jwIXUPqSucwspqRU1h+Jpr2suznK1ubreu27Vejku/qVtRjh8utVLy55kly6vlzNzOefiOGvQhcUZU6sYzhJNNSWU0zH3tnTvqTpVO58mZzB8XuMGuo3NB9q4NcjyG9pJst2m+zJV2lcXO6ts0XU0ecnO7soRy7X+dHzh1yvtfDK5LWnGPEiC8s6llUdOovg1zR1hhGMW+M20a9CWfNcU+TKAHyBYmdAAAAAAAAAAAAAAAAAAJyyMgAAAAAAAAAAAAAB9DsNu6Dd7o3Bp+kWNOVa7vKsaVKEVlttpZx5Lq/Uj4qNCpdVoUqUHVq1JKMYRWXJvokbz9lbs6T2DRW5tw0o/tguIJ0KDWfclJrpn7tpvPknjrkzGG4fUv6uqvqrezUNJMeo4LaSk39OSaiuLfPsXEzpsDatDZWzdH0O2goUbK3hSxFYWUub+N5fxlxJ5wM80SsEwU4KnBQisklkck1Kkqs3Uk8222+80t7fH2b2z+L1/1ompz6I2x7e/2a2x+L1/14mpz6IiPHvt9Tu8kdUaE/ctLv8ANlQAMGb6AAAAAAA+gD6HqP1jxP6jPUfgj/FNtb8Qpfql8ljcEl/8p9rfiFL9UvlcicbVf0Idi8jii++11n/7PzZUvYE8kN+BUXLLE4a9GFelKnOKlCSacZLKaNAe1PwEnw71yruDSKedu3lXM4RjytZvm0/5rbePLp4HoE+Z0m59tadu7QrzSNUtoXVjcx7lSlUWU14fGnhp+aRicQsKd/RcJb1uZsmAY3VwS7jWjti9jXNfFcDyYyiS/ONvCa94RbwqabVhKWnVczs7nGFUgn09qys+1eZYXeIhuKErarKlPemdbWV5SvreFxRkmpLNEgAty+AAAAAAA6dAAMi7uF/E7VeFe6bXWNNkpwi1G5oPpWp599H1PxT8Hg9Otr7htt1aBY6taTU7a7pRq05LyaTWV4Pn0PJZrkejnZKvpXvBDRe+8+inWpL2KpJI3rRm4m5yt5bssyEPSPh9FUqV9CKUs8m+fLPsM0AAkMgYAAAAAAomuRiLtX2VTUeAu5qVFZmo0auPVCtCT/RFmXmdPuzQKO6NvajpdxFTo3VCdKUZLKacWv7y2uKfS0ZU1xTRfYfXVtd0a73Rkm+5pnkv3eXUd07ndm2LzZ+49R0e9i43NnXlReVhSw+Ul7YtS9jR02cciEasHTm4PejtOjWhWpxqReaks0+GTIAB8T7gAAAAAAAAAAAAAAAAAAAAAAAAEN4DawCiaZJ9ej6Lf7h1Ghp+l2dW/v68lClQoxzKTfh6vb0STbwkdvsPh7rvEnW4aXoNlK6rSw5zfKFKL+2lLpFdfW8PGXyN+uBPZ40nhFpsLms1qOvVY4rXs/tM/aQXRRXn1fi+SM7h2FVb6SeTUeeWzuNF0j0ptcFpuEZa1V7kvN9R8/Zz4A2vCLRJXd4qVzuS6hFXVzT5qml/q4vHwefPxeF5JLNvMRylzDZK1tb07WmqVNZJHL99e1sQryubiWcpPNlRD6EkPoXRZGMu0hazvuCO76VJZn7hnPHqjiT/AEI8ykkurPXTVrKlqGnXNpXgqlKvSlTlGSymmmmv0nlZxL2TdcPt8arol0pf5LVcaMmsd+nluMl5pxa/SaBpLQlrQrrduJz9G93DVrWb+tmpLr4Mt4ELkupJoJOi5AAAqAAAA+gCTk8Lm3yC2s8yainJm6HYHsZ09vbovH8CrdUqa5fbRhl/rI2thylL2Ixb2b+H8+HfCnSbG5pehv68PdN0n8JVJ82n60sL2pmU0ubfsJqwylKjaQhLfl57TjvSG7he4rXr09zeS7Fsz9hX3hEgnumTNaI5p9CpoLmiHywD3vPmv7CjqNrVtrinCrQqxcKlOaypJrDTPOntJ8Dq3Cfc87yxg3t6/lKpQm+lGXV02/m9S9R6Ot4Lb37sXS+I22bzRNWt1XtLmOHjlKLXwZRfg08NP1GFxTD439HJr6S3G26N49VwK7VVbYPY11c+1HlHnHUku7ilw11ThfvK60XUkpqKVS3uIrCrUm33ZLy6NNeDTLSwvMiGpTlRm4TWTTyOr7W7pXlGNelJOMlmmiAAfIvAAAAAACs2J7DdjUrcVtQu0v3Chpk4Tlno5VId1fH3ZfIa7G9XYo4cT2vsO51y6pKFxrM4VIJp5VKKfdznzblL2NGx4DQlVvIuP4drI+04vKdtg9SEn9KeSS8zZVEkLoSS0csAhrJIAPnr0KdzSnSqwVSnOLUoSWU0+vI057RXZRnYRudybMoTqW2ZVbjSKUc9zPwpUV5fzF8XgjcvAlFSTysr1mPvLKje09Squx8UZzCMYusGuFXtpdq4NcmeQVWlKlUlCacZRbTTWGmUG/vHXsqaXxGVXVdBcdH17Dk+7F+huH/PivH+cv0mjm8NmaxsTWaul63Y1bG9g/g1I+9kvBxl0lF+aIsv8KrWM3xjz4HTWB6T2eN00qb1aiW2L393NHSgAwpuKAABUAAAAAAAAAAAAAAAAAAAAAAZAGZD6HZbe21qW7dWt9M0mzq6hf15KMKFFZk/Xz5JLxbaSXPomXfwn4H7k4u32NMoqhpUJd2tqdVP0UV49zp33y6Rfta5G+nCfgdt7hNpEaOmUFU1GaXp76qk6lZ+T5YS54wkvl5vZMOwSrevWqrKPXxI50g0xtcJi6VHKVV7EuC62Wb2f+zFpnDC1parrMIajuWS/fJLvU7XPWNNPKbXTvdeqWMvOfsYXILpzJ6sk62t6dpTVOmskjmy+vrjEa0q9xLWb9nZ1BJ5HVjLD+cuzH7zTLt72clf7WupPFL0denJ+TzBmpB6LdrDhvW4gcLL6dlRVbUtMfuuhDxmkmpxXrcXlcuqSPOZePMijSGjKF45tbHlkdOaA3tO4wtUIv6UG0127U/acwANZJNAAAAAAAyOqL24McP6/EziPo2kUoSlb+lVa5n4Roxacn6m+ifmy4t6Uq9WNOO9vIsb25p2dtUr1Xkkm33I9GeENlU07hltm3qrFSFhRUl/wp/3l4JPLKKFCNtRp0oLuwhFRSXRJLByNesm+lHo4KPJJeBxXXq9NVlUy3tvxZV8RJCeST7HxBGF5EgAx5xh4VabxX2lX0q7pxhcwzVtrhRzKjUSeGn5PLTXim/aea+7dp6hsvcV9o2qUXQvLSo6c0+kvKUX4xaeU/FHrQlj2GBO1FwGhxQ0CWraXThT3BYwzCWMOvBc3Tz54bw/Pl4mqY1hau6fSU19JLxJK0O0keFV/Va7/pSfHg+fZzPPtQx4junJVo1LetUo1qcqVanJwlCaw4teBx94i7Va2HTcZKS1kQACh7AAAAAAITyei/ZBt6lvwQ0j0ix6SpWqL2OpLB587f0G73RrdlpWn0nXv7yrGlSprxbeMt+CXV+rPkep2wNrUdlbO0nRaEVCFnbxp4isLKXN/G8s3XRilJ1p1fwpZd5C3pJvKatqVrn9JvPLikl7y5QQuhJJBAAAAAAAAIwiQAa29qbs6/VBspbk0GjGG4bSn7+nGOPdcFz7rf3S548+nknondW1WzuatC4pSo16cnGdOaxKMl1TPXuS7yML8ZuzFtvi1N36T0nWlHCvLZYU/JTj0l7eT5vmadiuC+svpqGSlxXMlbRbTF4bFWd7m6a3PivijzpT9RJlHiB2a98cO51J3GmT1Owh8G9sE6qa83Fe+j8aXQxhUpzozcJxcJxeHGSw18RHda2q0JatSLTJ+ssTtb+mqlvUTXU17TiAB8dWRkdeHMAApkxrw5gADVY14cwABqsa8OYAA1WNeHMAAarGvDmCMoS6H2WOjX+p1lRtLG5uqr/1dCjKcn8UeZXo5v6qPnKvSgtackl2nyESMobX7NHEfdjpyt9t17OhLrW1CSt1D2xliXyJmadmdg+rJwr7m1xY8bawhjH/ABvr8iMtbYVeXDThB5Pi9iNWvdLMIsk9asm+S2v2GplpZV76sqFrRncV58oU6cXKUn4JKKb/AEGwfCLsd69vKNC/3PKWg6Y2pe5kk7ir1zFrGIx9bef5pt3sPgns/hvQUdE0ahQrtJSuJpzqy9snl49XQvuMVCOEkl5JG32WjlOGUrl6z5LcRNjHpAr3CdLD4uCfF7+5cC2Nh8OtC4b6LDTNCsIWlCPOU8ZnUf3UpPm362y6E2uT8CpB9PWblCEKUVGCySIkqValaTqVZNybzbe8nPLkSQ+SKT0z5bisEJ5JPRUoayYE7TvZ/hxV0aGp6VijuKyg+44rHuiH3Dfmn069WvHJnzOMkefkW1xbwuabp1FmmX9hf1sOuI3NB5Si/HqfUeQ+paXdaNf17O8t6trc0ZOM6VeHcnFrzR8ywl1PSPjN2bttcX6Sr1qf7G6xTi1S1C3jiWPuZLpJfI/JrmadcQezBvvYEq1V6Z+y+nw6XOnZqPHrh8JdPJr1kX3uCV7VuSWceaOlcD0xsMTgo1ZKFR703kn2P/rMRA561rXtakqdehUt5xeHGrFxkn7GUd011wkuBv6qQltUjjGTkceReexuDO8eIdWMdI0O6lRlhu5uIujSjHz70kk/ZHLPtSt6td6sItvqLa5vba1pupXqJJcW0ixkvM2q7KvZvuNR1K03lua09HY0ZKrp9pXj76pUT97VlHwUXhxz1fPwTd/cGexzpW1Lq31bdlWGu6pTw4W3dfualJdMpt99rw73JeWcY2Wo0YW1KNOnGMIRWFGKwkl5I3rCcCdKXS3K2rcviQdpPpurinKxw5vVexy5rkviVpd1JLkkSCYm9JkKbyVy+MZfkQ3kNvJUruEiopiO8Ag3kgmRAKMxhx04L2PF7atS2zG11eh+6Wd4o86c/J+cXyyvUedm6to6tsjW7nSNbs5WN/Qk4ypy5qS8JRl0afg0esPXoWNxS4R6BxX0T3FrFtmpDMqN1SajVoyfjGXzp5T8UzWcVweN/wD1IPKWRIujGllXBX6vXWtSb3cV1r4Hl4o48Q1hZM88S+x5u7aE6t3ocFuPS4880ZKNeC9cPtvH4OX6jCN9pd9ptWdK9sq9pVi8Sp16UoSi/XGSTXyEbVbGvby1asHmdE4fjVhiVPXt6ifftXaj4XyeAQ2u8Gslm4szHSQ/MTkFxbX4b7o3pdU7fRNEu7+dTpOnTapR8m5ySil18fA2f4TdiKNCtSv98XEblRSl+xds33JPnlVJdZLpySWfF45GTtMMubtrUi8ub3Gs4ppLh2FQcqtROXBLJt9xi3s7dna64pa3S1PWrevbbatW5Sk04e62vtYvxjy5vy5eOV6EWFnR06zo2ltSjRt6MFTp04LEYxSwkl4JJJFGn6Va6TY0rSzowt7alFQp0oLEYxS5JLwR9iikiUcPw+nh9PUhtb3s5ox/HrjHrjpauyK2JcEviVJ5JAMuawAAAACGARnGEWtvzhxoPEjSJafrlhTvKT5wm1idN+cZLmn60XQs+xkrmfKcIzi4zWafBn0pValCaqUpNSW5rYaIcW+xxr+1VO+2vKWu6ZFNytpcrikl/wCp49OfLo8mut3aVbC4nQr0p0a0HiUKkXGSfrTPXhxT6lg8ROCu1OJttKGs6ZSlc4ajeUF6OtD1qS5+XJ5Tx0NOvdHKdTOVu8urgS3gvpAr2uVLEI68ea3963M8wAbPcQOxBrumTqVtsanHWKC5q2vH6OrjyUujftcU/Ua+bo2LuDZl3O31vRrrT5wl3W61NqMn5xl8GS9aZplzhtzaZucHkuOWwmXD9IsMxKKdCqs3w3NdzOhBHL1EmLNjTT2gDIBUAAAADIAAyAAARLoMm9iPLko7ycrzIbyuTL62NwT3lxCrQjpOiXLoSw3dXEPR0FHzUm13vHlHLNk+H3YZsbT3Pc7r1Wd3VisztLDvU6cvNOT99j+jh+szNrhF1dZOMWk+L3GpYppVhmFZqrUTkuC2v2Go+29p6zvDUY2OiaZcapdvH7nbrPdz0cm+UVy6vCNsuD/YnpWvodS3vWp3NRpSWlUVmEHz5Tnn33hySS9b8NmtrbK0PZFhCx0XTLXTraCSjToU0vjb6t+t82XAn4G82GAUbdKVb6UvYQpjOnd7f50rRdHB8eL7+HcfDpWjWOh2FKzsLWjZ2lGKhSoUIKEIJdEkkkj7kvHBPhz6Bm0ZZbERk25POW1k9EGsrkE8lJ7PL2FYITySCpxVKcatOUZpOMlhp+KNDe1F2dbnZ2q3O6dDpSrbfuJyqXNKnF5tJt5lLHjBtt58PZjG+jWceRx1qELilKnVjGcJLDjJZTRjb6xpX1PUnv4PkbBgmNXGB3Kr0Nqe9cGjyE7q6jum6vF3sXWWuXNxqm0LiGmXNRuc7Cqn6CTf3GOcF15Ya8sGrO9OEu7uH9xKlrOhXlvGLwq8abqUpeuM495fLh+oiu8wu4s29aLa5rcdM4VpThuKwTp1FGfJ5J5+8s8Ah5MVqS5G1dLDLPWJIyjltLO4vqypW9CtcVH9rRpucvkjzMycPOydvjfTp17izlt/T5c/T38cTa8WqaeX8fdyXNCzuLiWrSg2zF3uL2WHwdS4qKK7d/ZzMRaJo19uPVbbTdNtql5e3MlClRprLbfzL1noh2ceBVLg/tmc7qULjXr5qpeV4xwodcU4/wA2OXz8W2/Udrwh4A7c4QWXdsKcrvU6kUq+o10vSz9Sx8FdeS8+bb5mUWsepEjYTgvqT6Wtk5cOo590q0vnjGdrbZxo5977eogmJOESbZvIxSyAABUAAAFMknFprkVEPoAai9qfs0VtWrV947TtnUuu65X2nw5ekx/rIL7rrlY59euc6cTjKE5QnFwnFuMoyWHFrwZ6/OKlHDSafgYE40dk7b3E2vW1TTp/sJrck3OpSj+5Vn4OcVjn600+fPOFjTMUwLppOrb5JveuZMGi+mvqUY2eINuC2KW9pcn1Hn6nkkyHvzs/714czlLUdGuLm2TxG6sIuvSkvasyj/xJGPMOLcZJxlHk4yWGvaiPattVoS1ZxaZO9piNpe01Ut6ikupoAEwpzqtqEHOXhGMXJv5D4qDfAup1oR3yIK6NCpc1qdKlTnVqVJKEYU496Tk+iSMk7A7Oe+OINaDttHrafYv4V5fxdGK9kXiT8cNJr1m33Bnst6DwwdO/vGta1uOHG5rwXdovnzpx+1bTab5vywZ6wwW4vNrWrHm/caPjWl2H4VBxhJTqLgnn4vgW12UuzvLY9pT3VuCklrlzDNvbTXO1pyS6rwm+fsTx1bNmOS8CILCwipkoWtrTtKapU1kvPrOasTxK4xa6ndXMs5P2LgkVAAvTFgAAAAAAAAAjBIAOKdONSOJRUvajo9X2Lt7X01qOj2V3nxq0Iy+dHf8ANeIeWfOVOE/rJM+kKtSm84SafU8ixJ8ENjTf8GdP5f8AYRKfqG7G+9jT/wAxH6C/eYx6j4ytqMt8F4F38oXv60vFlh/UP2L97Gn/AJiP0D6h+xfvZ0/8xH6C/MDB59Ut/wAi8EPlG9/Wl4ssP6h+xfvY0/8AMR+gn6h+xfvY0/8AMR+gvvA7p6VrQX4F4IfKF7+tLxZYf1Dti/ezp/5iP0D6h+xfvZ0/8xH6C/MDulPVbd/gXgh8o3v60vFlh/UP2L97Gn/mI/QPqHbF+9nT/wAxH6C/MDuhWluvwLwQ+Ub39aXiyxPqH7F+9jT/AMxH6AuB+xk8/tY0/wDMR+gvvAwV9WoP8C8EPlC9/Wl4ss+04Q7NsaqqUNt6bTmujVrD6C4rXSLKxpqnb21GjBfawgkj7sINH1jSpw+rFLuLedzXqfXm32tsojCMekUirPqJaRPP4j6LJFvtfELmiHnxIJyw3kEyoAFSoAAAAAAAAAKJwjNYkk/aVg8tJ7GDodY2ZoWvxxqOlWl5669CMvnR0P1Etj5z+1rT/wAxEvlInJ8nQpPbKKfcXdO8uaS1YVJJdTaLW0rhltTRKvpLHQNPt6j6zjbRzy9eORclOhTpRUacIwS6d2OEcvdSJ5+09Rpwh9WKR8Z1qtV51JN9rzIwl4j4/wBBUD6nyAAAAAAAAAAAABDWUSADjlFSTzzTOr1Pbml6tSdO80+2uoPPvK1KM4+vk0dtyZDWHyPLinvPUZyhti2n1FlVOC+x6uO/tbS3j/6aH0HNYcI9maZU9La7Z0yjP7pWsfoLwXIe0+Ct6Md0F4IuXe3TWTqyy7WcFC0pW8Iwp0oQiuijFJI+kEZPtllsRatuW1juhLBIPZQAAAAAAAAAgkAAEYRIAKcYR8epaRZ6tbTt7y0o3VCaxKlWpqcX7U+R9ucDOTy1nvKqTi84mHt1dlfh3ur0k5aHDT7iXStYzdKUfYly/QYh3H2CqM3OWh7pqQUsyVC/t1PL8+/Fr5mbfYyMGKrYVaV3rTgm/DyNjtNJMVsslRrvLk9q9uZ596z2Kd/6c5St3p2oQXjSryjL5HFfoZZ+pdmviNpzl3ttV66XR0Jwkn8fePTHuod1P7VGLno7aS+q2jbLf0h4rSWVRRl2r4M8s6/BrfFv3XPa2qLPT/JpP5kz4anDLd1Pk9tao/8A7Wp/ynqx6GCfwI/IS6NP/Zx+Qs3ovRb/ALj8DIQ9JF4vrUU+9o8p6fDLd1Tl+1nU1/8Aaz/5T7rbgxvq6cvRbV1SeMZ/cJR6/wBJI9SvQ0/9nH5B6KC+0j8h6jozSj/qMT9JF6/qUYrvbPNvTOyxxL1VQcdvTtlLr7pqxjj282Xlo3Yb3veOLv7/AEzT19slKdVr2Yik/lN81FeSKk+Rdw0etI/WzfeYuv6QcXrR1YasexbfazVfbPYP27ZzpV9c1y71OrHrC2pqhTb9fwn/AOZGZNo8BNjbKcZ6Zt+1jXisenrR9LNr1ynl/pMiBGWo4da0HnCCz55Zs1G7x7Er7+/XbXLPJeCOKlQhSwoQjGK5JRWEviOUAye4wDbe8qwgSBvKgABvIAAFQAAAAAARhHFVt4VVicIzi+qcc5OYHlrPeE8txaWpcLtpapP0l1t7Tqk/unbQz8x164JbHisx21p6/wDAj9BfeBjofB29J/hXgXsb66gso1JJdr+J0ej7R0fQId3TtOtrVePoqMY/MjuoR7iwlgldSrHI+6io7i1nUnVetNtvrGESAV3ngAAqAAAAAAAAACBhEgA45wjOPvop+1Fu6xw923uHK1DRbG7fi6lCLb/QXKnkjmfOVOE/rLM+kKtSk86cmn1PIsJcDNiZz+1fTvb6CP0HdaRsLb+gJLT9Gs7bljNOhFPHtwXG1gZwfKNvRjugl3FxK9uqi1Z1JNdrIhBRWIxUV6icPCwQTln3zLLMl8vAjveogFd5TMrABU9AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEYJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/Z" alt="ERCAN BRGR" style="width:140px;display:block;margin-bottom:4px;filter:drop-shadow(0 2px 8px rgba(232,57,10,0.3))">
          <div style="font-size:8px;font-weight:800;color:rgba(255,255,255,0.35);letter-spacing:5px;margin-top:2px">ENVANTER SİSTEMİ</div>
        </div>
        <div style="height:1px;background:linear-gradient(90deg,rgba(232,57,10,0.4),transparent);margin:12px 0 0"></div>
      </div>
          </div>
    <div id="drawer-search"><input type="text" id="search-input" placeholder="🔍 Ürün ara..." oninput="filterProducts()"></div>
    <div id="product-list-header" onclick="toggleProductList()" style="display:flex;align-items:center;justify-content:space-between;padding:8px 14px;cursor:pointer;background:rgba(255,255,255,0.05);font-size:11px;font-weight:700;color:rgba(255,255,255,0.6);letter-spacing:1px;text-transform:uppercase;user-select:none">
      <span>📦 ÜRÜNLER</span><span id="product-list-arrow">^</span>
    </div>
    <div id="product-list" style="flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch"></div>
    <div class="drawer-footer">
      <div id="admin-panel-kart" style="display:none;margin:0 0 8px;padding:12px 14px;background:linear-gradient(135deg,#1a1a2e,#16213e);border-radius:12px;cursor:pointer;display:none;align-items:center;gap:10px;border:2px solid #e85d04;box-shadow:0 2px 8px rgba(0,0,0,0.3)" onclick="currentProduct=-1;showAddForm=false;renderAdminPanel();closeDrawer()">
        <span style="font-size:22px">?</span>
        <div><div style="color:#fff;font-size:13px;font-weight:800;line-height:1.2">Admin Paneli</div><div style="color:#aaa;font-size:10px">Tüm şubeleri yönet</div></div>
      </div>
      <button class="drawer-btn" style="background:#e67e22;color:#fff" onclick="setMinStok();closeDrawer()">⚠️ Min Stok Uyarısı Ayarla</button>
      <button class="drawer-btn" style="background:#27ae60;color:#fff" onclick="gunlukPdfIndir()">📋 Günlük Rapor (Tüm Ürünler)</button>
      <button class="drawer-btn" style="background:#3498db;color:#fff" onclick="openSatisModal();closeDrawer()">📊 Satış Raporu Yükle</button>
      <button class="drawer-btn" style="background:#c0392b;color:#fff" onclick="openSktModal();closeDrawer()">? SKT Takibi</button>
      <button class="drawer-btn drawer-btn-red" onclick="doSignOut()">Çıkış Yap</button>
    </div>
  </div>
  <div id="content"><div id="skt-banner" style="display:none"></div><div id="page-content"></div></div>
  <div id="bottom-nav">
    <button class="btn btn-primary" style="flex:1" onclick="toggleAddForm()">+ Gün Ekle</button>
    <button class="btn" style="background:#f0f0f0;color:#333" onclick="window.print()">Yazdır</button>
  </div>
</div>

<div class="overlay" id="satis-modal">
  <div class="modal" style="max-width:560px;max-height:92vh;overflow-y:auto;padding:20px">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px">
      <h3 style="margin:0;font-size:16px">📊 Satış Raporu Analizi</h3>
      <button onclick="closeSatisModal()" style="background:none;border:none;font-size:22px;cursor:pointer;color:#aaa;line-height:1">?</button>
    </div>
    <div style="font-size:12px;color:#aaa;margin-bottom:10px">POS raporunun tüm metnini aşağıya yapıştırın</div>
    <textarea id="satis-text" rows="9" style="width:100%;padding:10px;border:2px solid #eee;border-radius:8px;font-size:11px;font-family:monospace;resize:vertical;outline:none;margin-bottom:10px" placeholder="JOKER ALEV ALEV BU      1        370,00&#10;TASTY CHEESE BURGE      2        940,00&#10;..." onfocus="this.style.borderColor='#e85d04'" onblur="this.style.borderColor='#eee'"></textarea>
    <button onclick="analizEt()" style="width:100%;padding:12px;background:var(--orange);color:#fff;border:none;border-radius:10px;font-size:14px;font-weight:700;cursor:pointer;margin-bottom:12px">Analiz Et →</button>
    <div id="analiz-sonuc"></div>
  </div>
</div>


<div class="overlay" id="rename-modal">  <div class="modal">
    <h3>Ürün Adını Değiştir</h3>
    <input type="text" id="rename-input" placeholder="Yeni ürün adı">
    <div class="modal-actions">
      <button class="btn btn-outline btn-sm" onclick="closeRenameModal()">İptal</button>
      <button class="btn btn-primary btn-sm" onclick="confirmRename()">Kaydet</button>
    </div>
  </div>
</div>

<div id="install-bar">  <span>Bu uygulamayı telefona yükleyin!</span>
  <div style="display:flex;gap:8px">
    <button onclick="installApp()" style="background:#fff;color:var(--orange);border:none;padding:8px 14px;border-radius:6px;font-weight:700;cursor:pointer">Yükle</button>
    <button onclick="document.getElementById('install-bar').classList.remove('show')" style="background:transparent;color:#fff;border:1px solid rgba(255,255,255,0.5);padding:8px 10px;border-radius:6px;cursor:pointer">?</button>
  </div>
</div>
<div id="toast"></div>

<div class="overlay" id="skt-modal">
  <div class="modal" style="max-width:520px;max-height:90vh;overflow-y:auto;padding:20px">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:14px">
      <h3 style="margin:0;font-size:16px">? SKT (Son Kullanma Tarihi) Takibi</h3>
      <button onclick="closeSktModal()" style="background:none;border:none;font-size:20px;cursor:pointer;color:#999">?</button>
    </div>
    <div style="background:#fff3cd;border-radius:8px;padding:10px 12px;margin-bottom:12px;font-size:12px;color:#856404">Yaklaşan veya geçmiş SKT tarihli ürünleri buraya ekleyin. 5 gün kala ve son gün uyarı verir.</div>
    <div style="display:grid;grid-template-columns:1fr 90px 110px auto;gap:8px;margin-bottom:14px;align-items:center">
      <input type="text" id="skt-urun" placeholder="Ürün adı" style="padding:10px 12px;border:2px solid #eee;border-radius:8px;font-size:13px;outline:none" onfocus="this.style.borderColor='#c0392b'" onblur="this.style.borderColor='#eee'">
      <input type="text" id="skt-miktar" placeholder="Miktar" style="padding:10px 8px;border:2px solid #eee;border-radius:8px;font-size:13px;outline:none;text-align:center" onfocus="this.style.borderColor='#c0392b'" onblur="this.style.borderColor='#eee'">
      <input type="date" id="skt-tarih" style="padding:10px 8px;border:2px solid #eee;border-radius:8px;font-size:13px;outline:none" onfocus="this.style.borderColor='#c0392b'" onblur="this.style.borderColor='#eee'">
      <button onclick="addSktEntry()" style="padding:10px 14px;background:#c0392b;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:700;cursor:pointer">+ Ekle</button>
    </div>
    <div id="skt-list"></div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js"></script>
<script>window.onerror=function(msg,src,line,col,err){var d=document.getElementById('giris-err');if(d){d.style.color='#e74c3c';d.textContent='JS HATA: '+msg+' (satir:'+line+')';d.style.display='block';}return false;};if(typeof supabase==='undefined'){document.addEventListener('DOMContentLoaded',function(){var d=document.getElementById('giris-err');if(d){d.style.color='#e74c3c';d.textContent='CDN yuklenemedi - internet baglantinizi kontrol edin';d.style.display='block';}});}

const SUPA_URL='https://gqhfxpczgxksbfybfesz.supabase.co';
const SUPA_KEY='sb_publishable_0L6Pcm4GYzaEyIQ8Dup-6A_LqT-Z-FS';
const {createClient}=supabase;
const sb=createClient(SUPA_URL,SUPA_KEY);
let currentUser=null,isAdmin=false,isSuperAdmin=false,appData={products:[]},currentProduct=0,showAddForm=false,syncTimeout=null,acikGunler=new Set();
const DEFAULT_PRODUCTS=[
  {name:'Mini Et Burger',birim:'Kg'},{name:'Joker Burger',birim:'Kg'},
  {name:'Super Burger',birim:'Kg'},{name:'Tasty Burger',birim:'Kg'},
  {name:'Special',birim:'Kg'},{name:'Mini Tavuk',birim:'Kg'},
  {name:'Tavuk Burger',birim:'Kg'},{name:'Tenders',birim:'Kg'},
  {name:'Patates',birim:'Kg'},{name:'Nugget',birim:'Kg'},
  {name:'Soğan Halkası',birim:'Kg'},{name:'Çıtır Tavuk',birim:'Kg'},
  {name:'Stick Peynir',birim:'Kg'},{name:'Karamelize Soğan',birim:'Kg'},
  {name:'Füme',birim:'Kg'},{name:'Kızartma Yağı',birim:'Lt'},
  {name:'80 gr Ekmek',birim:'Adet'},{name:'Mini Ekmek',birim:'Adet'},
  {name:'Kutu İçecekler',birim:'Adet'},{name:'Soda Grubu',birim:'Adet'},
  {name:'1 Litrelik İçecekler',birim:'Adet'},{name:'Ürün 22',birim:'Adet'},
  {name:'Ürün 23',birim:'Adet'},{name:'Ürün 24',birim:'Adet'},{name:'Ürün 25',birim:'Adet'}
];
function toast(msg,dur=2500){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),dur);}
function switchTab(tab){document.getElementById('tab-giris').classList.toggle('active',tab==='giris');document.getElementById('tab-kayit').classList.toggle('active',tab==='kayit');document.getElementById('form-giris').style.display=tab==='giris'?'':'none';document.getElementById('form-kayit').style.display=tab==='kayit'?'':'none';}
async function doGiris(){
  const email=document.getElementById('giris-email').value.trim();
  const pass=document.getElementById('giris-sifre').value;
  const errEl=document.getElementById('giris-err');
  const btn=document.getElementById('giris-btn');
  const card=document.querySelector('.auth-card');
  if(card)card.style.border='3px solid orange';
  if(!email||!pass){if(errEl)errEl.textContent='Email ve sifre girin';return;}
  if(btn){btn.disabled=true;btn.textContent='1/3 Giris...';}
  if(errEl){errEl.style.color='#888';errEl.textContent='Adim 1: Supabase baglantiyor...';}
  const{data,error}=await sb.auth.signInWithPassword({email,password:pass});
  if(btn){btn.disabled=false;btn.textContent='Giris Yap';}
  if(error){
    if(errEl){errEl.style.color='#e74c3c';errEl.textContent='GIRIS HATASI: '+error.message+' ['+error.status+']';}
    if(card)card.style.border='3px solid red';
    return;
  }
  if(errEl){errEl.style.color='#27ae60';errEl.textContent='Adim 2: Giris basarili! Profil yukleniyor...';}
  if(card)card.style.border='3px solid green';
  await onSignedIn(data.user);
}

async function doKayit(){const email=document.getElementById('kayit-email').value.trim(),pass=document.getElementById('kayit-sifre').value,pass2=document.getElementById('kayit-sifre2').value,errEl=document.getElementById('kayit-err'),btn=document.getElementById('kayit-btn');if(!email||!pass){errEl.textContent='E-posta ve şifre girin';return;}if(pass.length<6){errEl.textContent='Şifre en az 6 karakter olmalı';return;}if(pass!==pass2){errEl.textContent='Şifreler eşleşmiyor';return;}btn.disabled=true;btn.textContent='Kayıt olunuyor...';errEl.textContent='';const{data,error}=await sb.auth.signUp({email,password:pass});btn.disabled=false;btn.textContent='Kayıt Ol';if(error){let msg='Kayıt başarısız';if(error.message.includes('already registered'))msg='Bu e-posta zaten kayıtlı, giriş yapın';else if(error.message.includes('invalid'))msg='Geçerli bir e-posta girin';errEl.textContent=msg;return;}if(data.user&&!data.session){errEl.style.color='#27ae60';errEl.textContent='Onay e-postası gönderildi! Gelen kutunuzu kontrol edin.';return;}await onSignedIn(data.user);}
async function doSifreSifirla(){const email=document.getElementById('giris-email').value.trim();if(!email){document.getElementById('giris-err').textContent='Önce e-posta adresinizi girin';return;}const{error}=await sb.auth.resetPasswordForEmail(email,{redirectTo:'https://ercanbrgr.github.io/envanter-site'});if(error){document.getElementById('giris-err').textContent='Hata: '+error.message;return;}document.getElementById('giris-err').style.color='#27ae60';document.getElementById('giris-err').textContent='Şifre sıfırlama linki e-postanıza gönderildi!';}
async function doSignOut(){if(!confirm('Çıkış yapmak istediğinize emin misiniz?'))return;await sb.auth.signOut();currentUser=null;isAdmin=false;isSuperAdmin=false;appData={products:[]};showScreen('auth-screen');}
function showScreen(id){['auth-screen','sube-screen','loading-screen','app'].forEach(s=>{const el=document.getElementById(s);if(s==='app'){el.style.display=s===id?'flex':'none';if(s===id)el.style.flexDirection='column';}else{el.style.display=s===id?'flex':'none';}});if(id==='loading-screen')initSplashLetters();}
function initSplashLetters(){const el=document.getElementById('splash-brand-letters');if(!el||el._inited)return;el._inited=true;const letters=[{c:'E',o:false},{c:'R',o:false},{c:'C',o:false},{c:'A',o:false},{c:'N',o:false},{c:' ',gap:true},{c:'B',o:true},{c:'R',o:true},{c:'G',o:true},{c:'R',o:true}];el.innerHTML='';letters.forEach((l,i)=>{if(l.gap){const g=document.createElement('span');g.className='gap';el.appendChild(g);return;}const s=document.createElement('span');s.className='letter'+(l.o?' orange':'');s.textContent=l.c;el.appendChild(s);const delay=2800+(i*320);setTimeout(()=>{s.style.animation='letterIn 1s cubic-bezier(0.22,1.6,0.5,1) forwards';},delay);});const burger=document.getElementById('splash-burger');if(burger)setTimeout(()=>burger.classList.add('landed'),3000);}
async function onSignedIn(user){const errEl=document.getElementById('giris-err');try{currentUser=user;if(errEl){errEl.style.color='#888';errEl.textContent='Yukleniyor...';}const profil=await loadProfil();if(!profil){if(errEl)errEl.textContent='';showScreen('sube-screen');setTimeout(()=>document.getElementById('sube-input').focus(),300);return;}isSuperAdmin=(profil.rol==='super_admin');isAdmin=(profil.rol==='admin'||isSuperAdmin);await loadAllData();loadSktData();if(errEl)errEl.textContent='';openApp();}catch(err){showScreen('auth-screen');if(errEl){errEl.style.color='#e74c3c';errEl.textContent='HATA: '+err.message;}}}
async function loadProfil(){const{data}=await sb.from('sube_profiller').select('*').eq('user_id',currentUser.id).single();return data;}
async function saveSube(){const sube=document.getElementById('sube-input').value.trim();if(!sube){document.getElementById('sube-err').textContent='Şube adı girin';return;}document.getElementById('sube-err').textContent='';const{error}=await sb.from('sube_profiller').upsert({user_id:currentUser.id,sube_adi:sube,email:currentUser.email});if(error){document.getElementById('sube-err').textContent='Kaydedilemedi: '+error.message;return;}await initDefaultProducts();await loadAllData();openApp();}
async function addNewProduct(){const ad=prompt('Yeni ürün adı:');if(!ad||!ad.trim())return;const birim=prompt('Birimi (Adet / Kg / Lt / Paket / Kutu):','Adet')||'Adet';const sira=appData.products.length;const{data,error}=await sb.from('urunler').insert({user_id:currentUser.id,sira,ad:ad.trim(),birim,koli:'',adet_koli:''}).select().single();if(error){toast('Eklenemedi: '+error.message,4000);return;}appData.products.push({id:data.id,sira,name:ad.trim(),birim,koli:'',adet:'',entries:[]});currentProduct=appData.products.length-1;showAddForm=false;renderSidebar();renderPage();closeDrawer();toast('Ürün eklendi: '+ad.trim());}
async function openSubeModal(){const profil=await loadProfil();const yeni=prompt('Yeni şube adı:',profil?.sube_adi||'');if(yeni&&yeni.trim()){await sb.from('sube_profiller').upsert({user_id:currentUser.id,sube_adi:yeni.trim()});document.getElementById('topbar-user').textContent=yeni.trim();const dsi=document.getElementById('drawer-sube-info');if(dsi)dsi.textContent=yeni.trim();toast('Şube adı güncellendi');}}
async function loadAllData(){const{data:urunler}=await sb.from('urunler').select('*').eq('user_id',currentUser.id).order('sira');const{data:girdiler}=await sb.from('gunluk_girdiler').select('*').eq('user_id',currentUser.id).order('tarih',{ascending:true});const{data:agData}=await sb.from('acik_gunler').select('tarih').eq('user_id',currentUser.id);acikGunler=new Set((agData||[]).map(r=>r.tarih));appData.products=(urunler||[]).map(u=>({id:u.id,sira:u.sira,name:u.ad,birim:u.birim||'Adet',koli:u.koli||'',adet:u.adet_koli||'',minStok:u.min_stok??null,birimFiyat:u.birim_fiyat||0,entries:(girdiler||[]).filter(g=>g.urun_sira===u.sira).map(g=>({dbId:g.id,gun:g.gun||'',tarih:g.tarih||'',acilis:g.acilis||'',gelen:g.gelen||'',gelenIade:g.gelen_iade||'',transfer:g.transfer||'',kapanis:g.kapanis||'',mallara:g.mallara_gore||'',zayi:g.zayi||'',odenmez:g.odenmez||'',not:g.gun_notu||''}))}))}
async function initDefaultProducts(){const inserts=DEFAULT_PRODUCTS.map((p,i)=>({user_id:currentUser.id,sira:i,ad:p.name,birim:p.birim,koli:'',adet_koli:''}));await sb.from('urunler').upsert(inserts,{onConflict:'user_id,sira'});}
async function openApp(){showScreen('app');let cachedProfil=null;try{cachedProfil=await loadProfil();}catch(e){}const subeAdi=cachedProfil?.sube_adi||currentUser.email;document.getElementById('topbar-user').textContent=subeAdi;const dsi=document.getElementById('drawer-sube-info');if(dsi)dsi.textContent=subeAdi;const dui=document.getElementById('drawer-user-info');if(dui)dui.textContent=currentUser.email;setSyncIcon('ok');if(isAdmin){const badge=isSuperAdmin?'SÜPER ADMİN':'ADMİN';document.getElementById('topbar-user').innerHTML=subeAdi+' <span class="admin-badge">'+badge+'</span>';const subeBtn=document.getElementById('sube-adi-btn');if(subeBtn)subeBtn.style.display='none';const adminKart=document.getElementById('admin-panel-kart');if(adminKart)adminKart.style.display='flex';}renderSidebar();if(isAdmin)renderAdminPanel();else renderPage();}
function setSyncIcon(state){const el=document.getElementById('sync-indicator');if(state==='ok')el.textContent='✅';else if(state==='saving')el.textContent='🔄';else if(state==='err')el.textContent='⚠️';}
function toggleDrawer(){document.getElementById('drawer').classList.toggle('open');document.getElementById('drawer-overlay').classList.toggle('open');setTimeout(()=>{const a=document.querySelector('.product-item.active');if(a)a.scrollIntoView({block:'center',behavior:'smooth'});},150);}
function closeDrawer(){document.getElementById('drawer').classList.remove('open');document.getElementById('drawer-overlay').classList.remove('open');}
function renderSidebar(filter=''){const list=document.getElementById('product-list');list.innerHTML='';appData.products.forEach((p,i)=>{if(filter&&!p.name.toLowerCase().includes(filter.toLowerCase()))return;const lastKapanis=p.entries.length?parseFloat(p.entries[p.entries.length-1].kapanis||''):null;const uyari=p.minStok!==null&&lastKapanis!==null&&lastKapanis<p.minStok;const div=document.createElement('div');div.className='product-item'+(i===currentProduct?' active':'');div.style.display='flex';div.style.alignItems='center';div.style.gap='4px';const moveHtml=isAdmin?`<span style="display:flex;flex-direction:column;gap:1px;flex-shrink:0"><button onclick="event.stopPropagation();moveProduct(${i},-1)" style="background:none;border:none;color:#aaa;cursor:pointer;font-size:10px;padding:0;line-height:1" title="Yukarı">^</button><button onclick="event.stopPropagation();moveProduct(${i},1)" style="background:none;border:none;color:#aaa;cursor:pointer;font-size:10px;padding:0;line-height:1" title="Aşağı">▼</button></span>`:'';div.innerHTML=moveHtml+`<span class="num">${i+1}</span><span class="pname">${p.name}${uyari?` <span style="color:#e74c3c;font-size:10px;font-weight:700">⚠️ AZ</span>`:''}</span>${p.entries.length?`<span class="badge">${p.entries.length}</span>`:''}`;div.onclick=()=>{currentProduct=i;showAddForm=false;renderSidebar(document.getElementById('search-input').value);renderPage();closeDrawer();};list.appendChild(div);});}
async function moveProduct(i,dir){const j=i+dir;if(j<0||j>=appData.products.length)return;const a=appData.products[i],b=appData.products[j];const tmpSira=a.sira;a.sira=b.sira;b.sira=tmpSira;appData.products[i]=b;appData.products[j]=a;await sb.from('urunler').update({sira:a.sira}).eq('id',a.id);await sb.from('urunler').update({sira:b.sira}).eq('id',b.id);if(currentProduct===i)currentProduct=j;else if(currentProduct===j)currentProduct=i;renderSidebar(document.getElementById('search-input').value);renderPage();}
function toggleProductList(){const list=document.getElementById('product-list');const arrow=document.getElementById('product-list-arrow');const hidden=list.style.display==='none';list.style.display=hidden?'':'none';arrow.textContent=hidden?'^':'v';}
function filterProducts(){renderSidebar(document.getElementById('search-input').value);}
document.addEventListener('keydown',function(e){
  if(e.target.tagName==='INPUT'||e.target.tagName==='TEXTAREA')return;
  if(e.key==='/'||e.key==='f'&&!e.ctrlKey&&!e.metaKey){e.preventDefault();const s=document.getElementById('search-input');if(s){s.focus();s.select();}}
  if(e.key==='ArrowDown'&&currentProduct<appData.products.length-1){currentProduct++;showAddForm=false;renderSidebar(document.getElementById('search-input').value);renderPage();}
  if(e.key==='ArrowUp'&&currentProduct>0){currentProduct--;showAddForm=false;renderSidebar(document.getElementById('search-input').value);renderPage();}
  if(e.key==='Escape'){const s=document.getElementById('search-input');if(s){s.value='';filterProducts();}}
});
function n(v){
  if(v===''||v===null||v===undefined)return 0;
  let s=String(v).trim();
  if(s.indexOf('.')!==-1&&s.indexOf(',')!==-1){
    // Both exist: dot=thousands, comma=decimal  e.g. 1.050,5 -> 1050.5
    s=s.replace(/\./g,'').replace(',','.');
  } else if(s.indexOf(',')!==-1){
    const parts=s.split(',');
    const intPart=parts[0];
    const afterComma=parts[1];
    // Thousands: integer part >= 1 AND exactly 3 digits after comma e.g. 1,050
    if(parseInt(intPart)>=1&&afterComma&&afterComma.length===3&&!afterComma.match(/[^0-9]/)){
      s=s.replace(',',''); // 1,050 -> 1050
    } else {
      s=s.replace(',','.'); // 0,088 -> 0.088, 1,5 -> 1.5
    }
  } else if(s.indexOf('.')!==-1){
    const parts=s.split('.');
    const intPart=parts[0];
    const afterDot=parts[1];
    // Thousands: integer part >= 1 AND exactly 3 digits after dot e.g. 1.050
    if(parseInt(intPart)>=1&&afterDot&&afterDot.length===3&&!afterDot.match(/[^0-9]/)){
      s=s.replace('.',''); // 1.050 -> 1050
    }
    // else decimal: 1.5, 0.088 -> keep
  }
  return parseFloat(s)||0;
}
function r(v){return Math.round(v*1000)/1000;}
function fmt(v){if(v===''||v===null||v===undefined)return '';const num=n(v);if(isNaN(num)||num===0)return '';let s=(Math.round(num*1000)/1000).toFixed(3);// Remove trailing zeros after decimal
s=s.replace(/\.?0+$/,'');if(s.indexOf('.')!==-1)s=s.replace('.',',');// Add thousands dot for numbers >= 1000
if(Math.abs(num)>=1000){const parts=s.split(',');parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,'.');s=parts.join(',');}return s;}
function fmtOr0(v){const num=n(v);if(isNaN(num))return '0';let s=(Math.round(num*1000)/1000).toFixed(3);s=s.replace(/\.?0+$/,'');if(s.indexOf('.')!==-1)s=s.replace('.',',');if(Math.abs(num)>=1000){const parts=s.split(',');parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,'.');s=parts.join(',');}return s||'0';}
function calcEntry(e){const a=n(e.acilis),g=n(e.gelen),gi=n(e.gelenIade),t=n(e.transfer),k=n(e.kapanis),m=n(e.mallara),z=n(e.zayi),o=n(e.odenmez);const sayima=r(a+g-gi-t-k);return{sayima,fark:r(m-sayima+z+o)};}
function getStats(entries){if(!entries.length)return{last:'-',totalFark:0,posCount:0,negCount:0};let totalFark=0,posCount=0,negCount=0;entries.forEach(e=>{const{fark}=calcEntry(e);totalFark+=fark;if(fark>0)posCount++;else if(fark<0)negCount++;});const last=entries[entries.length-1];return{last:last.kapanis!==''?last.kapanis:'-',totalFark:r(totalFark),posCount,negCount};}
let selectedMonth=new Date().toISOString().slice(0,7);
function getMonthOptions(entries){const months=new Set();entries.forEach(e=>{if(e.tarih&&e.tarih.length>=7)months.add(e.tarih.slice(0,7));});return[...months].sort().reverse();}
function monthLabel(ym){if(!ym)return'Tümü';const[y,m]=ym.split('-');const adlar=['','Ocak','Şubat','Mart','Nisan','Mayıs','Haziran','Temmuz','Ağustos','Eylül','Ekim','Kasım','Aralık'];return adlar[parseInt(m)]+' '+y;}
function changeMonth(val){selectedMonth=val;renderPage();}
function renderPage(){if(!appData.products.length){document.getElementById('page-content').innerHTML='<div class="empty"><div class="ico">📋</div><p>Veriler yükleniyor...</p></div>';return;}const p=appData.products[currentProduct];if(!p)return;const birim=p.birim||'Adet';document.getElementById('product-name-display').textContent=p.name;const tsubEl=document.getElementById('topbar-sub');if(tsubEl)tsubEl.textContent=`${birim} • Ada tıkla değiştir`;const birimEl=document.getElementById('topbar-birim');if(birimEl)birimEl.value=birim;const months=getMonthOptions(p.entries);if(months.length&&!months.includes(selectedMonth))selectedMonth=months[0]||selectedMonth;const filtered=selectedMonth==='tumu'?p.entries:p.entries.filter(e=>e.tarih&&e.tarih.startsWith(selectedMonth));const stats=getStats(filtered);const fc=stats.totalFark>0?'green':stats.totalFark<0?'red':'';let monthBar=`<div style="background:#fff;border-radius:12px;padding:10px 14px;margin-bottom:12px;box-shadow:0 1px 4px rgba(0,0,0,0.06);display:flex;align-items:center;gap:10px;flex-wrap:wrap"><span style="font-size:11px;font-weight:700;color:#999;text-transform:uppercase">Ay Filtresi</span><select onchange="changeMonth(this.value)" style="padding:7px 12px;border:2px solid #eee;border-radius:8px;font-size:13px;font-weight:700;outline:none;color:#333"><option value="tumu" ${selectedMonth==='tumu'?'selected':''}>Tümü</option>${months.map(m=>`<option value="${m}" ${m===selectedMonth?'selected':''}>${monthLabel(m)}</option>`).join('')}</select><span style="font-size:12px;color:#aaa">${filtered.length} giriş</span></div>`;
// --- Ayın Ürünü & Top 3 ---
const topKartHtml='';
let html=monthBar+topKartHtml;if(showAddForm){let nextAcilis='';for(let _i=p.entries.length-1;_i>=0;_i--){if(p.entries[_i].kapanis!==''&&p.entries[_i].kapanis!==null&&p.entries[_i].kapanis!==undefined){nextAcilis=p.entries[_i].kapanis;break;}}const buAyStr=new Date().toISOString().slice(0,7);const buAyGunSayisi=p.entries.filter(e=>e.tarih&&e.tarih.startsWith(buAyStr)).length;const subeAdiGoster=document.getElementById('topbar-user')?.textContent||'';html+=`<div class="add-card" id="add-form"><div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px"><h3 style="margin:0">Yeni Gün Ekle <span id="form-ay-label" style="font-size:11px;color:#aaa;font-weight:400"></span></h3><div style="text-align:right"><div style="font-size:13px;font-weight:800;color:var(--orange)">${p.name}</div><div style="font-size:11px;color:#aaa">${subeAdiGoster}</div></div></div><div class="form-grid"><div class="ff"><label>Gün</label><input type="number" id="f-gun" value="${buAyGunSayisi+1}" inputmode="numeric"></div><div class="ff"><label>Tarih</label><input type="date" id="f-tarih" value="${new Date().toISOString().split('T')[0]}" onchange="updateGunNo(this.value)"></div><div class="ff"><label>Açılış (${birim})</label><input type="number" id="f-acilis" value="${nextAcilis}" oninput="liveCalc()" step="0.01" placeholder="0" inputmode="decimal"></div><div class="ff"><label>Gelen (${birim})</label><input type="number" id="f-gelen" oninput="liveCalc()" step="0.01" placeholder="0" inputmode="decimal"></div><div class="ff"><label>Gelen İade</label><input type="number" id="f-gelenIade" oninput="liveCalc()" step="0.01" placeholder="0" inputmode="decimal"></div><div class="ff"><label>Transfer</label><input type="number" id="f-transfer" oninput="liveCalc()" step="0.01" placeholder="0" inputmode="decimal"></div><div class="ff"><label>Kapanış (${birim})</label><input type="number" id="f-kapanis" oninput="liveCalc()" step="0.01" placeholder="0" inputmode="decimal"></div><div class="ff"><label>Sayıma Göre Kullanılan</label><input type="number" id="f-sayima" class="calc" readonly placeholder="Otomatik"></div><div class="ff"><label>Mallara Göre Satılan</label><input type="number" id="f-mallara" oninput="liveCalc()" step="0.01" placeholder="0" inputmode="decimal"></div><div class="ff"><label>Zayi</label><input type="number" id="f-zayi" oninput="liveCalc()" step="0.01" placeholder="0" inputmode="decimal"></div><div class="ff"><label>Ödenmez</label><input type="number" id="f-odenmez" oninput="liveCalc()" step="0.01" placeholder="0" inputmode="decimal"></div><div class="ff"><label>FARK +/-</label><input type="number" id="f-fark" class="calc" readonly placeholder="Otomatik"></div><div class="ff" style="grid-column:1/-1"><label>Not (isteğe bağlı)</label><input type="text" id="f-not" placeholder="Örn: fırın arızası, stok sayım hatası..." style="font-size:13px"></div></div><div class="form-actions"><button class="btn btn-primary" onclick="addEntry()">Kaydet</button><button class="btn btn-outline" onclick="toggleAddForm()">İptal</button></div></div>`;}const ayLabel=selectedMonth==='tumu'?'Tümü':monthLabel(selectedMonth);html+=`<div class="stats-row"><div class="stat-card"><div class="sl">Son Kapanış</div><div class="sv">${stats.last}</div></div><div class="stat-card orange"><div class="sl">${ayLabel} Gün</div><div class="sv">${filtered.length}</div></div><div class="stat-card ${fc}"><div class="sl">${ayLabel} Fark</div><div class="sv">${stats.totalFark>0?'+':''}${fmt(stats.totalFark)||'0'}</div></div><div class="stat-card"><div class="sl">+ / - Gün</div><div class="sv" style="font-size:16px"><span style="color:#27ae60">+${stats.posCount}</span> / <span style="color:#e74c3c">${stats.negCount}</span></div></div></div>`;if(!p.entries.length){html+=`<div class="empty"><div class="ico">📋</div><p style="margin:8px 0">Henüz veri girilmemiş.<br><strong>+ Ekle</strong> butonuna basın.</p></div>`;}else if(!filtered.length){html+=`<div class="empty"><div class="ico">📋</div><p>${ayLabel} için giriş yok.</p></div>`;}else{html+=renderIzeka(p);html+=renderChart(p,filtered);html+=`<div class="table-card"><div class="table-scroll"><table><thead><tr><th>#</th><th>Gün #</th><th>Tarih</th><th>Açılış<br>(${birim})</th><th>Gelen<br>(${birim})</th><th>G.İade</th><th>Transfer</th><th>Kapanış<br>(${birim})</th><th>Sayıma Göre<br>Kullanılan</th><th>Mallara Göre<br>Satılan</th><th>Zayi</th><th>Ödenmez</th><th>Not</th><th>FARK +/-</th></tr></thead><tbody>`;let gunSayac=0;filtered.forEach(e=>{gunSayac++;const idx=p.entries.indexOf(e);const{sayima,fark}=calcEntry(e);const ayKilitli=!isAdmin&&e.tarih&&e.tarih.slice(0,7)<new Date().toISOString().slice(0,7)&&!acikGunler.has(e.tarih);const fc2=fark>0?'fp':fark<0?'fn':'fz';const hasData=e.acilis!==''||e.kapanis!=='';const readonly=ayKilitli?'readonly style="background:#f5f5f5;color:#aaa;cursor:not-allowed"':'';html+=`<tr${ayKilitli?' style="opacity:0.7"':''}><td>${isAdmin?`<button class="del-btn" onclick="deleteEntry(${idx})">✏️</button>`:'-'}</td><td><input type="number" value="${gunSayac}" onchange="${ayKilitli?'':` updateEntry(${idx},'gun',this.value)`}" inputmode="numeric" ${readonly}></td><td><input type="date" value="${e.tarih||''}" onchange="${ayKilitli?'':` updateEntry(${idx},'tarih',this.value)`}" style="width:130px" ${readonly}></td><td><input type="number" value="${e.acilis||''}" onchange="${ayKilitli?'':` updateEntry(${idx},'acilis',this.value)`}" step="0.01" inputmode="decimal" ${readonly}></td><td><input type="number" value="${e.gelen||''}" onchange="${ayKilitli?'':` updateEntry(${idx},'gelen',this.value)`}" step="0.01" inputmode="decimal" ${readonly}></td><td><input type="number" value="${fmt(e.gelenIade)}" onchange="${ayKilitli?'':` updateEntry(${idx},'gelenIade',this.value)`}" step="0.01" inputmode="decimal" ${readonly}></td><td><input type="number" value="${fmt(e.transfer)}" onchange="${ayKilitli?'':` updateEntry(${idx},'transfer',this.value)`}" step="0.01" inputmode="decimal" ${readonly}></td><td><input type="number" value="${e.kapanis||''}" onchange="${ayKilitli?'':` updateEntry(${idx},'kapanis',this.value)`}" step="0.01" inputmode="decimal" ${readonly}></td><td class="calc">${hasData?sayima:''}</td><td><input type="number" value="${e.mallara||''}" onchange="${ayKilitli?'':` updateEntry(${idx},'mallara',this.value)`}" step="0.01" inputmode="decimal" ${readonly}></td><td><input type="number" value="${e.zayi||''}" onchange="${ayKilitli?'':` updateEntry(${idx},'zayi',this.value)`}" step="0.01" inputmode="decimal" ${readonly}></td><td><input type="number" value="${fmt(e.odenmez)}" onchange="${ayKilitli?'':` updateEntry(${idx},'odenmez',this.value)`}" step="0.01" inputmode="decimal" ${readonly}></td><td><input type="text" value="${(e.not||'').replace(/"/g,'&quot;')}" onchange="${ayKilitli?'':` updateEntry(${idx},'not',this.value)`}" placeholder="${ayKilitli?'kilitli':'not...'}" style="width:90px;font-size:11px" ${readonly}></td><td class="${fc2}">${hasData?(fark>0?'+':'')+fark:''}</td></tr>`;});html+=`</tbody></table></div><div class="scroll-hint">← kaydırın →</div></div>`;}document.getElementById('page-content').innerHTML=html;setTimeout(()=>initChart(p,filtered),50);}
function liveCalc(){const g=id=>n(document.getElementById(id)?.value);const sayima=r(g('f-acilis')+g('f-gelen')-g('f-gelenIade')-g('f-transfer')-g('f-kapanis'));const fark=r(g('f-mallara')-sayima+g('f-zayi')+g('f-odenmez'));const se=document.getElementById('f-sayima'),fe=document.getElementById('f-fark');if(se)se.value=sayima;if(fe){fe.value=(fark>0?'+':'')+fark;fe.className='calc '+(fark>0?'fpos':fark<0?'fneg':'');}}
function scheduleSave(idx){setSyncIcon('saving');clearTimeout(syncTimeout);syncTimeout=setTimeout(()=>syncEntry(idx),800);}
async function syncEntry(idx){const p=appData.products[currentProduct];const e=p.entries[idx];const row={user_id:currentUser.id,urun_sira:p.sira,gun:e.gun||'',tarih:e.tarih||null,acilis:e.acilis||'',gelen:e.gelen||'',gelen_iade:e.gelenIade||'',transfer:e.transfer||'',kapanis:e.kapanis||'',mallara_gore:e.mallara||'',zayi:e.zayi||'',odenmez:e.odenmez||'',gun_notu:e.not||''};let res;if(e.dbId){res=await sb.from('gunluk_girdiler').update(row).eq('id',e.dbId);}else{res=await sb.from('gunluk_girdiler').insert(row).select().single();if(res.data)e.dbId=res.data.id;}if(res.error){setSyncIcon('err');toast('Kayıt hatası: '+res.error.message,4000);}else{setSyncIcon('ok');}}
async function syncMinStok(sira,minStok){await sb.from('urunler').update({min_stok:minStok}).eq('user_id',currentUser.id).eq('sira',sira);}
async function setBirimFiyat(){const p=appData.products[currentProduct];if(!p)return;const mevcut=p.birimFiyat>0?p.birimFiyat:'';const val=prompt(p.name+' birim fiyatı (?/'+p.birim+'):\nFire maliyetini TL olarak hesaplar. Boş bırakırsanız kapatılır.',mevcut);if(val===null)return;const v=val.trim()===''?0:parseFloat(val.replace(',','.'))||0;p.birimFiyat=v;await sb.from('urunler').update({birim_fiyat:v}).eq('user_id',currentUser.id).eq('sira',p.sira);renderPage();toast(v===0?'Birim fiyat kaldırıldı':'Birim fiyat '+v+'\u20ba/'+p.birim+' olarak ayarland\u0131 \u2713');}
let sktData=[];
function sktGunFark(tarih){if(!tarih)return 999;const today=new Date();today.setHours(0,0,0,0);const d=new Date(tarih+'T00:00:00');return Math.round((d-today)/86400000);}
function renderSktBanner(){const el=document.getElementById('skt-banner');if(!el)return;const kritik=sktData.filter(s=>sktGunFark(s.son_tarih)<=5);if(!kritik.length){el.innerHTML='';el.style.display='none';return;}const gecmis=kritik.filter(s=>sktGunFark(s.son_tarih)<0);const bugun=kritik.filter(s=>sktGunFark(s.son_tarih)===0);const yakin=kritik.filter(s=>sktGunFark(s.son_tarih)>0);let html='<div style="background:#fff3cd;border:2px solid #ffc107;border-radius:10px;padding:10px 14px;margin:8px 0 4px;font-size:12px">';html+='<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:6px"><span style="font-weight:800;color:#856404;font-size:13px">? SKT UYARILARI ('+kritik.length+')</span><button onclick="openSktModal()" style="padding:4px 10px;background:#ffc107;color:#333;border:none;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer">Yönet</button></div>';gecmis.forEach(s=>{html+='<div style="display:flex;align-items:center;padding:4px 0;border-bottom:1px solid #ffe8a1;gap:6px"><span style="color:#e74c3c;font-weight:700;flex:1">📦 '+s.urun_adi+(s.miktar?' ('+s.miktar+')':'')+'</span><span style="color:#e74c3c;font-size:10px;font-weight:700;background:#fde;padding:2px 6px;border-radius:4px">SÜRESİ GEÇTİ</span></div>';});bugun.forEach(s=>{html+='<div style="display:flex;align-items:center;padding:4px 0;border-bottom:1px solid #ffe8a1;gap:6px"><span style="color:#e74c3c;font-weight:700;flex:1">📦 '+s.urun_adi+(s.miktar?' ('+s.miktar+')':'')+'</span><span style="color:#e74c3c;font-size:10px;font-weight:700;background:#fde;padding:2px 6px;border-radius:4px">BUGÜN SON GÜN!</span></div>';});yakin.forEach(s=>{const g=sktGunFark(s.son_tarih);const c=g<=2?'#e74c3c':'#856404';html+='<div style="display:flex;align-items:center;padding:4px 0;border-bottom:1px solid #ffe8a1;gap:6px"><span style="color:'+c+';font-weight:700;flex:1">📦 '+s.urun_adi+(s.miktar?' ('+s.miktar+')':'')+'</span><span style="color:'+c+';font-size:10px;font-weight:700">'+g+' gün kaldı ('+s.son_tarih+')</span></div>';});html+='</div>';el.innerHTML=html;el.style.display='block';}
async function loadSktData(){if(!currentUser)return;const{data,error}=await sb.from('skt_takip').select('*').eq('user_id',currentUser.id).order('son_tarih');if(!error)sktData=data||[];renderSktBanner();}
function openSktModal(){document.getElementById('skt-modal').classList.add('show');const d=new Date();d.setDate(d.getDate()+5);document.getElementById('skt-tarih').value=d.toISOString().slice(0,10);renderSktList();}
function closeSktModal(){document.getElementById('skt-modal').classList.remove('show');}
function renderSktList(){const list=document.getElementById('skt-list');if(!sktData.length){list.innerHTML='<div style="text-align:center;padding:20px;color:#aaa;font-size:13px">Henüz kayıt yok.<br>Yukarıdan ürün ekleyin.</div>';return;}let html='<div style="border:1px solid #eee;border-radius:8px;overflow:hidden">';[...sktData].sort((a,b)=>a.son_tarih.localeCompare(b.son_tarih)).forEach(s=>{const g=sktGunFark(s.son_tarih);const bgc=g<0?'#fde8e8':g===0?'#ffe8e8':g<=2?'#fff3cd':g<=5?'#fffde7':'#f9f9f9';const badge=g<0?'<span style="background:#e74c3c;color:#fff;font-size:10px;padding:2px 6px;border-radius:4px;font-weight:700">GEÇTİ</span>':g===0?'<span style="background:#e74c3c;color:#fff;font-size:10px;padding:2px 6px;border-radius:4px;font-weight:700">BUGÜN!</span>':'<span style="background:'+(g<=2?'#e74c3c':g<=5?'#ffc107':'#27ae60')+';color:#fff;font-size:10px;padding:2px 6px;border-radius:4px;font-weight:700">'+g+' gün</span>';html+='<div style="display:flex;align-items:center;padding:10px 12px;background:'+bgc+';border-bottom:1px solid #eee;gap:8px"><div style="flex:1"><div style="font-size:13px;font-weight:700;color:#333">'+s.urun_adi+'</div><div style="font-size:11px;color:#888">'+(s.miktar?s.miktar+' &bull; ':'')+' SKT: '+s.son_tarih+'</div></div>'+badge+'<button onclick="deleteSktEntry(\''+s.id+'\')" style="padding:4px 8px;background:#e74c3c;color:#fff;border:none;border-radius:6px;font-size:11px;cursor:pointer;font-weight:700">Sil</button></div>';});html+='</div>';list.innerHTML=html;}
async function addSktEntry(){const urunAdi=document.getElementById('skt-urun').value.trim();const tarih=document.getElementById('skt-tarih').value;const miktar=document.getElementById('skt-miktar').value.trim();if(!urunAdi||!tarih){toast('Ürün adı ve tarih zorunlu');return;}const{data,error}=await sb.from('skt_takip').insert({user_id:currentUser.id,urun_adi:urunAdi,son_tarih:tarih,miktar}).select().single();if(error){toast('Hata: '+error.message,4000);return;}sktData.push(data);document.getElementById('skt-urun').value='';document.getElementById('skt-miktar').value='';renderSktList();renderSktBanner();toast('SKT kaydı eklendi \u2713');}
async function deleteSktEntry(id){const{error}=await sb.from('skt_takip').delete().eq('id',id);if(error){toast('Silme hatası',4000);return;}sktData=sktData.filter(s=>s.id!==id);renderSktList();renderSktBanner();toast('Silindi \u2713');}
async function renderAdminAylikRapor(){
  const pc=document.getElementById('page-content');
  const now=new Date();
  const defaultAy=now.toISOString().slice(0,7);
  const profiller=adminData?.profiller||[];
  const subeOptions=profiller.map((p,i)=>'<option value="'+i+'">'+(p.sube_adi||p.email)+'</option>').join('');
  pc.innerHTML='<div style="padding:4px 0 16px"><div style="display:flex;align-items:center;gap:10px;margin-bottom:16px;flex-wrap:wrap"><button onclick="renderAdminAnaSayfa()" style="background:none;border:none;font-size:22px;cursor:pointer;color:#e85d04">\u2190</button><h2 style="margin:0;font-size:18px">\uD83D\uDCCA Ayl\u0131k Rapor</h2></div><div style="background:#fff;border-radius:12px;padding:16px;margin-bottom:16px;box-shadow:0 1px 4px rgba(0,0,0,0.08)"><div style="display:grid;grid-template-columns:1fr 1fr auto;gap:10px;align-items:end"><div><label style="font-size:11px;font-weight:700;color:#999;display:block;margin-bottom:4px">\u015EUBE</label><select id="aylik-sube" style="width:100%;padding:10px;border:2px solid #eee;border-radius:8px;font-size:13px;outline:none">'+subeOptions+'</select></div><div><label style="font-size:11px;font-weight:700;color:#999;display:block;margin-bottom:4px">AY</label><input type="month" id="aylik-ay" value="'+defaultAy+'" style="width:100%;padding:10px;border:2px solid #eee;border-radius:8px;font-size:13px;outline:none"></div><button onclick="aylikRaporGoster()" style="padding:11px 18px;background:var(--orange);color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:700;cursor:pointer;white-space:nowrap">G\xF6ster \u2192</button></div></div><div id="aylik-rapor-icerik"></div></div>';
}
async function aylikRaporGoster(){
  const subeIdx=parseInt(document.getElementById('aylik-sube')?.value)||0;
  const ay=document.getElementById('aylik-ay')?.value;
  if(!ay){toast('Ay se\xE7in');return;}
  const profil=adminData?.profiller?.[subeIdx];
  if(!profil){toast('\u015Eube bulunamad\u0131');return;}
  const el=document.getElementById('aylik-rapor-icerik');
  el.innerHTML='<div style="text-align:center;padding:30px;color:#aaa">\u23F3 Y\xFCkleniyor...</div>';
  const userId=profil.user_id;
  const [{data:urunler},{data:girdiler}]=await Promise.all([sb.from('urunler').select('*').eq('user_id',userId).order('sira'),sb.from('gunluk_girdiler').select('*').eq('user_id',userId)]);
  if(!urunler||!girdiler){el.innerHTML='<div style="color:#e74c3c;padding:20px">Veri al\u0131namad\u0131.</div>';return;}
  const ayGirdiler=girdiler.filter(g=>g.tarih&&g.tarih.startsWith(ay));
  if(!ayGirdiler.length){el.innerHTML='<div style="background:#fff;border-radius:12px;padding:30px;text-align:center;color:#aaa">Bu ay i\xE7in veri bulunamad\u0131.</div>';return;}
  const monthName=new Date(ay+'-01').toLocaleDateString('tr-TR',{year:'numeric',month:'long'});
  const subeBilgi=profil.sube_adi||profil.email;
  let html='<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;flex-wrap:wrap;gap:8px"><div style="font-size:15px;font-weight:700;color:#1a1a2e">\uD83D\uDCCA '+subeBilgi+' \u2014 '+monthName+'</div><button onclick="aylikPdfAl('+subeIdx+',\''+ay+'\')" style="padding:9px 16px;background:#27ae60;color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">\uD83D\uDCCB PDF Al</button></div>';
  urunler.forEach(function(u){
    const uGirdiler=ayGirdiler.filter(function(g){return g.urun_sira===u.sira;}).sort(function(a,b){return (a.gun||0)-(b.gun||0);});
    if(!uGirdiler.length)return;
    let toplamFark=0,artiGun=0,eksiGun=0;
    var satirlar=uGirdiler.map(function(g,idx){
      const e={acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez};
      const res=calcEntry(e);const sayima=res.sayima;const fark=res.fark;
      toplamFark+=fark;if(fark>0)artiGun++;else if(fark<0)eksiGun++;
      const fc=fark>0?'color:#27ae60;font-weight:700':fark<0?'color:#e74c3c;font-weight:700':'color:#999';
      return '<tr style="'+(idx%2?'background:#f9f9f9':'')+'">'
        +'<td style="text-align:center;color:#999;font-size:11px">'+(g.gun||idx+1)+'</td>'
        +'<td style="text-align:center;font-size:11px">'+(g.tarih||'')+'</td>'
        +'<td style="text-align:center">'+fmt(g.acilis)+'</td>'
        +'<td style="text-align:center">'+fmt(g.gelen)+'</td>'
        +'<td style="text-align:center">'+fmt(g.kapanis)+'</td>'
        +'<td style="text-align:center">'+fmt(sayima)+'</td>'
        +'<td style="text-align:center">'+fmt(g.mallara_gore)+'</td>'
        +'<td style="text-align:center">'+fmt(g.zayi)+'</td>'
        +'<td style="text-align:center;'+fc+'">'+(fark!==0?(fark>0?'+':'')+fmt(fark):'')+'</td>'
        +'</tr>';
    }).join('');
    const toplamRenk=toplamFark>0?'#27ae60':toplamFark<0?'#e74c3c':'#999';
    html+='<div style="background:#fff;border-radius:12px;margin-bottom:16px;overflow:hidden;box-shadow:0 1px 4px rgba(0,0,0,0.07)">'
      +'<div style="background:linear-gradient(135deg,#1a1a2e,#16213e);color:#fff;padding:10px 14px;display:flex;justify-content:space-between;align-items:center">'
      +'<span style="font-size:14px;font-weight:800">\uD83D\uDCE6 '+u.ad+'</span>'
      +'<span style="font-size:11px;color:rgba(255,255,255,0.6)">'+(u.birim||'')+' \xB7 '+uGirdiler.length+' g\xFCn</span></div>'
      +'<div style="overflow-x:auto"><table style="width:100%;border-collapse:collapse;font-size:12px">'
      +'<thead><tr style="background:#f5f5f5">'
      +'<th style="padding:6px 8px;font-size:10px;color:#999">G\xDCN#</th>'
      +'<th style="padding:6px 8px;font-size:10px;color:#999">TAR\u0130H</th>'
      +'<th style="padding:6px 8px;font-size:10px;color:#999">A\xC7ILI\u015E</th>'
      +'<th style="padding:6px 8px;font-size:10px;color:#999">GELEN</th>'
      +'<th style="padding:6px 8px;font-size:10px;color:#999">KAPANI\u015E</th>'
      +'<th style="padding:6px 8px;font-size:10px;color:#999">SAYIMA</th>'
      +'<th style="padding:6px 8px;font-size:10px;color:#999">MALLARA</th>'
      +'<th style="padding:6px 8px;font-size:10px;color:#999">ZAY\u0130</th>'
      +'<th style="padding:6px 8px;font-size:10px;color:#999">FARK</th>'
      +'</tr></thead><tbody>'+satirlar+'</tbody>'
      +'<tfoot><tr style="background:#f0f4ff;font-weight:800;border-top:2px solid #e0e0e0">'
      +'<td colspan="8" style="padding:8px 12px;text-align:right;font-size:12px;color:#666">'
      +'TOPLAM FARK &nbsp;| <span style="color:#27ae60">+'+artiGun+' g\xFCn</span> <span style="color:#e74c3c"> -'+eksiGun+' g\xFCn</span></td>'
      +'<td style="padding:8px 10px;text-align:center;font-size:14px;color:'+toplamRenk+'">'+(toplamFark>0?'+':'')+fmt(toplamFark)+'</td>'
      +'</tr></tfoot></table></div></div>';
  });
  el.innerHTML=html;
}
async function aylikPdfAl(subeIdx,ay){
  const profil=adminData?.profiller?.[subeIdx];
  if(!profil){toast('\u015Eube bulunamad\u0131');return;}
  const userId=profil.user_id;
  const [{data:urunler},{data:girdiler}]=await Promise.all([sb.from('urunler').select('*').eq('user_id',userId).order('sira'),sb.from('gunluk_girdiler').select('*').eq('user_id',userId)]);
  if(!urunler||!girdiler){toast('Veri al\u0131namad\u0131');return;}
  const ayGirdiler=girdiler.filter(function(g){return g.tarih&&g.tarih.startsWith(ay);});
  const monthName=new Date(ay+'-01').toLocaleDateString('tr-TR',{year:'numeric',month:'long'});
  const subeBilgi=profil.sube_adi||profil.email;
  let icerik='';
  urunler.forEach(function(u){
    const uGirdiler=ayGirdiler.filter(function(g){return g.urun_sira===u.sira;}).sort(function(a,b){return (a.gun||0)-(b.gun||0);});
    if(!uGirdiler.length)return;
    let toplamFark=0,artiGun=0,eksiGun=0;
    var satirlar=uGirdiler.map(function(g,idx){
      const e={acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez};
      const res=calcEntry(e);const sayima=res.sayima;const fark=res.fark;
      toplamFark+=fark;if(fark>0)artiGun++;else if(fark<0)eksiGun++;
      const fc=fark>0?'color:#27ae60':fark<0?'color:#e74c3c':'';
      return '<tr style="'+(idx%2?'background:#f9f9f9':'')+'">'
        +'<td>'+(g.gun||idx+1)+'</td><td>'+(g.tarih||'')+'</td>'
        +'<td>'+fmt(g.acilis)+'</td><td>'+fmt(g.gelen)+'</td>'
        +'<td>'+fmt(g.kapanis)+'</td><td>'+fmt(sayima)+'</td>'
        +'<td>'+fmt(g.mallara_gore)+'</td><td>'+fmt(g.zayi)+'</td>'
        +'<td style="font-weight:700;'+fc+'">'+(fark!==0?(fark>0?'+':'')+fmt(fark):'')+'</td></tr>';
    }).join('');
    const toplamRenk=toplamFark>0?'#27ae60':toplamFark<0?'#e74c3c':'#999';
    icerik+='<div class="urun-blok">'
      +'<div class="urun-baslik">\uD83D\uDCE6 '+u.ad+' <span class="birim">'+(u.birim||'')+' &middot; '+uGirdiler.length+' g\xFCn</span></div>'
      +'<table><thead><tr><th>G\xDCN#</th><th>TAR\u0130H</th><th>A\xC7ILI\u015E</th><th>GELEN</th><th>KAPANI\u015E</th><th>SAYIMA</th><th>MALLARA</th><th>ZAY\u0130</th><th>FARK</th></tr></thead>'
      +'<tbody>'+satirlar+'</tbody>'
      +'<tfoot><tr class="toplam-row"><td colspan="8" style="text-align:right">TOPLAM FARK &middot; <span style="color:#27ae60">+'+artiGun+' g\xFCn</span> <span style="color:#e74c3c"> -'+eksiGun+' g\xFCn</span></td>'
      +'<td style="color:'+toplamRenk+';font-weight:800;font-size:13px">'+(toplamFark>0?'+':'')+fmt(toplamFark)+'</td></tr></tfoot>'
      +'</table></div>';
  });
  var html='<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"><title>Ayl\u0131k Rapor - '+subeBilgi+' - '+monthName+'</title><style>'
    +'*{box-sizing:border-box;margin:0;padding:0}'
    +'body{font-family:Arial,sans-serif;font-size:9px;color:#222;background:#fff}'
    +'.header{background:#1a1a2e;color:#fff;padding:12px 16px;display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}'
    +'.header h1{font-size:16px;color:#e85d04}'
    +'.header .meta{font-size:10px;color:rgba(255,255,255,0.6)}'
    +'.urun-blok{margin:0 8px 16px;border:1px solid #e0e0e0;border-radius:6px;overflow:hidden;page-break-inside:avoid}'
    +'.urun-baslik{background:#1a1a2e;color:#fff;padding:7px 12px;font-size:12px;font-weight:800}'
    +'.birim{font-size:9px;color:rgba(255,255,255,0.5);font-weight:400}'
    +'table{width:100%;border-collapse:collapse}'
    +'th{background:#f0f0f0;padding:4px 6px;text-align:center;font-size:8px;color:#666;font-weight:700;border-bottom:2px solid #ddd}'
    +'td{padding:3px 6px;text-align:center;border-bottom:1px solid #eee;font-size:9px}'
    +'.toplam-row{background:#f5f8ff;border-top:2px solid #ddd;font-weight:700}'
    +'.footer{margin:16px 8px 8px;font-size:8px;color:#aaa;border-top:1px solid #eee;padding-top:6px;display:flex;justify-content:space-between}'
    +'@media print{@page{size:A4 portrait;margin:0.5cm}body{font-size:8px}.urun-blok{page-break-inside:avoid}}'
    +'</style></head><body>'
    +'<div class="header"><div><h1>Ayl\u0131k Envanter Raporu</h1><div class="meta">'+subeBilgi+' &middot; '+monthName+'</div></div>'
    +'<div style="font-size:9px;color:rgba(255,255,255,0.4)">Ercan BRGR | YPC.TECNO</div></div>'
    +icerik
    +'<div class="footer"><span>Ercan BRGR Envanter Sistemi \u2014 YPC.TECNO | Ufuk Yap\u0131c\u0131</span><span>Olu\u015Fturuldu: '+new Date().toLocaleString('tr-TR')+'</span></div>'
    +'</body></html>';
  pdfAc(html);
}

function pdfAc(html){const w=window.open('','_blank');if(w){w.document.open();w.document.write(html);w.document.close();w.onload=()=>setTimeout(()=>w.print(),300);}else{const blob=new Blob([html],{type:'text/html;charset=utf-8'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.target='_blank';document.body.appendChild(a);a.click();setTimeout(()=>document.body.removeChild(a),500);}}
function gunlukPdfIndir(){const bugun=new Date().toISOString().slice(0,10);const tarih=prompt('Rapor tarihi (YYYY-AA-GG):',bugun);if(!tarih)return;const products=appData.products||[];const subeBilgi=document.getElementById('drawer-sube-info')?.textContent||'';let rows='';let ozet={arti:0,eksi:0,notr:0,girilmemis:0};products.forEach(p=>{const e=p.entries&&p.entries.find(e=>e.tarih===tarih);if(!e){ozet.girilmemis++;rows+=`<tr style="background:#fff9f0"><td style="text-align:left;color:#999">${p.name}</td><td style="color:#999">${p.birim||'—'}</td><td colspan="7" style="color:#ccc;font-style:italic">Giriş yapılmadı</td></tr>`;return;}const{sayima,fark}=calcEntry(e);const fc=fark>0?'color:#27ae60;font-weight:800':fark<0?'color:#e74c3c;font-weight:800':'color:#999';if(fark>0)ozet.arti++;else if(fark<0)ozet.eksi++;else ozet.notr++;rows+=`<tr><td style="text-align:left;font-weight:600">${p.name}</td><td>${p.birim||'—'}</td><td>${fmt(e.acilis)}</td><td>${fmt(e.gelen)}</td><td>${fmt(e.kapanis)}</td><td>${fmt(sayima)}</td><td>${e.mallara??''}</td><td>${e.zayi??''}</td><td style="${fc}">${e.acilis!==undefined||e.kapanis!==undefined?(fark>0?'+':'')+fark:''}</td></tr>`;});const html=`<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"><title>Günlük Rapor - ${tarih}</title><style>*{box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:9px;color:#222;margin:0.7cm}h1{font-size:14px;color:#e85d04;margin:0 0 2px}h2{font-size:10px;color:#555;font-weight:400;margin:0 0 10px}.ozet{display:flex;gap:10px;margin-bottom:10px;flex-wrap:wrap}.oz{padding:5px 12px;border-radius:6px;font-size:9px;text-align:center;border:1px solid #eee}.oz b{display:block;font-size:15px;font-weight:800}table{width:100%;border-collapse:collapse}th{background:#1a1a2e;color:#fff;padding:4px 6px;text-align:center;font-size:8px}th:first-child{text-align:left}td{padding:3px 6px;text-align:center;border-bottom:1px solid #eee}td:first-child{text-align:left}tr:nth-child(even):not([style]){background:#f9f9f9}.footer{margin-top:8px;font-size:8px;color:#bbb;border-top:1px solid #eee;padding-top:5px;display:flex;justify-content:space-between}@media print{@page{size:A4 portrait;margin:0.7cm}}</style></head><body><h1>📋 Günlük Envanter Raporu</h1><h2>⚙️ ${tarih} | ${subeBilgi}</h2><div class="ozet"><div class="oz" style="border-color:#27ae60"><b style="color:#27ae60">${ozet.arti}</b>Fazla</div><div class="oz" style="border-color:#e74c3c"><b style="color:#e74c3c">${ozet.eksi}</b>Eksik</div><div class="oz"><b style="color:#999">${ozet.notr}</b>Sıfır</div><div class="oz" style="border-color:#f0a500"><b style="color:#f0a500">${ozet.girilmemis}</b>Girilmemiş</div></div><table><thead><tr><th>Ürün</th><th>Birim</th><th>Açılış</th><th>Gelen</th><th>Kapanış</th><th>Sayıma</th><th>Mallara</th><th>Zayi</th><th>FARK</th></tr></thead><tbody>${rows}</tbody></table><div class="footer"><span>Ercan BRGR Envanter — YPC.TECNO</span><span>Oluşturuldu: ${new Date().toLocaleString('tr-TR')}</span></div></body></html>`;pdfAc(html);}
function printUrunRaporu(){const p=appData.products[currentProduct];if(!p){toast('Önce bir ürün seçin');return;}const doFilter=selectedMonth&&selectedMonth!=='tumu';const entries=doFilter?p.entries.filter(e=>e.tarih&&e.tarih.startsWith(selectedMonth)):p.entries;const birim=p.birim||'Adet';const stats=getStats(entries);const ayLabel=doFilter?monthLabel(selectedMonth):'Tüm Aylar';const profil=document.getElementById('drawer-sube-info').textContent||'';const fireTL=p.birimFiyat>0&&stats.totalFark<0?'? '+(Math.round(Math.abs(stats.totalFark)*p.birimFiyat*100)/100)+'? kayıp':'';let rows='';entries.forEach(e=>{const{sayima,fark}=calcEntry(e);const fc=fark>0?'color:#27ae60':fark<0?'color:#e74c3c':'color:#999';rows+=`<tr><td>${e.gun||''}</td><td>${e.tarih||''}</td><td>${e.acilis||''}</td><td>${e.gelen||''}</td><td>${e.kapanis||''}</td><td>${sayima}</td><td>${e.mallara||''}</td><td>${e.zayi||''}</td><td style="font-weight:800;${fc}">${e.acilis!==''||e.kapanis!==''?(fark>0?'+':'')+fark:''}</td><td style="font-size:10px;color:#888">${e.not||''}</td></tr>`;});const html=`<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"><title>${p.name} - ${ayLabel}</title><style>body{font-family:Arial,sans-serif;font-size:11px;color:#333;margin:1cm}h1{font-size:16px;color:#e85d04;margin-bottom:4px}h2{font-size:12px;color:#666;margin-bottom:12px;font-weight:400}table{width:100%;border-collapse:collapse;margin-bottom:16px}th{background:#1a1a2e;color:#fff;padding:6px 8px;text-align:center;font-size:10px}td{padding:5px 8px;text-align:center;border-bottom:1px solid #eee}tr:nth-child(even){background:#f9f9f9}.stat-box{display:inline-block;background:#f5f5f5;padding:8px 14px;border-radius:6px;margin-right:8px;margin-bottom:10px;border-left:3px solid #e85d04}.stat-label{font-size:9px;color:#999;text-transform:uppercase}.stat-val{font-size:18px;font-weight:800;color:#1a1a2e}.footer{margin-top:16px;font-size:9px;color:#bbb;border-top:1px solid #eee;padding-top:8px}@media print{@page{size:A4 landscape;margin:1cm}}</style></head><body><h1>📦 ${p.name}</h1><h2>${profil} &nbsp;|&nbsp; ${ayLabel} &nbsp;|&nbsp; ${birim}</h2><div><div class="stat-box"><div class="stat-label">Toplam Gün</div><div class="stat-val">${entries.length}</div></div><div class="stat-box"><div class="stat-label">${ayLabel} Fark</div><div class="stat-val" style="color:${stats.totalFark>0?'#27ae60':stats.totalFark<0?'#e74c3c':'#999'}">${stats.totalFark>0?'+':''}${fmt(stats.totalFark)||'0'} ${birim}</div></div><div class="stat-box"><div class="stat-label">+ / - Gün</div><div class="stat-val"><span style="color:#27ae60">+${stats.posCount}</span> / <span style="color:#e74c3c">${stats.negCount}</span></div></div>${fireTL?'<div class="stat-box"><div class="stat-label">Fire Maliyet</div><div class="stat-val" style="color:#e74c3c">'+fireTL+'</div></div>':''}</div><table><thead><tr><th>Gün #</th><th>Tarih</th><th>Açılış (${birim})</th><th>Gelen</th><th>Kapanış (${birim})</th><th>Sayıma Göre</th><th>Mallara Göre</th><th>Zayi</th><th>FARK</th><th>Not</th></tr></thead><tbody>${rows}</tbody></table><div class="footer">Ercan BRGR Envanter — ${new Date().toLocaleString('tr-TR')}</div></body></html>`;pdfAc(html);}
async function setMinStok(){const p=appData.products[currentProduct];const val=prompt(`${p.name} için minimum stok uyarı seviyesi (${p.birim}):\n(Kapanış bu seviyenin altına düşünce uyarı verir. Boş bırakırsanız uyarı kapatılır)`,p.minStok??'');if(val===null)return;const v=val.trim()===''?null:parseFloat(val);p.minStok=v;await syncMinStok(p.sira,v);renderSidebar();renderPage();toast(v===null?'Uyarı kapatıldı':`Min stok ${v} ${p.birim} olarak ayarlandı ?`);}
async function syncBirim(sira,birim){await sb.from('urunler').update({birim}).eq('user_id',currentUser.id).eq('sira',sira);}
async function syncProductName(sira,ad){await sb.from('urunler').update({ad}).eq('user_id',currentUser.id).eq('sira',sira);}
function toggleAddForm(){showAddForm=!showAddForm;renderPage();if(showAddForm){setTimeout(()=>{const el=document.getElementById('add-form');if(el)el.scrollIntoView({behavior:'smooth'})},50);}}
async function updateGunNo(tarih){if(!tarih)return;const ay=tarih.slice(0,7);const p=appData.products[currentProduct];if(!p)return;const sayisi=p.entries.filter(e=>e.tarih&&e.tarih.startsWith(ay)).length;const el=document.getElementById('f-gun');if(el)el.value=sayisi+1;}
async function addEntry(){const v=x=>document.getElementById(x)?.value||'';const p=appData.products[currentProduct];const entry={gun:v('f-gun'),tarih:v('f-tarih'),acilis:v('f-acilis'),gelen:v('f-gelen'),gelenIade:v('f-gelenIade'),transfer:v('f-transfer'),kapanis:v('f-kapanis'),mallara:v('f-mallara'),zayi:v('f-zayi'),odenmez:v('f-odenmez'),not:v('f-not')};p.entries.push(entry);showAddForm=false;renderSidebar(document.getElementById('search-input').value);renderPage();await syncEntry(p.entries.length-1);toast('Kaydedildi ✅');}
async function updateEntry(idx,field,val){const p=appData.products[currentProduct];const e=p.entries[idx];const bugun=new Date().toISOString().slice(0,10);const buAy=bugun.slice(0,7);const eAy=e.tarih?e.tarih.slice(0,7):'';const gunAcik=e.tarih&&acikGunler.has(e.tarih);if(!isAdmin&&!gunAcik&&eAy&&eAy<buAy){toast('🔒 Geçmiş ay kapandı! Değiştirilemez. Admin açabilir.',3000);renderPage();return;}p.entries[idx][field]=val;renderPage();scheduleSave(idx);}
async function deleteEntry(idx){if(!isAdmin){toast('🔒 Silme yetkisi sadece adminde!',3000);return;}const p=appData.products[currentProduct];const e=p.entries[idx];const ay=e.tarih?e.tarih.slice(0,7):'';const buAy=new Date().toISOString().slice(0,7);if(ay&&ay<buAy){toast('⚠️ Geçmiş ay verileri silinemez!',3000);return;}if(!confirm(`⚠️ ADMİN UYARISI\n\n"${p.name}" ürününün ${e.tarih||'?'} tarihli kaydı silinecek!\n\nBu işlem geri alınamaz. Emin misiniz?`))return;if(e.dbId){const{error}=await sb.from('gunluk_girdiler').delete().eq('id',e.dbId);if(error){toast('Silme hatası');return;}}p.entries.splice(idx,1);renderSidebar(document.getElementById('search-input').value);renderPage();toast('Silindi ✅');}
async function saveBirim(){const p=appData.products[currentProduct];p.birim=document.getElementById('topbar-birim').value;renderPage();await syncBirim(p.sira,p.birim);}
function openRenameModal(){if(!isAdmin){toast('⚠️ Ürün adı değiştirme yetkisi sadece adminde!',3000);return;}document.getElementById('rename-input').value=appData.products[currentProduct].name;document.getElementById('rename-modal').classList.add('show');setTimeout(()=>document.getElementById('rename-input').focus(),100);}
function closeRenameModal(){document.getElementById('rename-modal').classList.remove('show');}
async function confirmRename(){const v=document.getElementById('rename-input').value.trim();if(v){const p=appData.products[currentProduct];p.name=v;renderSidebar();renderPage();await syncProductName(p.sira,v);toast('Ürün adı güncellendi');}closeRenameModal();}
document.getElementById('rename-input').addEventListener('keydown',e=>{if(e.key==='Enter')confirmRename();if(e.key==='Escape')closeRenameModal();});
function exportData(){const p=appData.products[currentProduct];if(!p)return;const doFilter=selectedMonth&&selectedMonth!=='tumu';const entries=doFilter?p.entries.filter(e=>e.tarih&&e.tarih.startsWith(selectedMonth)):p.entries;if(!entries.length){toast('Bu dönemde giriş yok');return;}const ayLabel=doFilter?monthLabel(selectedMonth):'Tüm_Aylar';const esc=v=>{const s=String(v??'');return(s.includes(',')||s.includes('"'))?'"'+s.replace(/"/g,'""')+'"':s;};const cols=['Gun','Tarih','Acilis','Gelen','Gelen_Iade','Transfer','Kapanis','Sayima_Gore_Kullanilan','Mallara_Gore_Satilan','Zayi','Odenmez','FARK'];let csv=cols.join(';')+'\n';entries.forEach(e=>{const{sayima,fark}=calcEntry(e);csv+=[e.gun,e.tarih,e.acilis||0,e.gelen||0,e.gelenIade||0,e.transfer||0,e.kapanis||0,sayima,e.mallara||0,e.zayi||0,e.odenmez||0,fark].map(esc).join(';')+'\n';});const a=document.createElement('a');a.href=URL.createObjectURL(new Blob(['\uFEFF'+csv],{type:'text/csv;charset=utf-8;'}));a.download=(p.name+'_'+ayLabel).replace(/[\s\/\\:*?"<>|]/g,'_')+'.csv';a.click();toast('Excel dosyası indirildi ✅');}
let adminData={profiller:[],urunler:[],girdiler:[],skt:[]},adminSecilenSube=null,adminSecilenUrun=null;
async function renderAdminPanel(){currentProduct=-1;document.getElementById('product-name-display').textContent='Admin Paneli';const tsubAdm=document.getElementById('topbar-sub');if(tsubAdm)tsubAdm.textContent='Tüm şubeler';document.getElementById('page-content').innerHTML='<div class="empty"><div class="ico">📋</div><p>Şubeler yükleniyor...</p></div>';const{data:profiller,error}=await sb.from('sube_profiller').select('*');if(error){document.getElementById('page-content').innerHTML='<div class="empty"><p>Veri yüklenemedi: '+error.message+'</p></div>';return;}if(!profiller||!profiller.length){document.getElementById('page-content').innerHTML='<div class="empty"><div class="ico">📋</div><p>Henüz kayıtlı şube yok.</p></div>';return;}const{data:tumGirdiler,error:ge}=await sb.from('gunluk_girdiler').select('*');const{data:tumUrunler,error:ue}=await sb.from('urunler').select('*').order('sira');if(ge){toast('Girdiler yüklenemedi: '+ge.message,5000);}if(ue){toast('Ürünler yüklenemedi: '+ue.message,5000);}adminData={profiller,urunler:tumUrunler||[],girdiler:tumGirdiler||[]};adminSecilenSube=null;adminSecilenUrun=null;const{data:tumSkt}=await sb.from('skt_takip').select('*').order('son_tarih');adminData.skt=tumSkt||[];renderAdminAnaSayfa();}
function renderAdminSubeler(){const{profiller,urunler,girdiler}=adminData;const buAy=new Date().toISOString().slice(0,7);let html=`<div class="admin-panel"><div style="display:flex;align-items:center;gap:10px;margin-bottom:14px;flex-wrap:wrap"><button onclick="renderAdminAnaSayfa()" style="padding:8px 14px;background:var(--dark);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">← Geri</button><h2 style="margin:0">🏪 Şubeler <span style="font-size:13px;color:#aaa;font-weight:400">(${profiller.length} şube)</span></h2></div>`;profiller.forEach(p=>{const pGirdiler=girdiler.filter(g=>g.user_id===p.user_id);const pUrunler=urunler.filter(u=>u.user_id===p.user_id);const buAyFark=r(pGirdiler.filter(g=>g.tarih&&g.tarih.startsWith(buAy)).reduce((s,g)=>s+calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez}).fark,0));const topFark=r(pGirdiler.reduce((s,g)=>s+calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez}).fark,0));const sonGiris=pGirdiler.filter(g=>g.tarih).sort((a,b)=>b.tarih.localeCompare(a.tarih))[0]?.tarih||'—';const fc=topFark>0?'s-green':topFark<0?'s-red':'';const fcAy=buAyFark>0?'#27ae60':buAyFark<0?'#e74c3c':'#aaa';html+=`<div class="sube-card-admin" onclick="adminAcSube('${p.user_id}')"><h3>⚙️ ${p.sube_adi} <span style="font-size:11px;color:#aaa;font-weight:400">→ tıkla</span></h3><div class="sube-stats"><div class="sube-stat">${pUrunler.length} ürün</div><div class="sube-stat">${pGirdiler.length} kayıt</div><div class="sube-stat" style="color:${fcAy}">Bu ay: ${buAyFark>0?'+':''}${buAyFark}</div><div class="sube-stat ${fc}">Toplam: ${topFark>0?'+':''}${topFark}</div><div class="sube-stat" style="color:#aaa">Son: ${sonGiris}</div></div><div style="margin-top:8px;display:flex;gap:6px" onclick="event.stopPropagation()"><button onclick="adminAcSube('${p.user_id}')" style="padding:5px 12px;background:var(--orange);color:#fff;border:none;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer">📊 Detay</button>${isSuperAdmin?`<button onclick="adminSubeAdiDegistir('${p.user_id}','${p.sube_adi.replace(/'/g,"&#39;")}')" style="padding:5px 12px;background:#3498db;color:#fff;border:none;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer">✏️ Adı Düzenle</button>`:''} ${isSuperAdmin?`<button onclick="adminSubeSil('${p.user_id}','${p.sube_adi.replace(/'/g,"&#39;")}')" style="padding:5px 12px;background:#e74c3c;color:#fff;border:none;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer">🗑 Sil</button>`:''}</div></div>`;});html+=`</div>`;document.getElementById('page-content').innerHTML=html;}
function renderAdminAnaSayfa(){
  const{profiller,urunler,girdiler}=adminData;
  // Genel istatistikler
  const bugun=new Date().toISOString().slice(0,10);
  const bugunGiris=girdiler.filter(g=>g.tarih===bugun).length;
  const buAy=new Date().toISOString().slice(0,7);
  const buAyGiris=girdiler.filter(g=>g.tarih&&g.tarih.startsWith(buAy)).length;
  // En çok kayıp ürünler
  const urunFarklar={};
  girdiler.forEach(g=>{
    const key=g.user_id+'_'+g.urun_sira;
    const urun=urunler.find(u=>u.user_id===g.user_id&&u.sira===g.urun_sira);
    if(!urun)return;
    const f=calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez}).fark;
    if(!urunFarklar[urun.ad])urunFarklar[urun.ad]=0;
    urunFarklar[urun.ad]+=f;
  });
  const topKayip=Object.entries(urunFarklar).filter(([,f])=>f<0).sort(([,a],[,b])=>a-b).slice(0,5);
  const topArtis=Object.entries(urunFarklar).filter(([,f])=>f>0).sort(([,a],[,b])=>b-a).slice(0,5);
  let html=`<div class="admin-panel">
  <h2>⚙️ Admin Paneli <span class="admin-badge">TÜM ŞUBELER</span></h2>
  <div class="admin-kart-grid">
    <button onclick="renderAdminSubeler()" class="admin-kart" style="background:linear-gradient(135deg,#e85d04,#f39c12)">
      <span class="kart-ikon">🏪</span><span class="kart-baslik">Şubeler</span><span class="kart-aciklama">Tüm şubeleri gör</span>
    </button>
    <button onclick="renderAdminUrunler()" class="admin-kart" style="background:linear-gradient(135deg,#e67e22,#f0a500)">
      <span class="kart-ikon">📦</span><span class="kart-baslik">Ürünler</span><span class="kart-aciklama">Ekle / Sil</span>
    </button>
    <button onclick="renderAdminAylikRapor()" class="admin-kart" style="background:linear-gradient(135deg,#1e293b,#334155)">
      <span class="kart-ikon">📊</span><span class="kart-baslik">Aylık Rapor</span><span class="kart-aciklama">Ay bazlı analiz</span>
    </button>
    <button onclick="renderAdminKarsilastirma()" class="admin-kart" style="background:linear-gradient(135deg,#0891b2,#06b6d4)">
      <span class="kart-ikon">📈</span><span class="kart-baslik">Karşılaştırma</span><span class="kart-aciklama">Şube karşılaştır</span>
    </button>
    <button onclick="adminTumExcel()" class="admin-kart" style="background:linear-gradient(135deg,#27ae60,#2ecc71)">
      <span class="kart-ikon">📥</span><span class="kart-baslik">Excel İndir</span><span class="kart-aciklama">Tüm veriyi aktar</span>
    </button>
    <button onclick="renderAdminSubeYonetimi()" class="admin-kart" style="background:linear-gradient(135deg,#0f766e,#0d9488)">
      <span class="kart-ikon">🏗️</span><span class="kart-baslik">Şube Yönetimi</span><span class="kart-aciklama">Düzenle / Yönet</span>
    </button>
    <button onclick="renderAdminYonetimi()" class="admin-kart" style="background:linear-gradient(135deg,#7c3aed,#a855f7)">
      <span class="kart-ikon">👑</span><span class="kart-baslik">Admin Yönetimi</span><span class="kart-aciklama">Rol ata / kaldır</span>
    </button>
    <button onclick="renderAdminPdfRapor()" class="admin-kart" style="background:linear-gradient(135deg,#c0392b,#e74c3c)">
      <span class="kart-ikon">📄</span><span class="kart-baslik">PDF Rapor</span><span class="kart-aciklama">Şube & ürün yazdır</span>
    </button>
    ${isSuperAdmin?`<button onclick="renderSuperKullanicilar()" class="admin-kart" style="background:linear-gradient(135deg,#b91c1c,#dc2626)">
      <span class="kart-ikon">👥</span><span class="kart-baslik">Kullanıcılar</span><span class="kart-aciklama">Loglar & Mailleri</span>
    </button>`:''}
  </div>
  <div class="stats-row" style="margin-bottom:16px">
    <div class="stat-card orange"><div class="sl">Toplam Şube</div><div class="sv">${profiller.length}</div></div>
    <div class="stat-card"><div class="sl">Bugün Giriş</div><div class="sv">${bugunGiris}</div></div>
    <div class="stat-card"><div class="sl">Bu Ay Giriş</div><div class="sv">${buAyGiris}</div></div>
    <div class="stat-card"><div class="sl">Toplam Kayıt</div><div class="sv">${girdiler.length}</div></div>
  </div>
  ${(()=>{const allSkt=adminData.skt||[];const kritik=allSkt.filter(s=>sktGunFark(s.son_tarih)<=5);if(!kritik.length)return '';let shtml='<div style="background:#fff3cd;border:2px solid #ffc107;border-radius:10px;padding:10px 14px;margin-bottom:16px"><div style="font-weight:800;color:#856404;font-size:13px;margin-bottom:8px">? TÜM ŞUBLERDE SKT UYARILARI ('+kritik.length+')</div>';[...kritik].sort((a,b)=>a.son_tarih.localeCompare(b.son_tarih)).forEach(s=>{const p=adminData.profiller.find(pr=>pr.user_id===s.user_id);const g=sktGunFark(s.son_tarih);const c=g<0?'#e74c3c':g===0?'#e74c3c':g<=2?'#e67e22':'#856404';const badge=g<0?'SÜRESİ GEÇTİ':g===0?'BUGÜN!':g+' gün kaldı';shtml+='<div style="display:flex;align-items:center;padding:5px 0;border-bottom:1px solid #ffe8a1;gap:8px"><span style="color:#aaa;font-size:11px;min-width:90px">'+(p?.sube_adi||'?')+'</span><span style="font-weight:700;color:#333;flex:1">'+s.urun_adi+(s.miktar?' ('+s.miktar+')':'')+'</span><span style="color:'+c+';font-weight:700;font-size:11px">'+badge+'</span></div>';});shtml+='</div>';return shtml;})()}`;
  // En çok satan ürünler kaldırıldı
  // Kayıp/Artı Özeti
  if(topKayip.length||topArtis.length){
    html+=`<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px">
    <div style="background:#fff5f5;border:1px solid #fcc;border-radius:10px;padding:12px">
      <div style="font-size:12px;font-weight:700;color:#e74c3c;margin-bottom:8px">📉 En çok Kayıp ürünler</div>
      ${topKayip.map(([ad,f])=>`<div style="display:flex;justify-content:space-between;font-size:12px;padding:4px 0;border-bottom:1px solid #fee"><span>${ad}</span><span style="color:#e74c3c;font-weight:700">${r(f)}</span></div>`).join('')}
    </div>
    <div style="background:#f0fff4;border:1px solid #9f9;border-radius:10px;padding:12px">
      <div style="font-size:12px;font-weight:700;color:#27ae60;margin-bottom:8px">📈 En çok Fazla Ürünler</div>
      ${topArtis.map(([ad,f])=>`<div style="display:flex;justify-content:space-between;font-size:12px;padding:4px 0;border-bottom:1px solid #dfd"><span>${ad}</span><span style="color:#27ae60;font-weight:700">+${r(f)}</span></div>`).join('')}
    </div></div>`;
  }
  html+=`<div style="font-size:12px;color:#999;margin-bottom:10px">${profiller.length} şube — şubeye tıklayın</div>`;
  profiller.forEach(p=>{
    const pGirdiler=girdiler.filter(g=>g.user_id===p.user_id);
    const pUrunler=urunler.filter(u=>u.user_id===p.user_id);
    const buAyFark=r(pGirdiler.filter(g=>g.tarih&&g.tarih.startsWith(buAy)).reduce((s,g)=>s+calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez}).fark,0));
    const topFark=r(pGirdiler.reduce((s,g)=>s+calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez}).fark,0));
    const sonGiris=pGirdiler.filter(g=>g.tarih).sort((a,b)=>b.tarih.localeCompare(a.tarih))[0]?.tarih||'?';
    const fc=topFark>0?'s-green':topFark<0?'s-red':'';
    const fcAy=buAyFark>0?'#27ae60':buAyFark<0?'#e74c3c':'#aaa';
    html+=`<div class="sube-card-admin" onclick="adminAcSube('${p.user_id}')">
      <h3>⚙️ ${p.sube_adi} <span style="font-size:11px;color:#aaa;font-weight:400">→ tıkla</span></h3>
      <div class="sube-stats">
        <div class="sube-stat">${pUrunler.length} ürün</div>
        <div class="sube-stat">${pGirdiler.length} kayıt</div>
        <div class="sube-stat" style="color:${fcAy}">Bu ay: ${buAyFark>0?'+':''}${buAyFark}</div>
        <div class="sube-stat ${fc}">Toplam: ${topFark>0?'+':''}${topFark}</div>
        <div class="sube-stat" style="color:#aaa">Son: ${sonGiris}</div>
      </div>
      <div style="margin-top:8px;display:flex;gap:6px" onclick="event.stopPropagation()">
        <button onclick="adminAcSube('${p.user_id}')" style="padding:5px 12px;background:var(--orange);color:#fff;border:none;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer">📊 Detay</button>
        ${isSuperAdmin?`<button onclick="adminSubeAdiDegistir('${p.user_id}','${p.sube_adi.replace(/'/g,'&#39;')}')" style="padding:5px 12px;background:#3498db;color:#fff;border:none;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer">✏️ Adı Düzenle</button>`:''}
        ${isSuperAdmin?`<button onclick="adminSubeSil('${p.user_id}','${p.sube_adi.replace(/'/g,"&#39;")}')" style="padding:5px 12px;background:#e74c3c;color:#fff;border:none;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer">🗑 Sil</button>`:''}
      </div>
    </div>`;
  });
  html+=`</div>`;
  document.getElementById('page-content').innerHTML=html;
}
function adminAcSube(userId){adminSecilenSube=userId;adminSecilenUrun=null;const profil=adminData.profiller.find(p=>p.user_id===userId);const urunler=adminData.urunler.filter(u=>u.user_id===userId);const girdiler=adminData.girdiler.filter(g=>g.user_id===userId);const bugun=new Date().toISOString().slice(0,10);const gunler=[...new Set(girdiler.filter(g=>g.tarih).map(g=>g.tarih))].sort().reverse();let html=`<div class="admin-panel"><div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;flex-wrap:wrap"><button onclick="renderAdminAnaSayfa()" style="background:var(--dark);color:#fff;border:none;border-radius:8px;padding:8px 14px;cursor:pointer;font-size:13px;font-weight:700">← Geri</button><h2 style="margin:0;flex:1">🏪 ${profil?.sube_adi||'Şube'}</h2><div style="display:flex;gap:6px;align-items:center"><select id="admin-gun-sec" style="padding:7px 10px;border:2px solid #eee;border-radius:8px;font-size:12px"><option value="${bugun}">Bugün (${bugun})</option>${gunler.filter(g=>g!==bugun).map(g=>`<option value="${g}">${g}</option>`).join('')}</select><button onclick="adminSubeGunPdf('${userId}')" style="padding:8px 12px;background:#c0392b;color:#fff;border:none;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer">📋 Günlük PDF</button><button onclick="adminGunYonetimi('${userId}')" style="padding:8px 12px;background:#7c3aed;color:#fff;border:none;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer">📅 Günleri Yönet</button></div></div><div style="font-size:12px;color:#999;margin-bottom:12px">${urunler.length} ürün — bir ürüne tıklayarak tüm girişleri görün</div>`;urunler.forEach(u=>{const uGirdiler=girdiler.filter(g=>g.urun_sira===u.sira);let toplamFark=0;uGirdiler.forEach(g=>{const e={acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez};toplamFark+=calcEntry(e).fark;});toplamFark=r(toplamFark);const fc=toplamFark>0?'s-green':toplamFark<0?'s-red':'';const bugunG=uGirdiler.find(g=>g.tarih===bugun);const bugunFark=bugunG?calcEntry({acilis:bugunG.acilis,gelen:bugunG.gelen,gelenIade:bugunG.gelen_iade,transfer:bugunG.transfer,kapanis:bugunG.kapanis,mallara:bugunG.mallara_gore,zayi:bugunG.zayi,odenmez:bugunG.odenmez}).fark:null;const bfc=bugunFark===null?'':bugunFark>0?'color:#27ae60':bugunFark<0?'color:#e74c3c':'color:#999';html+=`<div class="sube-card-admin" onclick="adminAcUrun('${userId}',${u.sira})"><h3>${u.sira+1}. ${u.ad} <span style="font-size:10px;color:#aaa">(${u.birim})</span></h3><div class="sube-stats"><div class="sube-stat">${uGirdiler.length} gün kayıt</div>${bugunFark!==null?`<div class="sube-stat" style="${bfc}">Bugün: ${bugunFark>0?'+':''}${bugunFark}</div>`:''}<div class="sube-stat ${fc}">${toplamFark>0?'+':''}${toplamFark} toplam</div></div></div>`;});html+=`</div>`;document.getElementById('page-content').innerHTML=html;}
async function adminGunYonetimi(userId){const profil=adminData.profiller.find(p=>p.user_id===userId);const girdiler=adminData.girdiler.filter(g=>g.user_id===userId);const gunler=[...new Set(girdiler.filter(g=>g.tarih).map(g=>g.tarih))].sort().reverse();const bugun=new Date().toISOString().slice(0,10);const gecmisGunler=gunler.filter(g=>g<bugun);const{data:aciklar}=await sb.from('acik_gunler').select('tarih').eq('user_id',userId);const acikSet=new Set((aciklar||[]).map(r=>r.tarih));let html=`<div class="admin-panel"><div style="display:flex;align-items:center;gap:10px;margin-bottom:14px"><button onclick="adminAcSube('${userId}')" style="padding:8px 14px;background:var(--dark);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">← Geri</button><h2 style="margin:0">🔒 Gün Kilidi — ${profil?.sube_adi||'Şube'}</h2></div>`;if(!gecmisGunler.length){html+=`<div style="color:#aaa;font-size:13px">Henüz geçmiş gün kaydı yok.</div>`;}else{html+=`<div style="font-size:12px;color:#666;margin-bottom:12px;background:#f0f4ff;padding:10px;border-radius:8px">ℹ️ Kilitli günler değiştirilemez. Açık günleri şube düzenleyebilir. İşiniz bitince tekrar kilitleyin.</div>`;gecmisGunler.forEach(g=>{const acik=acikSet.has(g);html+=`<div style="display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border:2px solid ${acik?'#27ae60':'#eee'};border-radius:10px;margin-bottom:8px;background:${acik?'#f0fff4':'#fff'}"><div><span style="font-weight:700;font-size:14px">${g}</span><span style="margin-left:10px;font-size:12px;color:${acik?'#27ae60':'#aaa'}">${acik?'✅ Açık — düzenlenebilir':'🔒 Kilitli'}</span></div><button onclick="adminToggleGun('${userId}','${g}',${acik})" style="padding:7px 16px;background:${acik?'#e74c3c':'#27ae60'};color:#fff;border:none;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer">${acik?'🔒 Kilitle':'✅ Aç'}</button></div>`;});} html+=`</div>`;document.getElementById('page-content').innerHTML=html;}
async function adminToggleGun(userId,tarih,acikMi){if(acikMi){const{error}=await sb.from('acik_gunler').delete().eq('user_id',userId).eq('tarih',tarih);if(error){toast('Hata: '+error.message,4000);return;}toast('🔒 '+tarih+' kilitlendi');}else{const{error}=await sb.from('acik_gunler').insert({user_id:userId,tarih,acik_yapan:currentUser?.email||'admin'});if(error){toast('Hata: '+error.message,4000);return;}toast('🔒 '+tarih+' açıldı — şube düzenleyebilir');}adminGunYonetimi(userId);}
function adminSubeGunPdf(userId){const tarih=document.getElementById('admin-gun-sec')?.value||new Date().toISOString().slice(0,10);const profil=adminData.profiller.find(p=>p.user_id===userId);const urunler=adminData.urunler.filter(u=>u.user_id===userId);const girdiler=adminData.girdiler.filter(g=>g.user_id===userId&&g.tarih===tarih);if(!girdiler.length){toast('Bu tarihte giriş yok: '+tarih,3000);return;}let rows='';let ozet={artis:0,eksi:0,notr:0};urunler.forEach(u=>{const g=girdiler.find(g=>g.urun_sira===u.sira);if(!g)return;const e={acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez};const{sayima,fark}=calcEntry(e);const fc=fark>0?'color:#27ae60;font-weight:800':fark<0?'color:#e74c3c;font-weight:800':'color:#999';if(fark>0)ozet.artis++;else if(fark<0)ozet.eksi++;else ozet.notr++;rows+=`<tr><td style="text-align:left;font-weight:600">${u.ad}</td><td>${u.birim}</td><td>${g.acilis??''}</td><td>${g.gelen??''}</td><td>${g.kapanis??''}</td><td>${sayima}</td><td>${fmt(g.mallara_gore)}</td><td>${fmt(g.zayi)}</td><td style="${fc}">${fark>0?'+':''}${fmt(fark)||'0'}</td></tr>`;});const html=`<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"><title>${profil?.sube_adi} - ${tarih}</title><style>*{box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:10px;color:#222;margin:0.8cm}h1{font-size:15px;color:#e85d04;margin:0 0 2px}h2{font-size:11px;color:#555;font-weight:400;margin:0 0 12px}.ozet{display:flex;gap:12px;margin-bottom:10px;flex-wrap:wrap}.oz{padding:6px 14px;border-radius:6px;font-size:10px;text-align:center;border:1px solid #eee}.oz b{display:block;font-size:16px;font-weight:800}table{width:100%;border-collapse:collapse}th{background:#1a1a2e;color:#fff;padding:5px 7px;text-align:center;font-size:9px}th:first-child{text-align:left}td{padding:4px 7px;text-align:center;border-bottom:1px solid #eee;font-size:9px}td:first-child{text-align:left}tr:nth-child(even){background:#f9f9f9}.footer{margin-top:10px;font-size:8px;color:#bbb;border-top:1px solid #eee;padding-top:5px;display:flex;justify-content:space-between}@media print{@page{size:A4 portrait;margin:0.8cm}}</style></head><body><h1>📋 ${profil?.sube_adi||'Şube'} — Günlük Envanter Raporu</h1><h2>⚙️ ${tarih}</h2><div class="ozet"><div class="oz" style="border-color:#27ae60"><b style="color:#27ae60">${ozet.artis}</b>Fazla</div><div class="oz" style="border-color:#e74c3c"><b style="color:#e74c3c">${ozet.eksi}</b>Eksik</div><div class="oz"><b style="color:#999">${ozet.notr}</b>Sıfır</div></div><table><thead><tr><th>Ürün</th><th>Birim</th><th>Açılış</th><th>Gelen</th><th>Kapanış</th><th>Sayıma</th><th>Mallara</th><th>Zayi</th><th>FARK</th></tr></thead><tbody>${rows}</tbody></table><div class="footer"><span>Ercan BRGR Envanter — YPC.TECNO</span><span>Oluşturuldu: ${new Date().toLocaleString('tr-TR')}</span></div></body></html>`;pdfAc(html);}
function renderAdminAylikRapor(){const{profiller,urunler,girdiler}=adminData;const months=[...new Set(girdiler.filter(g=>g.tarih).map(g=>g.tarih.slice(0,7)))].sort().reverse();let html=`<div class="admin-panel"><div style="display:flex;gap:8px;margin-bottom:14px;flex-wrap:wrap"><button onclick="renderAdminAnaSayfa()" style="padding:8px 14px;background:var(--dark);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">← Geri</button><h2 style="margin:0;align-self:center">📊 Aylık Rapor</h2></div>`;if(!months.length){html+=`<div class="empty"><div class="ico">📋</div><p>Henüz tarihli giriş yok.</p></div>`;}else{months.forEach(ay=>{const ayGirdiler=girdiler.filter(g=>g.tarih&&g.tarih.startsWith(ay));let toplamFark=0,toplamSatilan=0,toplamSayima=0;ayGirdiler.forEach(g=>{const e={acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez};const{sayima,fark}=calcEntry(e);toplamFark+=fark;toplamSatilan+=n(g.mallara_gore);toplamSayima+=sayima;});toplamFark=r(toplamFark);toplamSatilan=r(toplamSatilan);toplamSayima=r(toplamSayima);const subeSet=new Set(ayGirdiler.map(g=>g.user_id));const fc=toplamFark>0?'s-green':toplamFark<0?'s-red':'';html+=`<div class="sube-card-admin" style="cursor:default"><h3>⚙️ ${monthLabel(ay)}</h3><div class="sube-stats"><div class="sube-stat">${subeSet.size} şube aktif</div><div class="sube-stat">${ayGirdiler.length} giriş</div><div class="sube-stat">Satılan: ${toplamSatilan}</div><div class="sube-stat">Sayıma: ${toplamSayima}</div><div class="sube-stat ${fc}">${toplamFark>0?'+':''}${toplamFark} fark</div></div><div style="margin-top:8px;display:flex;gap:6px"><button onclick="adminAyCSV('${ay}')" style="padding:5px 12px;background:var(--orange);color:#fff;border:none;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer">📊 Excel İndir</button><button onclick="adminAyPdf('${ay}')" style="padding:5px 12px;background:#c0392b;color:#fff;border:none;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer">📋 PDF Al</button></div></div>`;});}html+=`</div>`;document.getElementById('page-content').innerHTML=html;}
function adminAyCSV(ay){adminAyExcel(ay);}
function adminTumCSV(){adminTumExcel();}
function adminAyPdf(ay){const{profiller,urunler,girdiler}=adminData;const ayGirdiler=girdiler.filter(g=>g.tarih&&g.tarih.startsWith(ay));if(!ayGirdiler.length){toast('Bu ayda giriş yok');return;}const ayLab=monthLabel(ay);let icerik='';const subeler=[...new Set(ayGirdiler.map(g=>g.user_id))].map(id=>profiller.find(p=>p.user_id===id)).filter(Boolean);subeler.forEach(profil=>{const pUrunler=urunler.filter(u=>u.user_id===profil.user_id);const pGirdiler=ayGirdiler.filter(g=>g.user_id===profil.user_id);if(!pGirdiler.length)return;icerik+=`<div style="page-break-before:auto;margin-bottom:28px"><div style="background:#1a1a2e;color:#fff;padding:8px 14px;border-radius:8px 8px 0 0;font-size:13px;font-weight:800">🏪 ${profil.sube_adi}</div>`;pUrunler.forEach(urun=>{const uGirdiler=pGirdiler.filter(g=>g.urun_sira===urun.sira).sort((a,b)=>a.tarih>b.tarih?1:-1);if(!uGirdiler.length)return;let rows='';let topFark=0;uGirdiler.forEach(g=>{const e={acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez};const{sayima,fark}=calcEntry(e);topFark=r(topFark+fark);const fc=fark>0?'#27ae60':fark<0?'#e74c3c':'#999';rows+=`<tr><td style="color:#555">${g.tarih||''}</td><td>${g.acilis??''}</td><td>${g.gelen??''}</td><td>${g.kapanis??''}</td><td>${sayima}</td><td>${fmt(g.mallara_gore)}</td><td>${fmt(g.zayi)}</td><td style="font-weight:800;color:${fc}">${fark>0?'+':''}${fark}</td></tr>`;});const tfColor=topFark>0?'#27ae60':topFark<0?'#e74c3c':'#555';icerik+=`<div style="margin-bottom:14px;page-break-inside:avoid"><div style="display:flex;justify-content:space-between;align-items:center;background:#f8f4ff;border-left:4px solid #e85d04;padding:5px 10px;margin-top:10px"><span style="font-weight:800;font-size:11px;color:#1a1a2e">${urun.ad} <span style="font-weight:400;color:#aaa">(${urun.birim})</span></span><span style="font-size:10px;font-weight:800;color:${tfColor}">Toplam: ${topFark>0?'+':''}${topFark}</span></div><table><thead><tr><th>Tarih</th><th>Açılış</th><th>Gelen</th><th>Kapanış</th><th>Sayıma</th><th>Mallara</th><th>Zayi</th><th>FARK</th></tr></thead><tbody>${rows}</tbody></table></div>`;});icerik+=`</div>`;});const html=`<!DOCTYPE html><html lang="tr"><head><meta charset="UTF-8"><title>Rapor - ${ayLab}</title><style>*{box-sizing:border-box}body{font-family:Arial,sans-serif;font-size:9px;color:#333;margin:1cm}h1{font-size:14px;color:#e85d04;margin:0 0 2px}h2{font-size:10px;color:#666;font-weight:400;margin:0 0 14px}table{width:100%;border-collapse:collapse;margin:0}th{background:#2d3748;color:#fff;padding:4px 6px;text-align:center;font-size:8px}th:first-child{text-align:left}td{padding:3px 6px;text-align:center;border-bottom:1px solid #f0f0f0;font-size:9px}td:first-child{text-align:left}tr:nth-child(even){background:#fafafa}.footer{margin-top:14px;font-size:8px;color:#bbb;border-top:1px solid #eee;padding-top:5px;display:flex;justify-content:space-between}@media print{@page{size:A4 portrait;margin:1cm}}</style></head><body><h1>📄 Admin Aylık Envanter Raporu — ${ayLab}</h1><h2>Tüm şubeler — Ürün bazlı, gün gün</h2>${icerik}<div class="footer"><span>Ercan BRGR Envanter — YPC.TECNO</span><span>Oluşturuldu: ${new Date().toLocaleString('tr-TR')}</span></div></body></html>`;pdfAc(html);}
function xlsxHdr(ws,row,cols){cols.forEach((v,c)=>{const ref=XLSX.utils.encode_cell({r:row,c});ws[ref]={v,t:'s',s:{font:{bold:true,color:{rgb:'FFFFFF'},sz:11},fill:{fgColor:{rgb:'E8590C'}},alignment:{horizontal:'center',wrapText:true},border:{bottom:{style:'thin',color:{rgb:'999999'}}}}}});if(!ws['!ref']){ws['!ref']=XLSX.utils.encode_range({s:{r:0,c:0},e:{r:row,c:cols.length-1}});}return row+1;}
function xlsxRow(ws,row,vals,isTotal){vals.forEach((v,c)=>{const ref=XLSX.utils.encode_cell({r:row,c});const isNum=typeof v==='number';const isFark=c===vals.length-1;const farkColor=isNum&&isFark?(v>0?'1E8449':v<0?'C0392B':'333333'):'333333';ws[ref]={v:v??'',t:isNum?'n':'s',s:{font:{bold:isTotal||false,color:{rgb:isFark?farkColor:'333333'},sz:10},fill:{fgColor:{rgb:isTotal?'FFF3CD':row%2===0?'FFFFFF':'F9F9F9'}},alignment:{horizontal:isNum?'center':'left'}}};});if(ws['!ref']){const r=XLSX.utils.decode_range(ws['!ref']);r.e.r=Math.max(r.e.r,row);r.e.c=Math.max(r.e.c,vals.length-1);ws['!ref']=XLSX.utils.encode_range(r);}return row+1;}
function adminAyExcel(ay){
  const{profiller,urunler,girdiler}=adminData;
  const ayGirdiler=girdiler.filter(g=>g.tarih&&g.tarih.startsWith(ay));
  if(!ayGirdiler.length){toast('Bu ayda giriş yok');return;}
  const wb=XLSX.utils.book_new();
  const basliklar=['Şube','Ürün','Birim','Gün','Tarih','Açılış','Gelen','G.İade','Transfer','Kapanış','Sayıma Göre','Mallara Göre','Zayi','Ödenmez','FARK'];
  // Özet sayfası
  const ozWs={};let ozRow=0;
  ozRow=xlsxHdr(ozWs,ozRow,['Şube','Ürün','Toplam Fark','Gün Sayısı']);
  let ozTopFark=0;
  profiller.forEach(p=>{
    const pG=ayGirdiler.filter(g=>g.user_id===p.user_id);
    if(!pG.length)return;
    urunler.filter(u=>u.user_id===p.user_id).forEach(u=>{
      const uG=pG.filter(g=>g.urun_sira===u.sira);
      if(!uG.length)return;
      const fark=r(uG.reduce((s,g)=>s+calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez}).fark,0));
      ozRow=xlsxRow(ozWs,ozRow,[p.sube_adi,u.ad,fark,uG.length]);
      ozTopFark+=fark;
    });
  });
  ozRow=xlsxRow(ozWs,ozRow,['','TOPLAM',r(ozTopFark),''],true);
  ozWs['!cols']=[{wch:20},{wch:22},{wch:14},{wch:10}];
  XLSX.utils.book_append_sheet(wb,ozWs,'ÖZET');
  // Her şube ayrı sayfa
  profiller.forEach(p=>{
    const pG=ayGirdiler.filter(g=>g.user_id===p.user_id);
    if(!pG.length)return;
    const ws={};let row=0;
    row=xlsxHdr(ws,row,basliklar);
    let topFark=0;
    pG.forEach(g=>{
      const urun=urunler.find(u=>u.user_id===p.user_id&&u.sira===g.urun_sira);
      const{sayima,fark}=calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez});
      topFark+=fark;
      row=xlsxRow(ws,row,[p.sube_adi,urun?.ad||'',urun?.birim||'',g.gun,g.tarih,n(g.acilis),n(g.gelen),n(g.gelen_iade),n(g.transfer),n(g.kapanis),sayima,n(g.mallara_gore),n(g.zayi),n(g.odenmez),fark]);
    });
    row=xlsxRow(ws,row,['','','','','','','','','','','','','','TOPLAM FARK',r(topFark)],true);
    ws['!cols']=basliklar.map((_,i)=>({wch:[16,22,8,6,12,10,10,8,10,10,12,12,8,10,10][i]||10}));
    const sheetName=(p.sube_adi||'Sube').slice(0,31).replace(/[\/\\?*\[\]]/g,'');
    XLSX.utils.book_append_sheet(wb,ws,sheetName);
  });
  XLSX.writeFile(wb,`BRGR_${monthLabel(ay).replace(/\s/g,'_')}.xlsx`);
  toast('Excel indirildi ✅');
}
function adminTumExcel(){
  const{profiller,urunler,girdiler}=adminData;
  if(!girdiler.length){toast('Veri yok');return;}
  const months=[...new Set(girdiler.filter(g=>g.tarih).map(g=>g.tarih.slice(0,7)))].sort().reverse();
  if(months.length===1){adminAyExcel(months[0]);return;}
  const wb=XLSX.utils.book_new();
  const basliklar=['Şube','Ürün','Birim','Gün','Tarih','Açılış','Gelen','G.İade','Transfer','Kapanış','Sayıma Göre','Mallara Göre','Zayi','Ödenmez','FARK'];
  // Özet sayfası
  const ozWs={};let ozRow=0;
  ozRow=xlsxHdr(ozWs,ozRow,['Ay','Şube Sayısı','Toplam Giriş','Toplam Fark']);
  months.forEach(ay=>{
    const ayG=girdiler.filter(g=>g.tarih&&g.tarih.startsWith(ay));
    const fark=r(ayG.reduce((s,g)=>s+calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez}).fark,0));
    const subeSet=new Set(ayG.map(g=>g.user_id));
    ozRow=xlsxRow(ozWs,ozRow,[monthLabel(ay),subeSet.size,ayG.length,fark]);
  });
  ozWs['!cols']=[{wch:16},{wch:12},{wch:14},{wch:14}];
  XLSX.utils.book_append_sheet(wb,ozWs,'ÖZET');
  // Her ay ayrı sayfa
  months.slice(0,12).forEach(ay=>{
    const ayG=girdiler.filter(g=>g.tarih&&g.tarih.startsWith(ay));
    if(!ayG.length)return;
    const ws={};let row=0;
    row=xlsxHdr(ws,row,basliklar);
    let topFark=0;
    ayG.forEach(g=>{
      const profil=profiller.find(p=>p.user_id===g.user_id);
      const urun=urunler.find(u=>u.user_id===g.user_id&&u.sira===g.urun_sira);
      const{sayima,fark}=calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez});
      topFark+=fark;
      row=xlsxRow(ws,row,[profil?.sube_adi||'',urun?.ad||'',urun?.birim||'',g.gun,g.tarih,n(g.acilis),n(g.gelen),n(g.gelen_iade),n(g.transfer),n(g.kapanis),sayima,n(g.mallara_gore),n(g.zayi),n(g.odenmez),fark]);
    });
    row=xlsxRow(ws,row,['','','','','','','','','','','','','','TOPLAM FARK',r(topFark)],true);
    ws['!cols']=basliklar.map((_,i)=>({wch:[16,22,8,6,12,10,10,8,10,10,12,12,8,10,10][i]||10}));
    XLSX.utils.book_append_sheet(wb,ws,monthLabel(ay).replace(/\s/g,'_').slice(0,31));
  });
  XLSX.writeFile(wb,'BRGR_Tum_Veriler_'+new Date().toISOString().slice(0,10)+'.xlsx');
  toast('Tüm veriler Excel olarak indirildi ✅');
}
let prodChartInstance=null;
function renderIzeka(p){const birim=p.birim||'Adet';const sonGirisler=p.entries.filter(e=>n(e.mallara)>0||n(e.kapanis)>0).slice(-14);if(!sonGirisler.length)return '';const mallaraList=sonGirisler.filter(e=>n(e.mallara)>0);const ortMallara=mallaraList.length?r(mallaraList.reduce((s,e)=>s+n(e.mallara),0)/mallaraList.length):null;const sonKapanis=p.entries.length?n(p.entries[p.entries.length-1].kapanis||''):null;const gunYeter=ortMallara&&ortMallara>0&&sonKapanis!==null?Math.floor(sonKapanis/ortMallara):null;const toplamFire=r(p.entries.reduce((s,e)=>s+Math.min(0,calcEntry(e).fark),0));const fireMaliyet=toplamFire<0&&p.birimFiyat>0?r(Math.abs(toplamFire)*p.birimFiyat):null;const gunRenk=gunYeter===null?'#aaa':gunYeter<=1?'#e74c3c':gunYeter<=3?'#e67e22':'#27ae60';let html=`<div style="background:#fff;border-radius:12px;padding:14px;margin-bottom:12px;box-shadow:0 1px 4px rgba(0,0,0,0.06)"><div style="font-size:11px;font-weight:700;color:#999;text-transform:uppercase;margin-bottom:10px">💡 İş Zekası</div><div style="display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-bottom:10px">`;if(ortMallara!==null)html+=`<div style="background:#f8f8f8;border-radius:8px;padding:10px"><div style="font-size:10px;color:#999;margin-bottom:4px">Ort. Günlük Satış (son ${mallaraList.length} gün)</div><div style="font-size:20px;font-weight:800;color:#333">${ortMallara} <span style="font-size:11px;font-weight:400">${birim}</span></div></div>`;if(gunYeter!==null)html+=`<div style="background:#f8f8f8;border-radius:8px;padding:10px;border-left:3px solid ${gunRenk}"><div style="font-size:10px;color:#999;margin-bottom:4px">Mevcut Stok Yeter</div><div style="font-size:20px;font-weight:800;color:${gunRenk}">${gunYeter} gün</div></div>`;if(ortMallara!==null)html+=`<div style="background:#e8f4fd;border-radius:8px;padding:10px"><div style="font-size:10px;color:#2980b9;margin-bottom:4px">Yarın Tahmini Kullanım</div><div style="font-size:20px;font-weight:800;color:#2980b9">${ortMallara} <span style="font-size:11px;font-weight:400">${birim}</span></div></div>`;html+=`<div style="background:#f8f8f8;border-radius:8px;padding:10px;border-left:3px solid ${toplamFire<0?'#e74c3c':'#27ae60'}"><div style="font-size:10px;color:#999;margin-bottom:4px">Toplam Fire</div><div style="font-size:20px;font-weight:800;color:${toplamFire<0?'#e74c3c':'#27ae60'}">${fmtOr0(toplamFire)} <span style="font-size:11px;font-weight:400">${birim}</span></div>${fireMaliyet!==null?`<div style="font-size:12px;color:#e74c3c;font-weight:700;margin-top:4px">? ${fireMaliyet}? kayıp</div>`:''}</div>`;html+=`</div>`;if(gunYeter!==null&&gunYeter<=3)html+=`<div style="background:#fdf2e9;border-radius:8px;padding:10px;margin-bottom:8px;display:flex;align-items:center;gap:10px"><span style="font-size:20px">💡</span><div><div style="font-size:12px;font-weight:700;color:#e67e22">SİPARİŞ VER!</div><div style="font-size:11px;color:#aaa">${gunYeter<=0?'Stok tükendi!':gunYeter+' gün kaldı — hemen sipariş ver'}</div></div></div>`;if(p.minStok!==null&&sonKapanis!==null&&sonKapanis<p.minStok)html+=`<div style="background:#fdf2e9;border-radius:8px;padding:10px;margin-bottom:8px;display:flex;align-items:center;gap:10px"><span>📈</span><span style="font-size:12px;color:#e67e22;font-weight:700">Min stok uyarısı! Mevcut: ${sonKapanis} — Min: ${p.minStok} ${birim}</span></div>`;html+=`</div>`;return html;}
function renderChart(p,filtered){const chartEntries=filtered.filter(e=>e.tarih).slice(-30);if(chartEntries.length<2)return '';return `<div style="background:#fff;border-radius:12px;padding:14px;margin-bottom:12px;box-shadow:0 1px 4px rgba(0,0,0,0.06)"><div style="font-size:11px;font-weight:700;color:#999;text-transform:uppercase;margin-bottom:10px">📈 Trend Grafiği (son ${chartEntries.length} gün)</div><canvas id="prod-chart" style="max-height:180px"></canvas></div>`;}
function initChart(p,filtered){const ctx=document.getElementById('prod-chart');if(!ctx)return;if(prodChartInstance){prodChartInstance.destroy();prodChartInstance=null;}const chartEntries=filtered.filter(e=>e.tarih).slice(-30);if(chartEntries.length<2)return;const labels=chartEntries.map(e=>e.tarih.slice(5));const kapanisData=chartEntries.map(e=>e.kapanis!==''?n(e.kapanis):null);const mallara=chartEntries.map(e=>e.mallara!==''?n(e.mallara):null);prodChartInstance=new Chart(ctx,{type:'line',data:{labels,datasets:[{label:'Kapanış',data:kapanisData,borderColor:'#e8590c',backgroundColor:'rgba(232,89,12,0.08)',tension:0.3,pointRadius:3,fill:true},{label:'Satılan',data:mallara,borderColor:'#3498db',backgroundColor:'rgba(52,152,219,0.08)',tension:0.3,pointRadius:3,fill:false}]},options:{responsive:true,plugins:{legend:{labels:{font:{size:11},boxWidth:12}}},scales:{y:{beginAtZero:false,ticks:{font:{size:10}}},x:{ticks:{font:{size:10},maxRotation:45}}}}});}
let adminSecAy='tumu';
function adminAcUrun(userId,sira,secAy){adminSecAy=secAy||'tumu';const profil=adminData.profiller.find(p=>p.user_id===userId);const urun=adminData.urunler.find(u=>u.user_id===userId&&u.sira===sira);const tumGirdiler=adminData.girdiler.filter(g=>g.user_id===userId&&g.urun_sira===sira);const birim=urun?.birim||'Adet';const months=[...new Set(tumGirdiler.filter(g=>g.tarih).map(g=>g.tarih.slice(0,7)))].sort().reverse();const girdiler=adminSecAy==='tumu'?tumGirdiler:tumGirdiler.filter(g=>g.tarih&&g.tarih.startsWith(adminSecAy));const ayLabel=adminSecAy==='tumu'?'Tümü':monthLabel(adminSecAy);let html=`<div class="admin-panel"><div style="display:flex;align-items:center;gap:10px;margin-bottom:14px;flex-wrap:wrap"><button onclick="adminAcSube('${userId}')" style="background:var(--dark);color:#fff;border:none;border-radius:8px;padding:8px 14px;cursor:pointer;font-size:13px;font-weight:700">← Geri</button><h2 style="margin:0;font-size:14px">📋 ${profil?.sube_adi} › ${urun?.ad}</h2></div><div style="background:#f8f8f8;border-radius:10px;padding:10px 14px;margin-bottom:12px;display:flex;align-items:center;gap:10px;flex-wrap:wrap"><span style="font-size:11px;font-weight:700;color:#999;text-transform:uppercase">Ay Filtresi</span><select onchange="adminAcUrun('${userId}',${sira},this.value)" style="padding:7px 12px;border:2px solid #eee;border-radius:8px;font-size:13px;font-weight:700;outline:none"><option value="tumu" ${adminSecAy==='tumu'?'selected':''}>Tümü</option>${months.map(m=>`<option value="${m}" ${m===adminSecAy?'selected':''}>${monthLabel(m)}</option>`).join('')}</select><button id="admin-csv-btn" style="padding:7px 14px;background:var(--orange);color:#fff;border:none;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer">CSV İndir</button><button onclick="window.print()" style="padding:7px 14px;background:var(--dark);color:#fff;border:none;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer">Yazdır</button><span style="font-size:12px;color:#aaa">${girdiler.length} giriş</span></div>`;if(!tumGirdiler.length){html+=`<div class="empty"><div class="ico">📋</div><p>Bu ürün için henüz giriş yok.</p></div>`;}else if(!girdiler.length){html+=`<div class="empty"><div class="ico">📋</div><p>${ayLabel} için giriş yok.</p></div>`;}else{let toplamFark=0,posC=0,negC=0;girdiler.forEach(g=>{const f=calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez}).fark;toplamFark+=f;if(f>0)posC++;else if(f<0)negC++;});toplamFark=r(toplamFark);const fc=toplamFark>0?'green':toplamFark<0?'red':'';html+=`<div class="stats-row" style="margin-bottom:12px"><div class="stat-card orange"><div class="sl">${ayLabel} Gün</div><div class="sv">${girdiler.length}</div></div><div class="stat-card ${fc}"><div class="sl">${ayLabel} Fark</div><div class="sv">${toplamFark>0?'+':''}${toplamFark}</div></div><div class="stat-card"><div class="sl">+ / - Gün</div><div class="sv" style="font-size:16px"><span style="color:#27ae60">+${posC}</span> / <span style="color:#e74c3c">${negC}</span></div></div></div><div class="table-card"><div class="table-scroll"><table><thead><tr><th>Gün #</th><th>Tarih</th><th>Açılış<br>(${birim})</th><th>Gelen</th><th>G.İade</th><th>Transfer</th><th>Kapanış<br>(${birim})</th><th>Sayıma Göre<br>Kullanılan</th><th>Mallara Göre<br>Satılan</th><th>Zayi</th><th>Ödenmez</th><th>FARK</th></tr></thead><tbody>`;girdiler.forEach(g=>{const e={acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez};const{sayima,fark}=calcEntry(e);const fc2=fark>0?'fp':fark<0?'fn':'fz';html+=`<tr><td>${g.gun||''}</td><td>${g.tarih||''}</td><td>${g.acilis||''}</td><td>${g.gelen||''}</td><td>${g.gelen_iade||''}</td><td>${fmt(g.transfer)}</td><td>${g.kapanis||''}</td><td class="calc">${sayima}</td><td>${g.mallara_gore||''}</td><td>${g.zayi||''}</td><td>${fmt(g.odenmez)}</td><td class="${fc2}">${fark>0?'+':''}${fark}</td></tr>`;});html+=`</tbody></table></div></div>`;}html+=`</div>`;document.getElementById('page-content').innerHTML=html;const csvBtn=document.getElementById('admin-csv-btn');if(csvBtn)csvBtn.onclick=()=>adminExportCSV(userId,sira,adminSecAy);}
function adminExportCSV(userId,sira,secAy){const profil=adminData.profiller.find(p=>p.user_id===userId);const urun=adminData.urunler.find(u=>u.user_id===userId&&u.sira===sira);const tumGirdiler=adminData.girdiler.filter(g=>g.user_id===userId&&g.urun_sira===sira);const girdiler=secAy==='tumu'?tumGirdiler:tumGirdiler.filter(g=>g.tarih&&g.tarih.startsWith(secAy));if(!girdiler.length){toast('Bu dönemde giriş yok');return;}const ayLabel=secAy==='tumu'?'Tüm_Aylar':monthLabel(secAy).replace(/\s/g,'_');const esc=v=>{const s=String(v??'');return(s.includes(';')||s.includes('"'))?'"'+s.replace(/"/g,'""')+'"':s;};const cols=['Sube','Urun','Gun','Tarih','Acilis','Gelen','Gelen_Iade','Transfer','Kapanis','Sayima_Gore_Kullanilan','Mallara_Gore_Satilan','Zayi','Odenmez','FARK'];let csv=cols.join(';')+'\n';girdiler.forEach(g=>{const{sayima,fark}=calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez});csv+=[profil?.sube_adi,urun?.ad,g.gun,g.tarih,g.acilis||0,g.gelen||0,g.gelen_iade||0,g.transfer||0,g.kapanis||0,sayima,g.mallara_gore||0,g.zayi||0,g.odenmez||0,fark].map(esc).join(';')+'\n';});const a=document.createElement('a');a.href=URL.createObjectURL(new Blob(['\uFEFF'+csv],{type:'text/csv;charset=utf-8;'}));a.download=((profil?.sube_adi||'')+'_'+(urun?.ad||'')+'_'+ayLabel).replace(/[\s\/\\:*?"<>|]/g,'_')+'.csv';a.click();toast('Excel dosyası indirildi ✅');}
let faturaAnalizSonucu=[];
async function adminSubeAdiDegistir(userId,mevcutAd){const yeni=prompt('Yeni şube adı:',mevcutAd);if(!yeni||!yeni.trim()||yeni.trim()===mevcutAd)return;const{error}=await sb.from('sube_profiller').update({sube_adi:yeni.trim()}).eq('user_id',userId);if(error){toast('Hata: '+error.message,4000);return;}const profil=adminData.profiller.find(p=>p.user_id===userId);if(profil)profil.sube_adi=yeni.trim();renderAdminAnaSayfa();toast('Şube adı güncellendi ✅');}
async function adminSubeSil(userId,subeAdi){const sifre=prompt('🔒 "'+subeAdi+'" şubesini silmek için süper admin şifrenizi girin:');if(!sifre)return;const{data,error}=await sb.auth.signInWithPassword({email:currentUser.email,password:sifre});if(error){toast('⚠️ Yanlış şifre! Silme iptal edildi.',4000);return;}if(!confirm('⚠️ SON UYARI!\n\n"'+subeAdi+'" şubesi ve TÜM verileri kalıcı olarak silinecek!\n\nBu işlem GERİ ALINAMAZ!\n\nDevam etmek için TAMAM basın.'))return;const[r1,r2,r3]=await Promise.all([sb.from('gunluk_girdiler').delete().eq('user_id',userId),sb.from('urunler').delete().eq('user_id',userId),sb.from('sube_profiller').delete().eq('user_id',userId)]);if(r1.error||r2.error||r3.error){const errmsg=(r1.error||r2.error||r3.error).message;toast('Silme hatası: '+errmsg,6000);console.error('sil r1:',r1.error,'r2:',r2.error,'r3:',r3.error);return;}adminData.profiller=adminData.profiller.filter(p=>p.user_id!==userId);adminData.urunler=adminData.urunler.filter(u=>u.user_id!==userId);adminData.girdiler=adminData.girdiler.filter(g=>g.user_id!==userId);renderAdminAnaSayfa();toast(subeAdi+' silindi ?');}
async function renderSuperKullanicilar(){
  const pc=document.getElementById('page-content');
  pc.innerHTML='<div class="empty"><div class="ico">📋</div><p>Yükleniyor...</p></div>';
  const{data:profiller}=await sb.from('sube_profiller').select('*');
  const{data:girdiler}=await sb.from('gunluk_girdiler').select('*').order('tarih',{ascending:false});
  const{data:urunler}=await sb.from('urunler').select('*');
  if(!profiller){pc.innerHTML='<div class="empty"><p>Veri yüklenemedi</p></div>';return;}
  // Her kullanıcı için Özet
  const kullanicilar=profiller.map(p=>{
    const uGirdiler=girdiler.filter(g=>g.user_id===p.user_id);
    const sonGiris=uGirdiler.length?uGirdiler[0].tarih:'?';
    const hatalar=uGirdiler.filter(g=>{
      const f=calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez}).fark;
      return f<-0.01;
    });
    return{...p,toplamGiris:uGirdiler.length,sonGiris,hatalar,urunSayisi:(urunler||[]).filter(u=>u.user_id===p.user_id).length};
  });
  const toplamHata=kullanicilar.reduce((s,k)=>s+k.hatalar.length,0);
  let html=`<div class="admin-panel">
  <h2>🔴 Süper Admin <span class="admin-badge">KULLANICILAR & LOGLAR</span></h2>
  <div style="margin-bottom:14px"><button onclick="renderAdminAnaSayfa()" style="padding:8px 14px;background:var(--dark);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">← Geri</button></div>
  <div class="stats-row" style="margin-bottom:16px">
    <div class="stat-card orange"><div class="sl">Toplam Kullanıcı</div><div class="sv">${profiller.length}</div></div>
    <div class="stat-card"><div class="sl">Toplam Girdi</div><div class="sv">${(girdiler||[]).length}</div></div>
    <div class="stat-card" style="background:#fff3cd"><div class="sl">Negatif Fark (Hata)</div><div class="sv" style="color:#e74c3c">${toplamHata}</div></div>
  </div>
  <div style="background:#fff;border-radius:14px;padding:16px;box-shadow:0 2px 8px rgba(0,0,0,0.06);margin-bottom:16px">
    <div style="font-size:15px;font-weight:800;margin-bottom:14px">👥 Tüm Kullanıcılar</div>
    <div style="overflow-x:auto"><table style="width:100%;border-collapse:collapse;font-size:12px">
    <thead><tr style="background:#f8f8f8">
      <th style="padding:10px;text-align:left;border-bottom:2px solid #eee">Şube</th>
      <th style="padding:10px;text-align:left;border-bottom:2px solid #eee">Email</th>
      <th style="padding:10px;text-align:left;border-bottom:2px solid #eee">Rol</th>
      <th style="padding:10px;text-align:center;border-bottom:2px solid #eee">Ürün</th>
      <th style="padding:10px;text-align:center;border-bottom:2px solid #eee">Toplam Girdi</th>
      <th style="padding:10px;text-align:center;border-bottom:2px solid #eee">Son Giriş</th>
      <th style="padding:10px;text-align:center;border-bottom:2px solid #eee">⚠️ Hata</th>
    </tr></thead>
    <tbody>${kullanicilar.map(k=>`<tr style="border-bottom:1px solid #f0f0f0;cursor:pointer" onclick="superAdminHatalar('${k.user_id}','${(k.sube_adi||'').replace(/'/g,'')}')" title="Detay için tıkla">
      <td style="padding:10px;font-weight:700">${k.sube_adi||'—'}</td>
      <td style="padding:10px;color:#555;font-size:11px">${k.email||'—'}</td>
      <td style="padding:10px"><span style="background:${k.rol==='super_admin'?'#e74c3c':k.rol==='admin'?'#8e44ad':'#27ae60'};color:#fff;padding:2px 8px;border-radius:10px;font-size:10px;font-weight:700">${k.rol==='super_admin'?'SÜPER ADMİN':k.rol==='admin'?'ADMİN':'KULLANICI'}</span></td>
      <td style="padding:10px;text-align:center">${k.urunSayisi}</td>
      <td style="padding:10px;text-align:center">${k.toplamGiris}</td>
      <td style="padding:10px;text-align:center;font-size:11px;color:#888">${k.sonGiris}</td>
      <td style="padding:10px;text-align:center">${k.hatalar.length>0?`<span style="background:#e74c3c;color:#fff;padding:2px 8px;border-radius:10px;font-size:11px;font-weight:700">${k.hatalar.length}</span>`:'<span style="color:#27ae60;font-size:11px">?</span>'}</td>
    </tr>`).join('')}</tbody></table></div>
  </div></div>`;
  pc.innerHTML=html;
}
function superAdminHatalar(userId,subeAdi){
  const girdiler=adminData.girdiler.filter(g=>g.user_id===userId);
  const hatali=girdiler.filter(g=>{
    const f=calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez}).fark;
    return f<-0.01;
  });
  if(!hatali.length){toast(subeAdi+' için hata kaydı yok ?',3000);return;}
  const profil=adminData.profiller.find(p=>p.user_id===userId);
  const urunler=adminData.urunler.filter(u=>u.user_id===userId);
  let rows=hatali.sort((a,b)=>b.tarih.localeCompare(a.tarih)).map(g=>{
    const urun=urunler.find(u=>u.sira===g.urun_sira);
    const f=calcEntry({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez}).fark;
    return`<tr style="border-bottom:1px solid #f0f0f0">
      <td style="padding:8px;font-size:12px">${g.tarih}</td>
      <td style="padding:8px;font-weight:700;font-size:12px">${urun?.ad||'Ürün#'+g.urun_sira}</td>
      <td style="padding:8px;font-size:12px">Açılış:${g.acilis||0} / Kapanış:${g.kapanis||0} / Satış:${g.mallara_gore||0}</td>
      <td style="padding:8px;text-align:right"><span style="color:#e74c3c;font-weight:800">${f.toFixed(2)}</span></td>
    </tr>`;
  }).join('');
  const pc=document.getElementById('page-content');
  pc.innerHTML=`<div class="admin-panel">
    <div style="display:flex;align-items:center;gap:10px;margin-bottom:16px">
      <button onclick="renderSuperKullanicilar()" style="padding:8px 14px;background:var(--dark);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">← Geri</button>
      <div><div style="font-size:15px;font-weight:800">📊 ${subeAdi} — Negatif Fark Kayıtları</div><div style="font-size:11px;color:#aaa">${profil?.email||''} • ${hatali.length} hatalı girdi</div></div>
    </div>
    <div style="background:#fff;border-radius:14px;padding:16px;box-shadow:0 2px 8px rgba(0,0,0,0.06)">
      <table style="width:100%;border-collapse:collapse">
        <thead><tr style="background:#fff3f3">
          <th style="padding:8px;text-align:left;font-size:12px;border-bottom:2px solid #eee">Tarih</th>
          <th style="padding:8px;text-align:left;font-size:12px;border-bottom:2px solid #eee">Ürün</th>
          <th style="padding:8px;text-align:left;font-size:12px;border-bottom:2px solid #eee">Değerler</th>
          <th style="padding:8px;text-align:right;font-size:12px;border-bottom:2px solid #eee">Fark</th>
        </tr></thead>
        <tbody>${rows}</tbody>
      </table>
    </div>
  </div>`;
}
async function renderAdminUrunler(){const pc=document.getElementById('page-content');const urunler=(appData?.products||[]).map(p=>({ad:p.name||p.ad,birim:p.birim,sira:p.sira,min_stok:p.min_stok}));const pc2=document.getElementById('page-content');let html=`<div class="admin-panel"><h2>⚙️ Admin Paneli <span class="admin-badge">TÜM ŞUBELER</span></h2><div style="display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap"><button onclick="renderAdminAnaSayfa()" style="padding:8px 14px;background:var(--orange);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">🏪 Şubeler</button><button onclick="renderAdminUrunler()" style="padding:8px 14px;background:#e67e22;color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">📦 Ürünler</button><button onclick="renderAdminAylikRapor()" style="padding:8px 14px;background:var(--dark);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">📊 Aylık Rapor</button><button onclick="renderAdminKarsilastirma()" style="padding:8px 14px;background:#0891b2;color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">📈 Karşılaştırma</button><button onclick="adminTumExcel()" style="padding:8px 14px;background:#27ae60;color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">📊 Excel İndir</button><button onclick="renderAdminYonetimi()" style="padding:8px 14px;background:#8e44ad;color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">👑 Admin Yönetimi</button><button onclick="renderAdminSubeYonetimi()" style="padding:8px 14px;background:#0f766e;color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">🏪 Şube Yönetimi</button></div>`;html+=`<div style="background:#fff;border-radius:14px;padding:16px;box-shadow:0 2px 8px rgba(0,0,0,0.06);margin-bottom:14px"><div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px"><div><div style="font-size:16px;font-weight:800">📦 Ürün Listesi</div><div style="font-size:11px;color:#aaa;margin-top:2px">${(urunler||[]).length} ürün • Yeni ürün eklenince tüm şubelere gider</div></div><button onclick="adminYeniUrunEkle()" style="padding:10px 18px;background:var(--orange);color:#fff;border:none;border-radius:10px;font-size:13px;font-weight:700;cursor:pointer">+ Yeni Ürün Ekle</button></div><div style="overflow-x:auto"><table style="width:100%;border-collapse:collapse;font-size:13px"><thead><tr style="background:#f8f8f8"><th style="padding:10px;text-align:left;border-bottom:2px solid #eee">Sıra</th><th style="padding:10px;text-align:left;border-bottom:2px solid #eee">Ürün Adı</th><th style="padding:10px;text-align:left;border-bottom:2px solid #eee">Birim</th><th style="padding:10px;text-align:center;border-bottom:2px solid #eee">Şube Sayısı</th></tr></thead><tbody>${(urunler||[]).map(u=>`<tr style="border-bottom:1px solid #f0f0f0"><td style="padding:10px;color:#aaa;font-size:12px">${u.sira+1}</td><td style="padding:10px;font-weight:700">${u.ad}</td><td style="padding:10px"><span style="background:#f0f0f0;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:700">${u.birim||'Adet'}</span></td><td style="padding:10px;text-align:center"><span style="background:#e8f5e9;color:#27ae60;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:700">${profiller.length} şube</span></td><td style="padding:10px;text-align:center"><button onclick="adminUrunSil('${u.ad}',${u.sira})" style="padding:5px 12px;background:#fee2e2;color:#dc2626;border:1px solid #fca5a5;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer">🗑 Sil</button></td></tr>`).join('')}</tbody></table></div></div></div>`;pc2.innerHTML=html;}
async function adminUrunSil(ad,sira){if(!confirm('"'+ad+'" ürününü TÜM şubelerden silmek istediğinizden emin misiniz?\n\nBu işlem geri alınamaz!'))return;const{data:profiller}=await sb.from('sube_profiller').select('user_id');if(!profiller||!profiller.length){toast('Şube bulunamadı');return;}let basarili=0;for(const p of profiller){const{error}=await sb.from('urunler').delete().eq('user_id',p.user_id).eq('ad',ad);if(!error)basarili++;}toast('🗑 "'+ad+'" '+basarili+' şubeden silindi!',4000);renderAdminUrunler();}
async function adminYeniUrunEkle(){const ad=prompt('Yeni ürün adı (tüm şubelere eklenecek):');if(!ad||!ad.trim())return;const birim=prompt('Birimi (Adet / Kg / Lt / Paket / Kutu):','Adet')||'Adet';const{data:profiller}=await sb.from('sube_profiller').select('user_id');if(!profiller||!profiller.length){toast('Şube bulunamadı');return;}// Her şube için en yüksek sırayı bul ve ekle
let basarili=0;for(const p of profiller){const{data:mevcutlar}=await sb.from('urunler').select('sira').eq('user_id',p.user_id).order('sira',{ascending:false}).limit(1);const yeniSira=(mevcutlar&&mevcutlar.length)?mevcutlar[0].sira+1:0;const{error}=await sb.from('urunler').insert({user_id:p.user_id,sira:yeniSira,ad:ad.trim(),birim,koli:'',adet_koli:''});if(!error)basarili++;}toast(`? "${ad.trim()}" ${basarili} şubeye eklendi!`,4000);renderAdminUrunler();}
function renderAdminYonetimi(){const profiller=adminData.profiller;const admins=profiller.filter(p=>p.rol==='admin');const subeler=profiller.filter(p=>p.rol!=='admin');let html='<div class="admin-panel">';html+='<div style="display:flex;align-items:center;gap:10px;margin-bottom:16px"><button onclick="renderAdminAnaSayfa()" style="padding:8px 14px;background:var(--dark);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">← Geri</button><h3 style="margin:0;font-size:16px">👑 Admin Yönetimi</h3></div>';html+='<div style="background:#f3e8ff;border:1px solid #c084fc;border-radius:10px;padding:10px 14px;margin-bottom:16px;font-size:12px;color:#7e22ce">Admin olan kullanıcılar tüm şubelerin verilerini görebilir, raporlarını indirebilir. Dikkatli kullanın.</div>';html+='<div style="font-size:11px;font-weight:700;color:#999;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">Adminler ('+admins.length+')</div>';html+='<div style="border:1px solid #eee;border-radius:10px;overflow:hidden;margin-bottom:20px">';if(!admins.length){html+='<div style="padding:14px;text-align:center;color:#aaa;font-size:13px">Henüz admin yok</div>';}admins.forEach(p=>{const isSelf=p.user_id===currentUser.id;html+='<div style="display:flex;align-items:center;padding:12px 14px;border-bottom:1px solid #f0f0f0;gap:10px;background:#fff9f0"><span style="font-size:22px">⚠️</span><div style="flex:1"><div style="font-size:13px;font-weight:700;color:#333">'+p.sube_adi+'</div><div style="font-size:11px;color:#aaa">'+(p.email||'e-posta yok')+'</div></div><span style="background:#e85d04;color:#fff;font-size:10px;padding:3px 8px;border-radius:10px;font-weight:700">ADMİN</span>'+(isSelf?'<span style="font-size:10px;color:#aaa;padding:0 6px">(sen)</span>':'<button onclick="adminRolDegistir(\''+p.user_id+'\',\'sube\')" style="padding:6px 12px;background:#fee2e2;color:#dc2626;border:1px solid #fca5a5;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer">Kaldır</button>')+'</div>';});html+='</div>';html+='<div style="font-size:11px;font-weight:700;color:#999;text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">Şubeler ('+subeler.length+')</div>';html+='<div style="border:1px solid #eee;border-radius:10px;overflow:hidden">';if(!subeler.length){html+='<div style="padding:14px;text-align:center;color:#aaa;font-size:13px">Tüm kullanıcılar admin</div>';}subeler.forEach(p=>{html+='<div style="display:flex;align-items:center;padding:12px 14px;border-bottom:1px solid #f0f0f0;gap:10px;background:#fff"><span style="font-size:22px">⚠️</span><div style="flex:1"><div style="font-size:13px;font-weight:700;color:#333">'+p.sube_adi+'</div><div style="font-size:11px;color:#aaa">'+(p.email||'e-posta yok')+'</div></div><span style="background:#eee;color:#999;font-size:10px;padding:3px 8px;border-radius:10px;font-weight:700">ŞUBE</span><button onclick="adminRolDegistir(\''+p.user_id+'\',\'admin\')" style="padding:6px 12px;background:#f3e8ff;color:#7e22ce;border:1px solid #c084fc;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer">👑 Admin Yap</button></div>';});html+='</div></div>';document.getElementById('page-content').innerHTML=html;}
async function adminRolDegistir(userId,yeniRol){const profil=adminData.profiller.find(p=>p.user_id===userId);const onay=yeniRol==='admin'?'"'+profil?.sube_adi+'" kullanıcısını ADMİN yapmak istediğinizden emin misiniz?\n\nTüm şubelerin verilerini görebilecek.':'"'+profil?.sube_adi+'" kullanıcısının ADMİN yetkisini kaldırmak istediğinizden emin misiniz?';if(!confirm(onay))return;const{error}=await sb.from('sube_profiller').update({rol:yeniRol}).eq('user_id',userId);if(error){toast('Hata: '+error.message,4000);return;}if(profil)profil.rol=yeniRol;renderAdminYonetimi();toast(yeniRol==='admin'?profil.sube_adi+' artisk Admin ?':profil.sube_adi+' artisk Şube kullanıcısı ?');}
function renderAdminSubeYonetimi(){const{profiller,girdiler}=adminData;let html='<div class="admin-panel">';html+='<div style="display:flex;align-items:center;gap:10px;margin-bottom:16px;flex-wrap:wrap"><button onclick="renderAdminAnaSayfa()" style="padding:8px 14px;background:var(--dark);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">← Geri</button><h3 style="margin:0;font-size:16px">🏪 Şube Yönetimi</h3><span style="background:#e0f2fe;color:#0369a1;font-size:11px;padding:4px 10px;border-radius:20px;font-weight:700">'+profiller.length+' Şube</span></div>';html+='<div style="background:#f0fdf4;border:1px solid #86efac;border-radius:10px;padding:10px 14px;margin-bottom:16px;font-size:12px;color:#166534">Şube adını değiştirebilir, şubenin ürünlerini ve giriş sayısını görebilirsiniz.</div>';profiller.forEach(p=>{const pGirdiler=girdiler.filter(g=>g.user_id===p.user_id);const sonGiris=pGirdiler.filter(g=>g.tarih).sort((a,b)=>b.tarih.localeCompare(a.tarih))[0];const buAy=new Date().toISOString().slice(0,7);const buAyG=pGirdiler.filter(g=>g.tarih&&g.tarih.startsWith(buAy));const rolBadge=p.rol==='super_admin'?'<span style="background:#7e22ce;color:#fff;font-size:10px;padding:2px 8px;border-radius:10px;font-weight:700">SÜPER</span>':p.rol==='admin'?'<span style="background:#e85d04;color:#fff;font-size:10px;padding:2px 8px;border-radius:10px;font-weight:700">ADMİN</span>':'<span style="background:#eee;color:#666;font-size:10px;padding:2px 8px;border-radius:10px;font-weight:700">ŞUBE</span>';html+='<div style="background:#fff;border:1px solid #eee;border-radius:12px;padding:14px;margin-bottom:10px;box-shadow:0 1px 3px rgba(0,0,0,0.04)">';html+='<div style="display:flex;align-items:flex-start;gap:10px">';html+='<span style="font-size:28px">🏪</span>';html+='<div style="flex:1;min-width:0">';html+='<div style="display:flex;align-items:center;gap:6px;flex-wrap:wrap;margin-bottom:4px"><span style="font-size:14px;font-weight:800;color:#1a1a1a">'+p.sube_adi+'</span>'+rolBadge+'</div>';html+='<div style="font-size:11px;color:#aaa;margin-bottom:8px">📧 '+(p.email||'e-posta yok')+'</div>';html+='<div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px"><div style="background:#f8f8f8;border-radius:8px;padding:6px 10px;font-size:11px"><span style="color:#aaa">Bu Ay</span><br><b style="color:#333">'+buAyG.length+' giriş</b></div><div style="background:#f8f8f8;border-radius:8px;padding:6px 10px;font-size:11px"><span style="color:#aaa">Toplam</span><br><b style="color:#333">'+pGirdiler.length+' giriş</b></div><div style="background:#f8f8f8;border-radius:8px;padding:6px 10px;font-size:11px"><span style="color:#aaa">Son Giriş</span><br><b style="color:#333">'+(sonGiris?sonGiris.tarih:'—')+'</b></div></div>';html+='<div style="display:flex;gap:8px;flex-wrap:wrap">';html+='<button onclick="adminSubeAdiDegistir(\''+p.user_id+'\',\''+p.sube_adi+'\')" style="padding:7px 14px;background:#fff;border:2px solid var(--orange);color:var(--orange);border-radius:8px;font-size:12px;font-weight:700;cursor:pointer">✏️ Adı Değiştir</button>';html+='<button onclick="adminAcSube(\''+p.user_id+'\')" style="padding:7px 14px;background:var(--orange);color:#fff;border:none;border-radius:8px;font-size:12px;font-weight:700;cursor:pointer">📊 Verileri Gör</button>';html+='</div>';html+='</div></div></div>';});html+='</div>';document.getElementById('page-content').innerHTML=html;}
function renderAdminKarsilastirma(){const buAy=new Date().toISOString().slice(0,7);const branches=adminData.profiller.map(p=>{const pg=adminData.girdiler.filter(g=>g.user_id===p.user_id);const buAyG=pg.filter(g=>g.tarih&&g.tarih.startsWith(buAy));const toEntry=g=>({acilis:g.acilis,gelen:g.gelen,gelenIade:g.gelen_iade,transfer:g.transfer,kapanis:g.kapanis,mallara:g.mallara_gore,zayi:g.zayi,odenmez:g.odenmez});const topFark=r(pg.reduce((s,g)=>s+calcEntry(toEntry(g)).fark,0));const buAyFark=r(buAyG.reduce((s,g)=>s+calcEntry(toEntry(g)).fark,0));const topFire=r(pg.reduce((s,g)=>s+Math.min(0,calcEntry(toEntry(g)).fark),0));return{sube_adi:p.sube_adi,topFark,buAyFark,topFire,kayit:pg.length};});const maxAbs=Math.max(1,...branches.map(b=>Math.abs(b.topFark)));let html='<div class="admin-panel">';html+='<div style="display:flex;align-items:center;gap:10px;margin-bottom:16px"><button onclick="renderAdminAnaSayfa()" style="padding:8px 14px;background:var(--dark);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">← Geri</button><h3 style="margin:0;font-size:16px">📈 Şubeler Karşılaştırma</h3></div>';html+='<div style="font-size:11px;font-weight:700;color:#999;text-transform:uppercase;letter-spacing:1px;margin-bottom:10px">Toplam Fark (tüm zamanlar)</div>';html+='<div style="background:#fff;border-radius:12px;padding:16px;margin-bottom:16px;box-shadow:0 1px 4px rgba(0,0,0,0.06)">';[...branches].sort((a,b)=>b.topFark-a.topFark).forEach(b=>{const pct=Math.round((Math.abs(b.topFark)/maxAbs)*100);const c=b.topFark>0?'#27ae60':b.topFark<0?'#e74c3c':'#aaa';html+='<div style="margin-bottom:12px"><div style="display:flex;justify-content:space-between;margin-bottom:4px"><span style="font-size:12px;font-weight:700;color:#333">🏪 '+b.sube_adi+'</span><span style="font-size:13px;font-weight:800;color:'+c+'">'+(b.topFark>0?'+':'')+b.topFark+'</span></div><div style="height:14px;background:#f0f0f0;border-radius:7px;overflow:hidden"><div style="height:100%;width:'+pct+'%;background:'+c+';border-radius:7px;transition:width 0.8s ease"></div></div></div>';});html+='</div>';html+='<div style="font-size:11px;font-weight:700;color:#999;text-transform:uppercase;letter-spacing:1px;margin-bottom:10px">Bu Ay Fark ('+monthLabel(buAy)+')</div>';const maxAy=Math.max(1,...branches.map(b=>Math.abs(b.buAyFark)));html+='<div style="background:#fff;border-radius:12px;padding:16px;margin-bottom:16px;box-shadow:0 1px 4px rgba(0,0,0,0.06)">';[...branches].sort((a,b)=>b.buAyFark-a.buAyFark).forEach(b=>{const pct=Math.round((Math.abs(b.buAyFark)/maxAy)*100);const c=b.buAyFark>0?'#27ae60':b.buAyFark<0?'#e74c3c':'#aaa';html+='<div style="margin-bottom:12px"><div style="display:flex;justify-content:space-between;margin-bottom:4px"><span style="font-size:12px;font-weight:700;color:#333">🏪 '+b.sube_adi+'</span><span style="font-size:13px;font-weight:800;color:'+c+'">'+(b.buAyFark>0?'+':'')+b.buAyFark+'</span></div><div style="height:14px;background:#f0f0f0;border-radius:7px;overflow:hidden"><div style="height:100%;width:'+pct+'%;background:'+c+';border-radius:7px;transition:width 0.8s ease"></div></div></div>';});html+='</div>';html+='<div style="font-size:11px;font-weight:700;color:#999;text-transform:uppercase;letter-spacing:1px;margin-bottom:10px">Toplam Fire Miktarı</div>';const maxFire=Math.max(1,...branches.map(b=>Math.abs(b.topFire)));html+='<div style="background:#fff;border-radius:12px;padding:16px;box-shadow:0 1px 4px rgba(0,0,0,0.06)">';[...branches].sort((a,b)=>a.topFire-b.topFire).forEach(b=>{const pct=Math.round((Math.abs(b.topFire)/maxFire)*100);html+='<div style="margin-bottom:12px"><div style="display:flex;justify-content:space-between;margin-bottom:4px"><span style="font-size:12px;font-weight:700;color:#333">🏪 '+b.sube_adi+'</span><span style="font-size:13px;font-weight:800;color:#e74c3c">'+b.topFire+' ('+b.kayit+' kayıt)</span></div><div style="height:14px;background:#f0f0f0;border-radius:7px;overflow:hidden"><div style="height:100%;width:'+pct+'%;background:#e74c3c;border-radius:7px"></div></div></div>';});html+='</div></div>';document.getElementById('page-content').innerHTML=html;}
function renderMailOtomasyon(){let html='<div class="admin-panel">';html+='<div style="display:flex;align-items:center;gap:10px;margin-bottom:16px"><button onclick="renderAdminAnaSayfa()" style="padding:8px 14px;background:var(--dark);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:700;cursor:pointer">← Geri</button><h3 style="margin:0;font-size:16px">📧 Mail Otomasyonu</h3></div>';html+='<div style="background:#e0f2fe;border:1px solid #7dd3fc;border-radius:10px;padding:12px 14px;margin-bottom:16px;font-size:13px;color:#0c4a6e"><strong>Nasıl çalışır?</strong><br>Google Apps Script, Gmail\'deki ariapos raporlarını her gece otomatik okuyup sisteme ekler. Kurulum <strong>bir kez</strong> yapılır, sonra tamamen otomatik çalışır.</div>';html+='<div style="font-size:13px;font-weight:700;color:#333;margin-bottom:8px">📋 Kurulum Adımları:</div>';html+='<div style="background:#fff;border-radius:10px;padding:14px;margin-bottom:16px;box-shadow:0 1px 4px rgba(0,0,0,0.06);font-size:13px;line-height:1.8"><div style="margin-bottom:6px">1️⃣ <a href="https://script.google.com" target="_blank" style="color:#0891b2;font-weight:700">script.google.com</a> adresine git</div><div style="margin-bottom:6px">2️⃣ <strong>Yeni Proje</strong> oluştur</div><div style="margin-bottom:6px">3️⃣ Aşağıdaki kodu yapıştır</div><div style="margin-bottom:6px">4️⃣ Üstteki <strong>Çalıştır</strong> butonuna bas (izin ver)</div><div>5️⃣ <strong>Tetikleyiciler</strong> → Her gece saat 23:30 için zamanlayıcı ekle</div></div>';const code=`// Ercan BRGR - Ariapos Mail Otomasyonu
const SUPA_URL = '${document.querySelector&&'https://gqhfxpczgxksbfybfesz.supabase.co'}';
const SUPA_KEY = 'SUPABASE_ANON_KEY_BURAYA';
const KULLANICI_EMAIL = 'SUBE_MAIL_ADRESI_BURAYA'; // hangi şubenin maili

function ariaposMailOku() {
  const threads = GmailApp.search('from:rapor11@ariapos.com is:unread', 0, 10);
  threads.forEach(thread => {
    const msgs = thread.getMessages();
    msgs.forEach(msg => {
      const body = msg.getPlainBody();
      const tarih = msg.getDate().toISOString().split('T')[0];
      const satirlar = body.split('\\n');
      const parsed = parseSatirlar(satirlar, tarih);
      if (parsed.length > 0) {
        supabaseGonder(parsed);
        msg.markRead();
      }
    });
  });
}

function parseSatirlar(satirlar, tarih) {
  // Satır formatı: URUN ADI   ADET   FIYAT
  const kayitlar = [];
  satirlar.forEach(s => {
    const m = s.match(/^(.+?)\\s{2,}(\\d+)\\s+([\\d.,]+)/);
    if (m) kayitlar.push({ urun: m[1].trim(), adet: parseInt(m[2]), tarih });
  });
  return kayitlar;
}

function supabaseGonder(kayitlar) {
  const url = SUPA_URL + '/rest/v1/rpc/mail_rapor_ekle';
  const options = {
    method: 'POST',
    headers: { 'apikey': SUPA_KEY, 'Content-Type': 'application/json' },
    payload: JSON.stringify({ kayitlar, email: KULLANICI_EMAIL })
  };
  UrlFetchApp.fetch(url, options);
}`;html+='<div style="font-size:11px;font-weight:700;color:#999;text-transform:uppercase;margin-bottom:6px">Apps Script Kodu:</div>';html+='<div style="position:relative"><button onclick="navigator.clipboard.writeText(document.getElementById(\'apps-script-code\').textContent).then(()=>toast(\'Kopyalandı ?\'))" style="position:absolute;top:8px;right:8px;padding:4px 10px;background:#0891b2;color:#fff;border:none;border-radius:6px;font-size:11px;font-weight:700;cursor:pointer;z-index:1">📋 Kopyala</button>';html+='<pre id="apps-script-code" style="background:#1a1a2e;color:#a5f3fc;border-radius:10px;padding:16px;font-size:11px;overflow-x:auto;white-space:pre-wrap;margin:0;line-height:1.6">'+code.replace(/</g,'&lt;')+'</pre></div>';html+='<div style="background:#fef9c3;border-radius:8px;padding:10px 14px;margin-top:12px;font-size:12px;color:#854d0e">⚠️ <strong>SUPA_KEY</strong> ve <strong>KULLANICI_EMAIL</strong> alanlarını doldurmayı unutma.</div>';html+='</div>';document.getElementById('page-content').innerHTML=html;}
async function faturaFotoOku(input){
  const file=input.files[0];
  if(!file)return;
  const status=document.getElementById('fatura-ocr-status');
  status.innerHTML='? Fotoğraf okunuyor...';
  status.style.color='#e67e22';
  try{
    const{data:{text}}=await Tesseract.recognize(file,'tur+eng',{
      logger:m=>{if(m.status==='recognizing text'){status.innerHTML=`? %${Math.round(m.progress*100)} okunuyor...`;}}
    });
    document.getElementById('fatura-text').value=text;
    status.innerHTML='? Metin okundu — analiz ediliyor...';
    status.style.color='#27ae60';
    analizFatura();
  }catch(e){
    status.innerHTML='? Okuma başarısız, metni elle yapıştırın';
    status.style.color='#e74c3c';
  }
}
let satisAnalizSonucu={};
let satisRaporTarih=null;
function openSatisModal(){document.getElementById('satis-modal').classList.add('show');document.getElementById('analiz-sonuc').innerHTML='';document.getElementById('satis-text').value='';satisAnalizSonucu={};satisRaporTarih=null;}
function closeSatisModal(){document.getElementById('satis-modal').classList.remove('show');}
function parseSatisLines(text){const items=[];let cat='';text.split('\n').forEach(line=>{if(/^\s*\*/.test(line)){cat=line.replace(/[* ]/g,'').toUpperCase();return;}const m=line.match(/^(.+?)\s{2,}(\d+)\s+([\d.,]+)/);if(m){const adet=parseInt(m[2]);const tutar=parseFloat(m[3].replace('.','').replace(',','.'));const birimFiyat=adet>0?tutar/adet:0;items.push({ad:m[1].trim().toUpperCase(),adet,kat:cat,birimFiyat});}});return items;}
function parseOzetToplam(text){let toplam=0;const lines=text.split('\n');let ozetBasladi=false;lines.forEach(line=>{if(/Ozet Urun Tip|Özet Ürün Tip/i.test(line)){ozetBasladi=true;return;}if(ozetBasladi){const m=line.match(/:\s*(\d+)/);if(m)toplam+=parseInt(m[1]);}});return toplam;}
function gunAdiFromTarih(tarih){if(!tarih)return '';const d=new Date(tarih);return ['Paz','Pzt','Sal','Çar','Per','Cum','Cmt'][d.getDay()]||'';}
function extractPieces(ad){const m=ad.match(/(\d+)'?[LlİiuU]/);return m?parseInt(m[1]):1;}
function menuBilgi(item){const{ad,kat}=item;if(/GURME.*IKIL|IKIL.*GURME/.test(ad))return{bc:2,pat:2,kutu:2,litre:0,smoky:true};if(/IKILI/.test(kat)||/2 ?LI/.test(ad))return{bc:2,pat:2,kutu:2,litre:0};if(/UCLU/.test(kat)||/3 ?LU/.test(ad))return{bc:3,pat:3,kutu:0,litre:1};if(/DORTLU/.test(kat)||/4 ?LU/.test(ad))return{bc:4,pat:4,kutu:0,litre:2};if(/PIZZA.*MEN|MEN.*PIZZA/.test(ad))return{bc:0,pat:0,kutu:1,litre:0};if(/MENU/.test(kat)||/MEN[UÜ]?$/.test(ad)||/PAKET|RAMAZAN/.test(ad))return{bc:1,pat:1,kutu:1,litre:0};return{bc:1,pat:0,kutu:0,litre:0};}
function parseTarihFromText(text){const m=text.match(/(\d{1,2})[.\-\/](\d{1,2})[.\-\/](\d{4})/);if(!m)return null;const gun=m[1].padStart(2,'0'),ay=m[2].padStart(2,'0'),yil=m[3];return `${yil}-${ay}-${gun}`;}
function analizEt(){const text=document.getElementById('satis-text').value.trim();if(!text){toast('Rapor metnini yapıştırın');return;}satisRaporTarih=parseTarihFromText(text);const lines=parseSatisLines(text);if(!lines.length){document.getElementById('analiz-sonuc').innerHTML='<div style="color:#e74c3c;font-size:13px;padding:10px">Ürün bulunamadı.</div>';return;}const totals={};let etBurger=0,tumBurger=0,smokyBurger=0;const add=(sira,val,birim='Kg')=>{if(!totals[sira])totals[sira]={val:0,birim};totals[sira].val=r(totals[sira].val+val);totals[sira].birim=birim;};lines.forEach(item=>{const{ad,adet}=item;const mb=menuBilgi(item);const isDouble=/DOUBLE/.test(ad)&&!/2 ?LI/.test(ad);let bSira=-1,bGr=0,isTavuk=false,isMiniEkmek=false;if(/RAMAZAN CORBALI/.test(ad)){bSira=7;bGr=110;isTavuk=true;}
else if(/JUNIOR.*TAVUK|TAVUK.*JUNIOR/.test(ad)){bSira=5;bGr=65;isTavuk=true;isMiniEkmek=true;mb.pat=mb.pat||1;mb.kutu=mb.kutu||1;}
else if(/JUNIOR|MINI ET/.test(ad)){bSira=0;bGr=50;isMiniEkmek=true;mb.pat=mb.pat||1;mb.kutu=mb.kutu||1;}
else if(/LEZZET/.test(ad)){if(item.birimFiyat>220){bSira=1;bGr=85;}else{bSira=6;bGr=120;isTavuk=true;}mb.pat=mb.pat||1;mb.kutu=mb.kutu||1;}
else if(/JOKE|ALGIDA JOKER|KAMPANYA.*JOKE/.test(ad)){bSira=1;bGr=85;}
else if(/SUPPER|SUPER|MISS CRISPY/.test(ad)){bSira=2;bGr=120;}
else if(/TASTY|RAMAZAN(?!.*CORBALI)/.test(ad)){bSira=3;bGr=150;}
else if(/SPECIAL|BIG SPECIAL/.test(ad)){bSira=4;bGr=150;}
else if(/TENDERS/.test(ad)){bSira=7;bGr=110;isTavuk=true;}
else if(/MINI TAVUK/.test(ad)){bSira=5;bGr=65;isTavuk=true;}
else if(/CHICKEN|CHEDDAR|RED ZONE/.test(ad)){bSira=6;bGr=120;isTavuk=true;}
else if(/CITIR|ÇITIR/.test(ad)){add(11,adet*160/1000);return;}if(bSira>=0){const etAdet=isDouble?2:1;add(bSira,adet*mb.bc*etAdet*bGr/1000);add(isMiniEkmek?17:16,adet*mb.bc,'Adet');if(!isTavuk)etBurger+=adet*mb.bc;tumBurger+=adet*mb.bc;if(mb.pat>0)add(8,adet*mb.pat*130/1000);if(mb.kutu>0)add(18,adet*mb.kutu,'Adet');if(mb.litre>0)add(20,adet*mb.litre,'Adet');if(/SMOKY/.test(ad)||mb.smoky)smokyBurger+=adet*mb.bc;return;}if(/PATATES/.test(ad))add(8,adet*130/1000);else if(/NUGGET/.test(ad))add(9,extractPieces(ad)*adet*24/1000);else if(/SOGAN|SOĞAN|ONION/.test(ad))add(10,extractPieces(ad)*adet*14/1000);else if(/STICK/.test(ad))add(12,r(extractPieces(ad)*adet*22/1000));else if(/SODA|MEYVELI SODA|MADEN/.test(ad))add(19,adet,'Adet');else if(/1 ?LT/.test(ad))add(20,adet,'Adet');else if(/SU|COLA|FUSE|ICE|AYRAN|MEYVE|SPRITE/.test(ad)&&!/SODA|1 ?LT/.test(ad))add(18,adet,'Adet');});if(etBurger>0)add(13,r(etBurger*20/1000));if(smokyBurger>0)add(14,r(smokyBurger*3*13/1000));
// Ekmek direkt ürün parse'ından hesaplandı (totals[16]=80gr, totals[17]=mini)
satisAnalizSonucu=totals;const siraNamMap={};appData.products.forEach((p,idx)=>{siraNamMap[idx]=p;});const tarihLabel=satisRaporTarih?`<span style="background:#eafaf1;color:#27ae60;padding:3px 10px;border-radius:8px;font-weight:700">📊 ${satisRaporTarih}</span>`:`<span style="background:#fff3cd;color:#856404;padding:3px 10px;border-radius:8px;font-weight:700">⚠️ Tarih bulunamadı — bugün kullanılacak</span>`;let html=`<div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;flex-wrap:wrap">${tarihLabel}<span style="font-size:11px;color:#999">${lines.length} satır • ${tumBurger} burger</span></div><div style="border:1px solid #eee;border-radius:10px;overflow:hidden;margin-bottom:10px">`;let hasAny=false;Object.entries(totals).forEach(([sira,{val,birim}])=>{const p=siraNamMap[parseInt(sira)];if(!p||!val)return;html+=`<div style="display:flex;align-items:center;padding:9px 12px;border-bottom:1px solid #f5f5f5;gap:10px"><span style="flex:1;font-size:13px;font-weight:600;color:#333">${p.name}</span><input type="number" id="srv-${sira}" value="${val}" step="0.001" style="width:80px;padding:6px 8px;border:2px solid #eee;border-radius:6px;text-align:center;font-size:13px;font-weight:700;outline:none" onfocus="this.style.borderColor='#e85d04'" onblur="this.style.borderColor='#eee'"><span style="font-size:11px;color:#aaa;min-width:28px">${birim}</span></div>`;hasAny=true;});html+=`</div>`;if(hasAny){html+=`<div style="font-size:11px;color:#aaa;margin-bottom:8px">Değerleri kontrol edip onaylayın — her ürüne yeni giriş açılır</div><button onclick="uygulaRapor()" style="width:100%;padding:13px;background:#27ae60;color:#fff;border:none;border-radius:10px;font-size:14px;font-weight:700;cursor:pointer">? Kaydet ve Girişleri Oluştur</button>`;}else{html+=`<div style="text-align:center;padding:16px;color:#aaa;font-size:13px">Eşleşen ürün bulunamadı.</div>`;}document.getElementById('analiz-sonuc').innerHTML=html;}
async function uygulaRapor(){const totals=satisAnalizSonucu;if(!Object.keys(totals).length)return;const siraNamMap={};appData.products.forEach((p,idx)=>{siraNamMap[idx]=p;});const tarih=satisRaporTarih||new Date().toISOString().slice(0,10);const gunAdi=gunAdiFromTarih(tarih)||['Paz','Pzt','Sal','Çar','Per','Cum','Cmt'][new Date().getDay()];let updated=0,created=0;for(const[sira]of Object.entries(totals)){const inputEl=document.getElementById(`srv-${sira}`);const finalVal=inputEl?parseFloat(inputEl.value):0;if(!finalVal)continue;const p=siraNamMap[parseInt(sira)];if(!p)continue;const mevcutIdx=p.entries.findIndex(e=>e.tarih===tarih);if(mevcutIdx>=0){p.entries[mevcutIdx].mallara=String(finalVal);const e=p.entries[mevcutIdx];if(e.dbId){await sb.from('gunluk_girdiler').update({mallara_gore:String(finalVal)}).eq('id',e.dbId);}updated++;}else{const oncekiKapanis=p.entries.length?p.entries[p.entries.length-1].kapanis||'':'';const newEntry={gun:String(p.entries.length+1),tarih,acilis:oncekiKapanis,gelen:'',gelenIade:'',transfer:'',kapanis:'',mallara:String(finalVal),zayi:'',odenmez:''};p.entries.push(newEntry);const row={user_id:currentUser.id,urun_sira:parseInt(sira),gun:String(p.entries.length),tarih,acilis:oncekiKapanis||null,gelen:null,gelen_iade:null,transfer:null,kapanis:null,mallara_gore:String(finalVal),zayi:null,odenmez:null};const res=await sb.from('gunluk_girdiler').insert(row).select().single();if(res.data)p.entries[p.entries.length-1].dbId=res.data.id;created++;}}toast(`? ${created} yeni giriş (${tarih}), ${updated} güncellendi`,3500);closeSatisModal();selectedMonth=tarih.slice(0,7);renderPage();}
// SW tamamen kaldır + otomatik versiyon kontrolü
if('serviceWorker'in navigator&&location.protocol!=='file:'){
  navigator.serviceWorker.getRegistrations().then(regs=>{regs.forEach(r=>r.unregister());});
  caches.keys().then(keys=>keys.forEach(k=>caches.delete(k)));
}
(function(){
  const LOCAL_VER=document.querySelector('meta[name="app-version"]')?.content||'0';
  const STORED=localStorage.getItem('app_version');
  if(!STORED){localStorage.setItem('app_version',LOCAL_VER);return;}
  fetch('version.json?t='+Date.now(),{cache:'no-store'})
    .then(r=>r.json()).then(data=>{
      if(data.v&&data.v!==STORED){
        localStorage.setItem('app_version',data.v);
        location.reload(true);
      }
    }).catch(()=>{});
})();
// PWA install devre disi - cache sorunu onlemek icin
window.addEventListener('load',async()=>{showScreen('auth-screen');const{data:{session}}=await sb.auth.getSession();if(session){await onSignedIn(session.user);}else{showScreen('auth-screen');}sb.auth.onAuthStateChange(async(event,session)=>{if(event==='SIGNED_OUT')showScreen('auth-screen');});});
</script>
</body>
</html>
